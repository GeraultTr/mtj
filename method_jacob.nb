(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[    233823,       5654]
NotebookOptionsPosition[    225126,       5513]
NotebookOutlinePosition[    225604,       5531]
CellTagsIndexPosition[    225561,       5528]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Definitions", "Chapter",
 CellChangeTimes->{{3.969000503734247*^9, 
  3.969000509754902*^9}},ExpressionUUID->"3b65c0ac-6816-2b48-be0c-\
6872b12c2216"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.969693880841461*^9, 3.9696939192591877`*^9}, {
  3.969693949428097*^9, 3.9696939518429775`*^9}},
 CellLabel->"In[36]:=",ExpressionUUID->"9077352c-c07a-7f44-80e2-f41b7e90635a"],

Cell[TextData[{
 "We want to study a variation of the classical Rosenzweig-MacArthur \
prey-predator model. The classical model describes the temporal variation of \
a resource ",
 Cell[BoxData[
  FormBox[
   RowBox[{"R", "(", "t", ")"}], TraditionalForm]],ExpressionUUID->
  "17f4651f-aae5-fc4f-8c24-35d8fdaf31a6"],
 " and a consumer ",
 Cell[BoxData[
  FormBox[
   RowBox[{"C", "(", "t", ")"}], TraditionalForm]],ExpressionUUID->
  "f3d41263-fed7-fd48-91da-797144278da0"],
 ":\n\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         FractionBox[
          RowBox[{
            StyleBox["d", FontSlant -> "Plain"], " ", 
            StyleBox["R", "TI"]}], 
          RowBox[{
            StyleBox["d", FontSlant -> "Plain"], " ", 
            StyleBox["t", "TI"]}]], 
         RowBox[{"(", 
           StyleBox["t", "TI"], ")"}], "\[LongEqual]", 
         StyleBox["r", "TI"], 
         StyleBox["R", "TI"], 
         RowBox[{"(", 
           StyleBox["t", "TI"], ")"}], 
         RowBox[{"(", 
           RowBox[{"1", "-", 
             FractionBox[
              RowBox[{
                StyleBox["R", "TI"], "(", 
                StyleBox["t", "TI"], ")"}], 
              StyleBox["k", "TI"]]}], ")"}], "-", 
         FractionBox["\[Alpha]", 
          RowBox[{"1", "+", "\[Alpha]\[Eta]", 
            StyleBox["R", "TI"], 
            RowBox[{"(", 
              StyleBox["t", "TI"], ")"}]}]], 
         StyleBox["R", "TI"], 
         RowBox[{"(", 
           StyleBox["t", "TI"], ")"}], 
         StyleBox["C", "TI"], 
         RowBox[{"(", 
           StyleBox["t", "TI"], ")"}]}], TraditionalForm], "errors" -> {}, 
     "input" -> 
     "\\frac{\\mathrm{d}\\,R}{\\mathrm{d}\\,t}(t)=rR(t)(1-\\frac{R(t)}{k})-\\\
frac{\\alpha}{1+\\alpha\\eta R(t)}R(t)C(t)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "fff2de3d-f014-2f40-a181-c1cfeb64d5a0"],
 "\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         FractionBox[
          RowBox[{
            StyleBox["d", FontSlant -> "Plain"], " ", 
            StyleBox["C", "TI"]}], 
          RowBox[{
            StyleBox["d", FontSlant -> "Plain"], " ", 
            StyleBox["t", "TI"]}]], 
         RowBox[{"(", 
           StyleBox["t", "TI"], ")"}], "\[LongEqual]", "\[Epsilon]", 
         FractionBox["\[Alpha]", 
          RowBox[{"1", "+", "\[Alpha]\[Eta]", 
            StyleBox["R", "TI"], 
            RowBox[{"(", 
              StyleBox["t", "TI"], ")"}]}]], 
         StyleBox["R", "TI"], 
         RowBox[{"(", 
           StyleBox["t", "TI"], ")"}], 
         StyleBox["C", "TI"], 
         RowBox[{"(", 
           StyleBox["t", "TI"], ")"}], "-", "\[Beta]", 
         StyleBox["C", "TI"], 
         RowBox[{"(", 
           StyleBox["t", "TI"], ")"}]}], TraditionalForm], "errors" -> {}, 
     "input" -> 
     "\\frac{\\mathrm{d}\\,C}{\\mathrm{d}\\,t}(t)=\\epsilon\\frac{\\alpha}{1+\
\\alpha\\eta R(t)}R(t)C(t)-\\beta C(t)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "d19fb0a4-7da0-c54c-8024-852d1251925c"],
 "\n",
 Cell[BoxData[
  FormBox[
   RowBox[{"r", ">", "0"}], TraditionalForm]],ExpressionUUID->
  "49d34d92-16b4-a14c-b919-7a32c511536f"],
 " is the rate constant, ",
 Cell[BoxData[
  FormBox[
   RowBox[{"k", ">", "0"}], TraditionalForm]],ExpressionUUID->
  "d4c6c4ae-52f5-1643-92c6-6a4e27664086"],
 " is the carrying capacity of the prey population, ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Alpha]", ">", "0"}], TraditionalForm]],ExpressionUUID->
  "3fd085a4-62ea-5b4a-9c3d-1d3f6c5b2e9d"],
 " the attack rate, ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Eta]", ">", "0"}], TraditionalForm]],ExpressionUUID->
  "b4891f45-98e3-c149-84ab-4a9d21474a12"],
 " the handling rate, ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Epsilon]", ">", "0"}], TraditionalForm]],ExpressionUUID->
  "0ee92c97-0dcd-384f-a317-41d7e7d50987"],
 " an efficiency parameter, and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Beta]", ">", "0"}], TraditionalForm]],ExpressionUUID->
  "3f06c253-ebbe-1348-bb0f-6817db98b276"],
 " is the mortality rate of the consumer.\nWe introduce an individual \
phenotypic variation through the quantitative trait ",
 Cell[BoxData[
  FormBox["x", TraditionalForm]],ExpressionUUID->
  "180b475d-c62a-7d40-a87a-29ae3af944d9"],
 ", with a normal distribution in the population centered on ",
 Cell[BoxData[
  FormBox[
   OverscriptBox["x", "_"], TraditionalForm]],ExpressionUUID->
  "aeb073b9-5e45-584d-829f-3d102f07ecd9"],
 " and of standard deviation ",
 Cell[BoxData[
  FormBox["\[Sigma]", TraditionalForm]],ExpressionUUID->
  "62983ad7-855a-8d4c-93ef-e79a2af72e61"],
 ":\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["p", "TI"], 
         RowBox[{"(", 
           StyleBox["x", "TI"], ")"}], "\[LongEqual]", 
         FractionBox["1", 
          SqrtBox[
           RowBox[{"2", "\[Pi]\[Sigma]"}]]], 
         SuperscriptBox[
          StyleBox["e", "TI"], 
          RowBox[{"-", 
            FractionBox[
             SuperscriptBox[
              RowBox[{"(", 
                RowBox[{
                  StyleBox["x", "TI"], "-", 
                  OverscriptBox[
                   StyleBox["x", "TI"], "_"]}], ")"}], "2"], 
             RowBox[{"2", "\[Sigma]"}]]}]]}], TraditionalForm], 
     "errors" -> {}, "input" -> 
     "p(x)=\\frac{1}{\\sqrt{2\\pi\\sigma}}e^{-\\frac{(x-\\bar{x})^2}{2\\sigma}\
}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "24e435f8-fb06-7745-86c9-489a7c77915d"],
 ".\nThe attack rate individual variation can be expressed as:\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[Alpha]", 
         RowBox[{"(", 
           StyleBox["x", "TI"], ")"}], "\[LongEqual]", 
         SubscriptBox["\[Alpha]", 
          StyleBox["max", FontSlant -> "Plain"]], 
         SuperscriptBox[
          StyleBox["e", "TI"], 
          RowBox[{"-", 
            FractionBox[
             SuperscriptBox[
              RowBox[{"(", 
                RowBox[{
                  StyleBox["x", "TI"], "-", 
                  SubscriptBox["\[Theta]", "\[Alpha]"]}], ")"}], "2"], 
             RowBox[{"2", 
               SuperscriptBox["\[Tau]", "2"]}]]}]]}], TraditionalForm], 
     "errors" -> {}, "input" -> 
     "\\alpha(x)=\\alpha_{\\mathrm{max}}e^{-\\frac{(x-\\theta_{\\alpha})^2}{2\
\\tau^2}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "2cf08f63-6267-844e-9993-903f0ac96a9d"],
 ", with ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Tau]", ">", "0"}], TraditionalForm]],ExpressionUUID->
  "30805b79-ba9c-474f-9b40-b1935b3624b3"],
 " the standard deviation of the distribution centered on ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Theta]", "\[Alpha]"], ">", "0"}], TraditionalForm]],
  ExpressionUUID->"3d7215f9-87d8-9946-a4f9-de398427f579"],
 ". Since ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Alpha]", ">", "0"}], TraditionalForm]],ExpressionUUID->
  "e0162aa6-406c-fa44-965d-1a525519cb41"],
 ", we also have ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Alpha]", "max"], ">", "0"}], TraditionalForm]],
  ExpressionUUID->"8e29745f-dfbe-3248-9c4f-55d60691785c"],
 ".\nThe handling rate is similarly described, although the \
\[OpenCurlyDoubleQuote]best\[CloseCurlyDoubleQuote] behaviour is for the \
minimum handling time:\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[Eta]", 
         RowBox[{"(", 
           StyleBox["x", "TI"], ")"}], "\[LongEqual]", 
         SubscriptBox["\[Eta]", 
          StyleBox["max", FontSlant -> "Plain"]], "-", 
         RowBox[{"(", 
           RowBox[{
             SubscriptBox["\[Eta]", 
              StyleBox["max", FontSlant -> "Plain"]], "-", 
             SubscriptBox["\[Eta]", 
              StyleBox["min", FontSlant -> "Plain"]]}], ")"}], 
         SuperscriptBox[
          StyleBox["e", "TI"], 
          RowBox[{"-", 
            FractionBox[
             SuperscriptBox[
              RowBox[{"(", 
                RowBox[{
                  StyleBox["x", "TI"], "-", 
                  SubscriptBox["\[Theta]", "\[Eta]"]}], ")"}], "2"], 
             RowBox[{"2", 
               SuperscriptBox["\[Nu]", "2"]}]]}]]}], TraditionalForm], 
     "errors" -> {}, "input" -> 
     "\\eta(x)=\\eta_{\\mathrm{max}}-(\\eta_{\\mathrm{max}}-\\eta_{\\mathrm{\
min}})e^{-\\frac{(x-\\theta_{\\eta})^2}{2\\nu^2}}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "bc067987-2741-d141-b874-c2e7157e8563"],
 ", with ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Nu]", ">", "0"}], TraditionalForm]],ExpressionUUID->
  "641cafb9-b78a-6348-99ea-8d0c1dfb910b"],
 " the standard deviation of the distribution centered on ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Theta]", "\[Eta]"], ">", "0"}], TraditionalForm]],
  ExpressionUUID->"5cce25a1-5604-a243-be2e-d680833999b0"],
 ", ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Eta]", "max"], ">", "0"}], TraditionalForm]],
  ExpressionUUID->"d93abb0d-7675-8547-948f-25ff7f1ff084"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"0", "<", 
    SubscriptBox["\[Eta]", "min"], "<=", 
    SubscriptBox["\[Eta]", "max"]}], TraditionalForm]],ExpressionUUID->
  "b0bb9812-b2a0-5c43-b35c-107378956f62"],
 ".\nThe modified problem is thus:\n\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         FractionBox[
          RowBox[{
            StyleBox["d", FontSlant -> "Plain"], " ", 
            StyleBox["R", "TI"]}], 
          RowBox[{
            StyleBox["d", FontSlant -> "Plain"], " ", 
            StyleBox["t", "TI"]}]], 
         RowBox[{"(", 
           StyleBox["t", "TI"], ")"}], "\[LongEqual]", 
         StyleBox["r", "TI"], 
         StyleBox["R", "TI"], 
         RowBox[{"(", 
           StyleBox["t", "TI"], ")"}], 
         RowBox[{"(", 
           RowBox[{"1", "-", 
             FractionBox[
              RowBox[{
                StyleBox["R", "TI"], "(", 
                StyleBox["t", "TI"], ")"}], 
              StyleBox["k", "TI"]]}], ")"}], "-", 
         RowBox[{"(", 
           RowBox[{
             SubsuperscriptBox["\[Integral]", 
              RowBox[{"-", "\[Infinity]"}], "\[Infinity]"], 
             FractionBox[
              RowBox[{"\[Alpha]", "(", 
                StyleBox["x", "TI"], ")"}], 
              RowBox[{"1", "+", "\[Alpha]", 
                RowBox[{"(", 
                  StyleBox["x", "TI"], ")"}], "\[Eta]", 
                RowBox[{"(", 
                  StyleBox["x", "TI"], ")"}], 
                StyleBox["R", "TI"], 
                RowBox[{"(", 
                  StyleBox["t", "TI"], ")"}]}]], 
             StyleBox["p", "TI"], 
             RowBox[{"(", 
               StyleBox["x", "TI"], ")"}], " ", 
             StyleBox["d", FontSlant -> "Plain"], 
             StyleBox["x", "TI"]}], ")"}], 
         StyleBox["R", "TI"], 
         RowBox[{"(", 
           StyleBox["t", "TI"], ")"}], 
         StyleBox["C", "TI"], 
         RowBox[{"(", 
           StyleBox["t", "TI"], ")"}]}], TraditionalForm], "errors" -> {}, 
     "input" -> 
     "\\frac{\\mathrm{d}\\,R}{\\mathrm{d}\\,t}(t)=rR(t)(1-\\frac{R(t)}{k})-(\\\
int_{-\\infty}^{\\infty}\\frac{\\alpha(x)}{1+\\alpha(x)\\eta(x)R(t)}p(x)\\,\\\
mathrm{d}x)R(t)C(t)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "f70c810a-caac-3e44-bb31-1d3328160f42"],
 "\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         FractionBox[
          RowBox[{
            StyleBox["d", FontSlant -> "Plain"], " ", 
            StyleBox["C", "TI"]}], 
          RowBox[{
            StyleBox["d", FontSlant -> "Plain"], " ", 
            StyleBox["t", "TI"]}]], 
         RowBox[{"(", 
           StyleBox["t", "TI"], ")"}], "\[LongEqual]", "\[Epsilon]", 
         RowBox[{"(", 
           RowBox[{
             SubsuperscriptBox["\[Integral]", 
              RowBox[{"-", "\[Infinity]"}], "\[Infinity]"], 
             FractionBox[
              RowBox[{"\[Alpha]", "(", 
                StyleBox["x", "TI"], ")"}], 
              RowBox[{"1", "+", "\[Alpha]", 
                RowBox[{"(", 
                  StyleBox["x", "TI"], ")"}], "\[Eta]", 
                RowBox[{"(", 
                  StyleBox["x", "TI"], ")"}], 
                StyleBox["R", "TI"], 
                RowBox[{"(", 
                  StyleBox["t", "TI"], ")"}]}]], 
             StyleBox["p", "TI"], 
             RowBox[{"(", 
               StyleBox["x", "TI"], ")"}], " ", 
             StyleBox["d", FontSlant -> "Plain"], 
             StyleBox["x", "TI"]}], ")"}], 
         StyleBox["R", "TI"], 
         RowBox[{"(", 
           StyleBox["t", "TI"], ")"}], 
         StyleBox["C", "TI"], 
         RowBox[{"(", 
           StyleBox["t", "TI"], ")"}], "-", "\[Beta]", 
         StyleBox["C", "TI"], 
         RowBox[{"(", 
           StyleBox["t", "TI"], ")"}]}], TraditionalForm], "errors" -> {}, 
     "input" -> 
     "\\frac{\\mathrm{d}\\,C}{\\mathrm{d}\\,t}(t)=\\epsilon(\\int_{-\\infty}^{\
\\infty}\\frac{\\alpha(x)}{1+\\alpha(x)\\eta(x)R(t)}p(x)\\,\\mathrm{d}x)R(t)C(\
t)-\\beta C(t)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "f6052ef0-9e91-c74d-885d-3aba43714d61"]
}], "Text",
 CellChangeTimes->{{3.969000617216772*^9, 3.9690008014487896`*^9}, {
  3.969000833673788*^9, 3.969001092791483*^9}, {3.969001126965391*^9, 
  3.9690012372395496`*^9}, {3.9690015672049465`*^9, 3.9690016454071884`*^9}, {
  3.9690017112478943`*^9, 3.9690017129503098`*^9}, {3.9690017667914467`*^9, 
  3.9690019094038105`*^9}, {3.9690019695351887`*^9, 3.9690019972648354`*^9}, {
  3.9690021412093563`*^9, 3.969002167328022*^9}, {3.969002223237377*^9, 
  3.9690022233192616`*^9}, {3.9690034395619965`*^9, 3.9690034753233166`*^9}, {
  3.969003674577572*^9, 3.969003781805212*^9}, {3.969003848491171*^9, 
  3.9690041470181255`*^9}, {3.9690042146857224`*^9, 3.9690043669316864`*^9}, {
  3.969004472748148*^9, 3.969004509892393*^9}, {3.969005065525467*^9, 
  3.969005106807493*^9}},ExpressionUUID->"fd39c993-bcdf-3944-8a5b-\
2fb22813f981"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Probability", " ", "distribution"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"pdist", "[", 
      RowBox[{"x_", ",", "X_", ",", "\[Sigma]_"}], "]"}], ":=", 
     RowBox[{
      FractionBox["1", 
       SqrtBox[
        RowBox[{"2", "\[Pi]", " ", "\[Sigma]"}]]], 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"x", "-", "X"}], ")"}], "2"], 
         RowBox[{"2", "\[Sigma]"}]]}]]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Attack", " ", "rate"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"attack", "[", 
      RowBox[{"x_", ",", "a_", ",", "\[Alpha]_", ",", "\[Tau]_"}], "]"}], ":=", 
     RowBox[{"\[Alpha]", " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"x", "-", "a"}], ")"}], "2"], 
         RowBox[{"2", 
          SuperscriptBox["\[Tau]", "2"]}]]}]]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Handling", " ", "rate"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"handling", "[", 
      RowBox[{
      "x_", ",", "h_", ",", "\[Eta]min_", ",", "\[Eta]max_", ",", "\[Nu]_"}], 
      "]"}], ":=", 
     RowBox[{"\[Eta]max", "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"\[Eta]max", "-", "\[Eta]min"}], ")"}], 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"-", 
         FractionBox[
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"x", "-", "h"}], ")"}], "2"], 
          RowBox[{"2", 
           SuperscriptBox["\[Nu]", "2"]}]]}]]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Manipulate", "[", 
    RowBox[{
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"attack", "[", 
          RowBox[{"x", ",", "a", ",", "\[Alpha]", ",", "\[Tau]"}], "]"}], ",", 
         RowBox[{"handling", "[", 
          RowBox[{
          "x", ",", "h", ",", "\[Eta]min", ",", "\[Eta]max", ",", "\[Nu]"}], 
          "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "0", ",", "10"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a", ",", "5"}], "}"}], ",", "0.1", ",", " ", "10"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"h", ",", "5"}], "}"}], ",", " ", "0.1", ",", "10"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Alpha]", ",", "1.5"}], "}"}], ",", "0.01", ",", "3"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Eta]min", ",", "1"}], "}"}], ",", "0.01", ",", "3"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Eta]max", ",", "2"}], "}"}], ",", "0.01", ",", "3"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Tau]", ",", "1"}], "}"}], ",", "0.01", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Nu]", ",", "1"}], "}"}], ",", "0.01", ",", "2"}], "}"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.96830031596418*^9, 3.9683006014063854`*^9}, {
  3.968390101549835*^9, 3.968390115916479*^9}, {3.9690005539267464`*^9, 
  3.9690005893198414`*^9}, {3.96900523100634*^9, 3.9690054667426147`*^9}, {
  3.9690060953246403`*^9, 3.9690061041094112`*^9}, {3.9690096181465607`*^9, 
  3.969009622606251*^9}, {3.9690096921285496`*^9, 3.9690097068720303`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"095903af-07a6-0d40-95a3-bf739a198119"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`a$$ = 5, $CellContext`h$$ = 
    5, $CellContext`\[Alpha]$$ = 1.5, $CellContext`\[Eta]max$$ = 
    2, $CellContext`\[Eta]min$$ = 1, $CellContext`\[Nu]$$ = 
    1, $CellContext`\[Tau]$$ = 1, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"sans titre\"", Typeset`specs$$ = {{{
       Hold[$CellContext`a$$], 5}, 0.1, 10, ControlType -> Manipulator}, {{
       Hold[$CellContext`h$$], 5}, 0.1, 10, ControlType -> Manipulator}, {{
       Hold[$CellContext`\[Alpha]$$], 1.5}, 0.01, 3, ControlType -> 
      Manipulator}, {{
       Hold[$CellContext`\[Eta]min$$], 1}, 0.01, 3, ControlType -> 
      Manipulator}, {{
       Hold[$CellContext`\[Eta]max$$], 2}, 0.01, 3, ControlType -> 
      Manipulator}, {{
       Hold[$CellContext`\[Tau]$$], 1}, 0.01, 2, ControlType -> 
      Manipulator}, {{
       Hold[$CellContext`\[Nu]$$], 1}, 0.01, 2, ControlType -> Manipulator}}, 
    Typeset`size$$ = {360., {103.86073194187108`, 109.59266536742422`}}, 
    Typeset`update$$ = 0, Typeset`initDone$$, Typeset`skipInitDone$$ = True, 
    Typeset`keyframeActionsQ$$ = False, Typeset`keyframeList$$ = {}}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`a$$ = 5, $CellContext`h$$ = 
        5, $CellContext`\[Alpha]$$ = 1.5, $CellContext`\[Eta]max$$ = 
        2, $CellContext`\[Eta]min$$ = 1, $CellContext`\[Nu]$$ = 
        1, $CellContext`\[Tau]$$ = 1}, "ControllerVariables" :> {}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$, Typeset`keyframeActionsQ$$, 
        Typeset`keyframeList$$}, "Body" :> Plot[{
         $CellContext`attack[$CellContext`x, $CellContext`a$$, $CellContext`\
\[Alpha]$$, $CellContext`\[Tau]$$], 
         $CellContext`handling[$CellContext`x, $CellContext`h$$, \
$CellContext`\[Eta]min$$, $CellContext`\[Eta]max$$, $CellContext`\[Nu]$$]}, \
{$CellContext`x, 0, 10}], 
      "Specifications" :> {{{$CellContext`a$$, 5}, 0.1, 
         10}, {{$CellContext`h$$, 5}, 0.1, 
         10}, {{$CellContext`\[Alpha]$$, 1.5}, 0.01, 
         3}, {{$CellContext`\[Eta]min$$, 1}, 0.01, 
         3}, {{$CellContext`\[Eta]max$$, 2}, 0.01, 
         3}, {{$CellContext`\[Tau]$$, 1}, 0.01, 
         2}, {{$CellContext`\[Nu]$$, 1}, 0.01, 2}}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{398.49, {217.31708439683516`, 222.47582463121014`}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.96900601205431*^9, 3.969006109687128*^9, 3.969009626696558*^9, 
   3.9690097123242264`*^9, 3.969086287955637*^9, 3.9690873262502823`*^9, 
   3.9690898476478043`*^9, 3.9690918789530106`*^9, {3.9690923188362007`*^9, 
   3.969092324953989*^9}, 3.9690923813028584`*^9, 3.9690924634678383`*^9, 
   3.9696919681541157`*^9, 3.969693958930292*^9, 3.9696942269501896`*^9},
 CellLabel->"Out[4]=",ExpressionUUID->"b80fffa5-bc66-a341-8c3d-cc9949d3294c"]
}, Open  ]],

Cell["The interaction rate has no analytical solution:", "Text",
 CellChangeTimes->{{3.9690049122823086`*^9, 
  3.9690049257957478`*^9}},ExpressionUUID->"42ba4b2d-e940-7942-b01b-\
6ea5dd08beb8"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    SubsuperscriptBox["\[Integral]", 
     RowBox[{"-", "\[Infinity]"}], "\[Infinity]"], 
    RowBox[{
     FractionBox[
      RowBox[{"attack", "[", 
       RowBox[{"x", ",", "a", ",", "\[Alpha]", ",", "\[Tau]"}], "]"}], 
      RowBox[{"1", "+", 
       RowBox[{
        RowBox[{"attack", "[", 
         RowBox[{"x", ",", "a", ",", "\[Alpha]", ",", "\[Tau]"}], "]"}], 
        RowBox[{"handling", "[", 
         RowBox[{
         "x", ",", "h", ",", "\[Eta]min", ",", "\[Eta]max", ",", "\[Nu]"}], 
         "]"}]}]}]], 
     RowBox[{"pdist", "[", 
      RowBox[{"x", ",", "X", ",", "\[Sigma]"}], "]"}], 
     RowBox[{"\[DifferentialD]", "x"}]}]}], "*)"}], 
  RowBox[{"(*", 
   RowBox[{
   "takes", " ", "a", " ", "long", " ", "time", " ", "to", " ", "run", " ", 
    "since", " ", "no", " ", "solution"}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.9690049308334904`*^9, 3.9690049763561993`*^9}, {
  3.9690923939535103`*^9, 
  3.969092429958334*^9}},ExpressionUUID->"e276b17b-7eb7-8e49-ba20-\
975ce8ad2a16"],

Cell[BoxData[
 RowBox[{
  SubsuperscriptBox["\[Integral]", 
   RowBox[{"-", "\[Infinity]"}], "\[Infinity]"], 
  RowBox[{
   FractionBox[
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"x", "-", "X"}], ")"}], "2"], 
         RowBox[{"2", " ", "\[Sigma]"}]]}], "-", 
       FractionBox[
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "a"}], "+", "x"}], ")"}], "2"], 
        RowBox[{"2", " ", 
         SuperscriptBox["\[Tau]", "2"]}]]}]], " ", "\[Alpha]"}], 
    RowBox[{
     SqrtBox[
      RowBox[{"2", " ", "\[Pi]"}]], " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"-", 
          FractionBox[
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "a"}], "+", "x"}], ")"}], "2"], 
           RowBox[{"2", " ", 
            SuperscriptBox["\[Tau]", "2"]}]]}]], " ", "\[Alpha]", " ", 
        RowBox[{"(", 
         RowBox[{"\[Eta]max", "+", 
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"-", 
             FractionBox[
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "h"}], "+", "x"}], ")"}], "2"], 
              RowBox[{"2", " ", 
               SuperscriptBox["\[Nu]", "2"]}]]}]], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "\[Eta]max"}], "+", "\[Eta]min"}], ")"}]}]}], 
         ")"}]}]}], ")"}], " ", 
     SqrtBox["\[Sigma]"]}]], 
   RowBox[{"\[DifferentialD]", "x"}]}]}]], "Output",
 CellChangeTimes->{3.9690049799187126`*^9, 3.969005750672926*^9},
 CellLabel->"Out[5]=",ExpressionUUID->"4235812d-f39b-044b-a3ec-16e61f36080c"]
}, Open  ]],

Cell[TextData[{
 "Averaging the attack and handling rates introduces interesting new \
variables: ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox[
     SubscriptBox["d", "\[Alpha]"], "2"], "=", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       OverscriptBox["x", "_"], "-", 
       SubscriptBox["\[Theta]", "\[Alpha]"]}], ")"}], "2"]}], 
   TraditionalForm]],ExpressionUUID->"85c3c533-f191-b74b-8b52-a6dfafd59cb5"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox[
     SubscriptBox["d", "\[Eta]"], "2"], "=", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       OverscriptBox["x", "_"], "-", 
       SubscriptBox["\[Theta]", "\[Eta]"]}], ")"}], "2"]}], TraditionalForm]],
  ExpressionUUID->"5ffcb1ed-60c7-164d-aff3-ff886b9426f1"],
 ", the squared distance between the mean trait in the population and the \
optimal value for attack and handling, respectively. The expressions of the \
average attack and handling rates are ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         OverscriptBox["\[Alpha]", "_"], "\[LongEqual]", 
         SubsuperscriptBox["\[Integral]", 
          RowBox[{"-", "\[Infinity]"}], "\[Infinity]"], "\[Alpha]", 
         RowBox[{"(", 
           StyleBox["x", "TI"], ")"}], 
         StyleBox["p", "TI"], 
         RowBox[{"(", 
           StyleBox["x", "TI"], ")"}], "\[NonBreakingSpace]", 
         StyleBox["d", FontSlant -> "Plain"], " ", 
         StyleBox["x", "TI"]}], TraditionalForm], "errors" -> {}, "input" -> 
     "\\bar{\\alpha}=\\int_{-\\infty}^{\\infty}\\alpha(x)p(x)~\\mathrm{d}\\,\
x", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "b7d99110-8157-0e43-9670-c353ed966282"],
 " and ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         OverscriptBox["\[Eta]", "_"], "\[LongEqual]", 
         SubsuperscriptBox["\[Integral]", 
          RowBox[{"-", "\[Infinity]"}], "\[Infinity]"], "\[Eta]", 
         RowBox[{"(", 
           StyleBox["x", "TI"], ")"}], 
         StyleBox["p", "TI"], 
         RowBox[{"(", 
           StyleBox["x", "TI"], ")"}], "\[NonBreakingSpace]", 
         StyleBox["d", FontSlant -> "Plain"], " ", 
         StyleBox["x", "TI"]}], TraditionalForm], "errors" -> {}, "input" -> 
     "\\bar{\\eta}=\\int_{-\\infty}^{\\infty}\\eta(x)p(x)~\\mathrm{d}\\,x", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "86c31f17-3368-aa44-b613-2cf616b50124"],
 " respectively."
}], "Text",
 CellChangeTimes->{{3.9690055271765957`*^9, 3.969005692931328*^9}, {
  3.969007186465599*^9, 3.969007207849415*^9}, {3.969007242908432*^9, 
  3.9690072611590385`*^9}, {3.969007296738451*^9, 
  3.9690073127358303`*^9}},ExpressionUUID->"5ed7661b-6a75-014c-ab24-\
3daad5ddc1af"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Average", " ", "attack", " ", "rate"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    SubsuperscriptBox["\[Integral]", 
     RowBox[{"-", "\[Infinity]"}], "\[Infinity]"], 
    RowBox[{
     RowBox[{"attack", "[", 
      RowBox[{"x", ",", "a", ",", "\[Alpha]", ",", "\[Tau]"}], "]"}], 
     RowBox[{"pdist", "[", 
      RowBox[{"x", ",", "X", ",", "\[Sigma]"}], "]"}], 
     RowBox[{"\[DifferentialD]", "x"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"AvgAttack", "[", 
     RowBox[{
     "a_", ",", "\[Alpha]_", ",", "\[Tau]_", ",", "X_", ",", "\[Sigma]_"}], 
     "]"}], ":=", 
    FractionBox[
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"a", "-", "X"}], ")"}], "2"], 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{"\[Sigma]", "+", 
            SuperscriptBox["\[Tau]", "2"]}], ")"}]}]]}]], " ", "\[Alpha]"}], 
     RowBox[{
      SqrtBox["\[Sigma]"], " ", 
      SqrtBox[
       RowBox[{
        FractionBox["1", "\[Sigma]"], "+", 
        FractionBox["1", 
         SuperscriptBox["\[Tau]", "2"]]}]]}]]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Subsituting", " ", "a", " ", "and", " ", "X", " ", "with", " ", "da"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"AvgAttackD", "[", 
     RowBox[{"da_", ",", "\[Alpha]_", ",", "\[Tau]_", ",", "\[Sigma]_"}], 
     "]"}], ":=", 
    RowBox[{
     RowBox[{"AvgAttack", "[", 
      RowBox[{
      "a", ",", "\[Alpha]", ",", "\[Tau]", ",", "X", ",", "\[Sigma]"}], "]"}],
      "/.", 
     RowBox[{
      RowBox[{"Solve", "[", 
       RowBox[{"First", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SuperscriptBox["da", "2"], "==", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"X", "-", "a"}], ")"}], "2"]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"X", ",", "a"}], "}"}]}], "]"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}]}], " ", 
   RowBox[{"(*", 
    RowBox[{
    "The", " ", "two", " ", "solution", " ", "are", " ", "identical"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"AvgAttackD", "[", 
    RowBox[{"da", ",", "\[Alpha]", ",", "\[Tau]", ",", "\[Sigma]"}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.969005695749237*^9, 3.969005774150711*^9}, {
  3.969006173343811*^9, 3.9690063597758274`*^9}, {3.9690063901617107`*^9, 
  3.969006454560848*^9}, {3.969006501387615*^9, 3.9690065790016193`*^9}, {
  3.969006868550726*^9, 3.969006885518669*^9}, {3.9690071202032185`*^9, 
  3.969007172489847*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"5f07fcad-7649-0a43-9471-ff32b36adf5d"],

Cell[BoxData[
 TemplateBox[{
   FractionBox[
    RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"-", 
         FractionBox[
          SuperscriptBox[
           RowBox[{"(", 
             RowBox[{"a", "-", "X"}], ")"}], "2"], 
          RowBox[{"2", " ", 
            RowBox[{"(", 
              RowBox[{"\[Sigma]", "+", 
                SuperscriptBox["\[Tau]", "2"]}], ")"}]}]]}]], " ", 
      "\[Alpha]"}], 
    RowBox[{
      SqrtBox["\[Sigma]"], " ", 
      SqrtBox[
       RowBox[{
         FractionBox["1", "\[Sigma]"], "+", 
         FractionBox["1", 
          SuperscriptBox["\[Tau]", "2"]]}]]}]], 
   RowBox[{
     RowBox[{"Re", "[", 
       RowBox[{
         FractionBox["1", "\[Sigma]"], "+", 
         FractionBox["1", 
          SuperscriptBox["\[Tau]", "2"]]}], "]"}], ">", "0"}]},
  "ConditionalExpression"]], "Output",
 CellChangeTimes->{{3.969006557896145*^9, 3.9690065844233093`*^9}, 
   3.9690073812208023`*^9, 3.9690924437192535`*^9, 3.969092513556982*^9},
 CellLabel->"Out[5]=",ExpressionUUID->"17b48c2e-d683-714a-a439-28a57f304ed8"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", 
     FractionBox[
      SuperscriptBox["da", "2"], 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{"\[Sigma]", "+", 
         SuperscriptBox["\[Tau]", "2"]}], ")"}]}]]}]], " ", "\[Alpha]"}], 
  RowBox[{
   SqrtBox["\[Sigma]"], " ", 
   SqrtBox[
    RowBox[{
     FractionBox["1", "\[Sigma]"], "+", 
     FractionBox["1", 
      SuperscriptBox["\[Tau]", "2"]]}]]}]]], "Output",
 CellChangeTimes->{{3.969006557896145*^9, 3.9690065844233093`*^9}, 
   3.9690073812208023`*^9, 3.9690924437192535`*^9, 3.9690925135798016`*^9},
 CellLabel->"Out[8]=",ExpressionUUID->"51e79dbd-ae6d-f441-a0ba-117b65fc4402"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Average", " ", "handling", " ", "rate"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     SubsuperscriptBox["\[Integral]", 
      RowBox[{"-", "\[Infinity]"}], "\[Infinity]"], 
     RowBox[{
      RowBox[{"handling", "[", 
       RowBox[{
       "x", ",", "h", ",", "\[Eta]min", ",", "\[Eta]max", ",", "\[Nu]"}], 
       "]"}], 
      RowBox[{"pdist", "[", 
       RowBox[{"x", ",", "X", ",", "\[Sigma]"}], "]"}], 
      RowBox[{"\[DifferentialD]", "x"}]}]}], "//", "FullSimplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"AvgHandling", "[", 
     RowBox[{
     "h_", ",", "\[Eta]min_", ",", "\[Eta]max_", ",", "\[Nu]_", ",", "X_", ",",
       "\[Sigma]_"}], "]"}], ":=", 
    FractionBox[
     RowBox[{
      FractionBox[
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"-", 
          FractionBox[
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"h", "-", "X"}], ")"}], "2"], 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["\[Nu]", "2"], "+", "\[Sigma]"}], ")"}]}]]}]], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "\[Eta]max"}], "+", "\[Eta]min"}], ")"}]}], 
       SqrtBox[
        RowBox[{
         FractionBox["1", 
          SuperscriptBox["\[Nu]", "2"]], "+", 
         FractionBox["1", "\[Sigma]"]}]]], "+", 
      FractionBox["\[Eta]max", 
       SqrtBox[
        FractionBox["1", "\[Sigma]"]]]}], 
     SqrtBox["\[Sigma]"]]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Subsituting", " ", "h", " ", "and", " ", "X", " ", "with", " ", "dh"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"AvgHandlingD", "[", 
     RowBox[{
     "dh_", ",", "\[Eta]min_", ",", "\[Eta]max_", ",", "\[Nu]_", ",", 
      "\[Sigma]_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"AvgHandling", "[", 
      RowBox[{
      "h", ",", "\[Eta]min", ",", "\[Eta]max", ",", "\[Nu]", ",", "X", ",", 
       "\[Sigma]"}], "]"}], "/.", 
     RowBox[{
      RowBox[{"Solve", "[", 
       RowBox[{"First", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SuperscriptBox["dh", "2"], "==", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"X", "-", "h"}], ")"}], "2"]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"X", ",", "h"}], "}"}]}], "]"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}]}], 
   RowBox[{"(*", 
    RowBox[{
    "The", " ", "two", " ", "solutions", " ", "are", " ", "identical"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"AvgHandlingD", "[", 
    RowBox[{
    "dh", ",", "\[Eta]min", ",", "\[Eta]max", ",", "\[Nu]", ",", "\[Sigma]"}],
     "]"}]}]}]], "Input",
 CellChangeTimes->{{3.9690064709656277`*^9, 3.969006484610304*^9}, {
   3.9690066065690536`*^9, 3.969006649806711*^9}, {3.9690067440753593`*^9, 
   3.9690068489143143`*^9}, {3.9690068886629486`*^9, 3.969006898735079*^9}, {
   3.9690069498794384`*^9, 3.9690069544041176`*^9}, {3.9690070306389236`*^9, 
   3.9690070312906494`*^9}, {3.9690073394438343`*^9, 3.969007365556408*^9}, {
   3.9690088476720886`*^9, 3.9690088500347214`*^9}, {3.9690089113233986`*^9, 
   3.9690089118199425`*^9}, 3.9690089667475796`*^9, 3.9690090655828304`*^9, 
   3.9690099428050823`*^9, 3.9690099935327263`*^9},
 CellLabel->"In[9]:=",ExpressionUUID->"0b1444f5-8ac4-c946-b708-959b810ae12b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"\[Eta]max", " ", 
     SqrtBox[
      FractionBox["1", "\[Sigma]"]]}], "+", 
    FractionBox[
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"h", "-", "X"}], ")"}], "2"], 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["\[Nu]", "2"], "+", "\[Sigma]"}], ")"}]}]]}]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "\[Eta]max"}], "+", "\[Eta]min"}], ")"}]}], 
     RowBox[{
      SqrtBox[
       RowBox[{
        FractionBox["1", 
         SuperscriptBox["\[Nu]", "2"]], "+", 
        FractionBox["1", "\[Sigma]"]}]], " ", "\[Sigma]"}]]}], ")"}], " ", 
  SqrtBox["\[Sigma]"]}]], "Output",
 CellChangeTimes->{
  3.9690061972295113`*^9, {3.9690062481979084`*^9, 3.9690062634357986`*^9}, 
   3.9690062965047035`*^9, 3.969006367425337*^9, {3.9690064393888073`*^9, 
   3.9690064665206203`*^9}, 3.969006906863386*^9, 3.969007001933031*^9, 
   3.9690070733502083`*^9, 3.9690074428512573`*^9, 3.9690089045976276`*^9, 
   3.9690089547952557`*^9, 3.969009005660349*^9, 3.9690090984200554`*^9, 
   3.9690099833733177`*^9, 3.9690925713227882`*^9},
 CellLabel->"Out[9]=",ExpressionUUID->"66539279-7b4c-884f-a353-6c39ada4da9a"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   FractionBox[
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"-", 
       FractionBox[
        SuperscriptBox["dh", "2"], 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["\[Nu]", "2"], "+", "\[Sigma]"}], ")"}]}]]}]], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "\[Eta]max"}], "+", "\[Eta]min"}], ")"}]}], 
    SqrtBox[
     RowBox[{
      FractionBox["1", 
       SuperscriptBox["\[Nu]", "2"]], "+", 
      FractionBox["1", "\[Sigma]"]}]]], "+", 
   FractionBox["\[Eta]max", 
    SqrtBox[
     FractionBox["1", "\[Sigma]"]]]}], 
  SqrtBox["\[Sigma]"]]], "Output",
 CellChangeTimes->{
  3.9690061972295113`*^9, {3.9690062481979084`*^9, 3.9690062634357986`*^9}, 
   3.9690062965047035`*^9, 3.969006367425337*^9, {3.9690064393888073`*^9, 
   3.9690064665206203`*^9}, 3.969006906863386*^9, 3.969007001933031*^9, 
   3.9690070733502083`*^9, 3.9690074428512573`*^9, 3.9690089045976276`*^9, 
   3.9690089547952557`*^9, 3.969009005660349*^9, 3.9690090984200554`*^9, 
   3.9690099833733177`*^9, 3.969092571331526*^9},
 CellLabel->"Out[12]=",ExpressionUUID->"d080a847-09ef-5c43-af72-48c9e4af36d5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Numerical", " ", "functions", " ", "needed", " ", "for", " ", "the", " ", 
    "graph"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"AvgAttackNum", "[", 
     RowBox[{
      RowBox[{"da_", "?", "NumericQ"}], ",", 
      RowBox[{"\[Alpha]_", "?", "NumericQ"}], ",", 
      RowBox[{"\[Tau]_", "?", "NumericQ"}], ",", 
      RowBox[{"\[Sigma]_", "?", "NumericQ"}]}], "]"}], ":=", 
    FractionBox[
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox["da", "2"], 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{"\[Sigma]", "+", 
            SuperscriptBox["\[Tau]", "2"]}], ")"}]}]]}]], " ", "\[Alpha]"}], 
     RowBox[{
      SqrtBox["\[Sigma]"], " ", 
      SqrtBox[
       RowBox[{
        FractionBox["1", "\[Sigma]"], "+", 
        FractionBox["1", 
         SuperscriptBox["\[Tau]", "2"]]}]]}]]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"AvgHandlingNum", "[", 
     RowBox[{
      RowBox[{"dh_", "?", "NumericQ"}], ",", 
      RowBox[{"\[Eta]min_", "?", "NumericQ"}], ",", 
      RowBox[{"\[Eta]max_", "?", "NumericQ"}], ",", 
      RowBox[{"\[Nu]_", "?", "NumericQ"}], ",", 
      RowBox[{"\[Sigma]_", "?", "NumericQ"}]}], "]"}], ":=", 
    FractionBox[
     RowBox[{
      FractionBox[
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"-", 
          FractionBox[
           SuperscriptBox["dh", "2"], 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["\[Nu]", "2"], "+", "\[Sigma]"}], ")"}]}]]}]], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "\[Eta]max"}], "+", "\[Eta]min"}], ")"}]}], 
       SqrtBox[
        RowBox[{
         FractionBox["1", 
          SuperscriptBox["\[Nu]", "2"]], "+", 
         FractionBox["1", "\[Sigma]"]}]]], "+", 
      FractionBox["\[Eta]max", 
       SqrtBox[
        FractionBox["1", "\[Sigma]"]]]}], 
     SqrtBox["\[Sigma]"]]}], "\[IndentingNewLine]", 
   RowBox[{"Manipulate", "[", 
    RowBox[{
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"AvgAttackNum", "[", 
          RowBox[{"d", ",", "\[Alpha]", ",", "\[Tau]", ",", "\[Sigma]"}], 
          "]"}], ",", 
         RowBox[{"AvgHandlingNum", "[", 
          RowBox[{
          "d", ",", "\[Eta]min", ",", "\[Eta]max", ",", "\[Nu]", ",", 
           "\[Sigma]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"d", ",", 
         RowBox[{"-", "5"}], ",", "5"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Alpha]", ",", "1.5"}], "}"}], ",", "0.01", ",", "3"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Eta]min", ",", "1"}], "}"}], ",", "0.01", ",", "3"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Eta]max", ",", "2"}], "}"}], ",", "0.01", ",", "3"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Tau]", ",", "1"}], "}"}], ",", "0.01", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Nu]", ",", "1"}], "}"}], ",", "0.01", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Sigma]", ",", "1"}], "}"}], ",", "0.01", ",", "4"}], 
      "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.9690104884147015`*^9, 3.969010580109747*^9}, {
  3.969010634270582*^9, 3.9690106826425953`*^9}, {3.9690110259407997`*^9, 
  3.969011060761448*^9}},
 CellLabel->"In[41]:=",ExpressionUUID->"550d4ba5-78fd-e841-9dc7-6f81559eb1d3"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`\[Alpha]$$ = 1.5, $CellContext`\[Eta]max$$ =
     2, $CellContext`\[Eta]min$$ = 1, $CellContext`\[Nu]$$ = 
    1, $CellContext`\[Sigma]$$ = 1, $CellContext`\[Tau]$$ = 1, 
    Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"sans titre\"", Typeset`specs$$ = {{{
       Hold[$CellContext`\[Alpha]$$], 1.5}, 0.01, 3, ControlType -> 
      Manipulator}, {{
       Hold[$CellContext`\[Eta]min$$], 1}, 0.01, 3, ControlType -> 
      Manipulator}, {{
       Hold[$CellContext`\[Eta]max$$], 2}, 0.01, 3, ControlType -> 
      Manipulator}, {{
       Hold[$CellContext`\[Tau]$$], 1}, 0.01, 2, ControlType -> 
      Manipulator}, {{
       Hold[$CellContext`\[Nu]$$], 1}, 0.01, 2, ControlType -> Manipulator}, {{
       Hold[$CellContext`\[Sigma]$$], 1}, 0.01, 4, ControlType -> 
      Manipulator}}, Typeset`size$$ = {
    360., {108.7621172734546, 114.49405069900774`}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = True, 
    Typeset`keyframeActionsQ$$ = False, Typeset`keyframeList$$ = {}}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`\[Alpha]$$ = 1.5, $CellContext`\[Eta]max$$ = 
        2, $CellContext`\[Eta]min$$ = 1, $CellContext`\[Nu]$$ = 
        1, $CellContext`\[Sigma]$$ = 1, $CellContext`\[Tau]$$ = 1}, 
      "ControllerVariables" :> {}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$, Typeset`keyframeActionsQ$$, 
        Typeset`keyframeList$$}, "Body" :> Plot[{
         $CellContext`AvgAttackNum[$CellContext`d, $CellContext`\[Alpha]$$, \
$CellContext`\[Tau]$$, $CellContext`\[Sigma]$$], 
         $CellContext`AvgHandlingNum[$CellContext`d, \
$CellContext`\[Eta]min$$, $CellContext`\[Eta]max$$, $CellContext`\[Nu]$$, \
$CellContext`\[Sigma]$$]}, {$CellContext`d, -5, 5}], 
      "Specifications" :> {{{$CellContext`\[Alpha]$$, 1.5}, 0.01, 
         3}, {{$CellContext`\[Eta]min$$, 1}, 0.01, 
         3}, {{$CellContext`\[Eta]max$$, 2}, 0.01, 
         3}, {{$CellContext`\[Tau]$$, 1}, 0.01, 
         2}, {{$CellContext`\[Nu]$$, 1}, 0.01, 
         2}, {{$CellContext`\[Sigma]$$, 1}, 0.01, 4}}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{398.49, {209.7984697284187, 214.95720996279368`}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{3.969011063492317*^9, 3.9690926385070057`*^9, 
  3.9696919987436485`*^9, 3.96969396682094*^9},
 CellLabel->"Out[43]=",ExpressionUUID->"657d882b-441c-3a4d-b551-d7561363c72e"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Jacobian method", "Chapter",
 CellChangeTimes->{{3.9690858875086403`*^9, 
  3.9690858914051304`*^9}},ExpressionUUID->"4376ad1a-4815-4342-97a2-\
c297be7e7f58"],

Cell["\<\
This method allows to compute stability without having to numerically solve \
the whole system. It is described in more detail in the first Section, and \
applied iteratively to reproduce Figure 3 in the second.\
\>", "Text",
 CellChangeTimes->{{3.9696976485841465`*^9, 
  3.9696977006963215`*^9}},ExpressionUUID->"3a795b00-9cd4-124f-b619-\
54c553267921"],

Cell[CellGroupData[{

Cell["Introduction to the Jacobian method", "Section",
 CellChangeTimes->{{3.9696976202477474`*^9, 
  3.96969762531464*^9}},ExpressionUUID->"639647dd-b771-ee44-89c9-\
4ad174976195"],

Cell["\<\
The stability of a system can be checked around an equilibrium using the \
Jacobian method. Unfortunately, there\[CloseCurlyQuote]s no analytical \
solution to the equilibrium for this system:\
\>", "Text",
 CellChangeTimes->{{3.9690858973345737`*^9, 
  3.96908596186467*^9}},ExpressionUUID->"f3def23c-42e4-2449-8bf5-\
a293118a7b08"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{
    "R_", ",", "c_", ",", "r_", ",", "k_", ",", "a_", ",", "\[Alpha]_", ",", 
     "\[Tau]_", ",", "h_", ",", "\[Eta]min_", ",", "\[Eta]max_", ",", 
     "\[Nu]_", ",", "X_", ",", "\[Sigma]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"r", " ", "R", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       FractionBox["R", "k"]}], ")"}]}], "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SubsuperscriptBox["\[Integral]", 
        RowBox[{"-", "\[Infinity]"}], "\[Infinity]"], 
       RowBox[{
        FractionBox[
         RowBox[{"attack", "[", 
          RowBox[{"x", ",", "a", ",", "\[Alpha]", ",", "\[Tau]"}], "]"}], 
         RowBox[{"1", "+", 
          RowBox[{
           RowBox[{"attack", "[", 
            RowBox[{"x", ",", "a", ",", "\[Alpha]", ",", "\[Tau]"}], "]"}], 
           RowBox[{"handling", "[", 
            RowBox[{
            "x", ",", "h", ",", "\[Eta]min", ",", "\[Eta]max", ",", "\[Nu]"}],
             "]"}], "R"}]}]], 
        RowBox[{"pdist", "[", 
         RowBox[{"x", ",", "X", ",", "\[Sigma]"}], "]"}], 
        RowBox[{"\[DifferentialD]", "x"}]}]}], ")"}], "R", " ", "c"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"g", "[", 
    RowBox[{
    "R_", ",", "c_", ",", "\[Epsilon]_", ",", "\[Beta]_", ",", "a_", ",", 
     "\[Alpha]_", ",", "\[Tau]_", ",", "h_", ",", "\[Eta]min_", ",", 
     "\[Eta]max_", ",", "\[Nu]_", ",", "X_", ",", "\[Sigma]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"\[Epsilon]", 
     RowBox[{"(", 
      RowBox[{
       SubsuperscriptBox["\[Integral]", 
        RowBox[{"-", "\[Infinity]"}], "\[Infinity]"], 
       RowBox[{
        FractionBox[
         RowBox[{"attack", "[", 
          RowBox[{"x", ",", "a", ",", "\[Alpha]", ",", "\[Tau]"}], "]"}], 
         RowBox[{"1", "+", 
          RowBox[{
           RowBox[{"attack", "[", 
            RowBox[{"x", ",", "a", ",", "\[Alpha]", ",", "\[Tau]"}], "]"}], 
           RowBox[{"handling", "[", 
            RowBox[{
            "x", ",", "h", ",", "\[Eta]min", ",", "\[Eta]max", ",", "\[Nu]"}],
             "]"}], "R"}]}]], 
        RowBox[{"pdist", "[", 
         RowBox[{"x", ",", "X", ",", "\[Sigma]"}], "]"}], 
        RowBox[{"\[DifferentialD]", "x"}]}]}], ")"}], "R", " ", "c"}], "-", 
    RowBox[{"\[Beta]", " ", "c"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"sol", "=", 
     RowBox[{
      RowBox[{"Solve", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"f", "[", 
            RowBox[{
            "R", ",", "c", ",", "r", ",", "k", ",", "a", ",", "\[Alpha]", ",",
              "\[Tau]", ",", "h", ",", "\[Eta]min", ",", "\[Eta]max", ",", 
             "\[Nu]", ",", "X", ",", "\[Sigma]"}], "]"}], "==", "0"}], ",", 
          RowBox[{
           RowBox[{"g", "[", 
            RowBox[{
            "R", ",", "c", ",", "\[Epsilon]", ",", "\[Beta]", ",", "a", ",", 
             "\[Alpha]", ",", "\[Tau]", ",", "h", ",", "\[Eta]min", ",", 
             "\[Eta]max", ",", "\[Nu]", ",", "X", ",", "\[Sigma]"}], "]"}], "==",
            "0"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"R", ",", "c"}], "}"}]}], "]"}], " ", "This", " ", "lign", " ", 
      RowBox[{"doesn", "'"}], "t", " ", "converge"}]}], ",", " ", 
    RowBox[{"so", " ", 
     RowBox[{"don", "'"}], "t", " ", "run", " ", "it"}]}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.9690859662363377`*^9, 3.9690862811975403`*^9}, {
  3.9690897130889645`*^9, 3.9690897509033737`*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"c049110d-378b-7440-ace7-61afd1f26e6a"],

Cell[TextData[{
 "We thus have to search for a solution numerically. The equilibrium \
condition is:\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"{", 
         Cell[
          BoxData[
           FormBox[
            GridBox[{{
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    RowBox[{
                    StyleBox["r", "TI"], 
                    SuperscriptBox[
                    StyleBox["R", "TI"], "*"], 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    FractionBox[
                    SuperscriptBox[
                    StyleBox["R", "TI"], "*"], 
                    StyleBox["k", "TI"]]}], ")"}], "\[LongEqual]", 
                    StyleBox["I", "TI"], 
                    RowBox[{"(", 
                    SuperscriptBox[
                    StyleBox["R", "TI"], "*"], ")"}], 
                    SuperscriptBox[
                    StyleBox["R", "TI"], "*"], 
                    SuperscriptBox[
                    StyleBox["C", "TI"], "*"]}]], "InlineFormula"]}]]}, {
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    RowBox[{"\[Epsilon]", 
                    StyleBox["I", "TI"], 
                    RowBox[{"(", 
                    SuperscriptBox[
                    StyleBox["R", "TI"], "*"], ")"}], 
                    SuperscriptBox[
                    StyleBox["R", "TI"], "*"], 
                    SuperscriptBox[
                    StyleBox["C", "TI"], "*"], "\[LongEqual]", "\[Beta]", 
                    SuperscriptBox[
                    StyleBox["C", "TI"], "*"]}]], "InlineFormula"]}]]}}, 
             ColumnAlignments -> Left], TraditionalForm]]]}], 
       TraditionalForm], "errors" -> {}, "input" -> 
     "\\left\\{\\begin{array}{l}r R^*(1-\\frac{R^*}{k})=I(R^*)R^*C^*\\\\ \
\\epsilon I(R^*)R^*C^*=\\beta C^*\\end{array}\\right.", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "c58efb4a-68a2-b542-8832-0e3945603877"],
 ", with ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["I", "TI"], 
         RowBox[{"(", 
           StyleBox["R", "TI"], ")"}], "\[LongEqual]", 
         SubsuperscriptBox["\[Integral]", 
          RowBox[{"-", "\[Infinity]"}], "\[Infinity]"], 
         FractionBox[
          RowBox[{"\[Alpha]", "(", 
            StyleBox["x", "TI"], ")"}], 
          RowBox[{"1", "+", "\[Alpha]", 
            RowBox[{"(", 
              StyleBox["x", "TI"], ")"}], "\[Eta]", 
            RowBox[{"(", 
              StyleBox["x", "TI"], ")"}], 
            StyleBox["R", "TI"]}]], 
         StyleBox["p", "TI"], 
         RowBox[{"(", 
           StyleBox["x", "TI"], ")"}], " ", 
         StyleBox["d", FontSlant -> "Plain"], 
         StyleBox["x", "TI"]}], TraditionalForm], "errors" -> {}, "input" -> 
     "I(R)=\\int_{-\\infty}^{\\infty}\\frac{\\alpha(x)}{1+\\alpha(x)\\eta(x)R}\
p(x)\\,\\mathrm{d}x", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "2827fd62-4fec-b548-b9cc-2a0f6de5a9a0"],
 ".\nThe second equation for ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["C", "*"], "\[NotEqual]", "0"}], TraditionalForm]],
  ExpressionUUID->"ff7e84e9-c01d-7d44-b09a-733420000340"],
 " yields ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SuperscriptBox[
          StyleBox["R", "TI"], "*"], 
         StyleBox["I", "TI"], 
         RowBox[{"(", 
           SuperscriptBox[
            StyleBox["R", "TI"], "*"], ")"}], "\[LongEqual]", 
         FractionBox["\[Beta]", "\[Epsilon]"]}], TraditionalForm], 
     "errors" -> {}, "input" -> "R^*I(R^*)=\\frac{\\beta}{\\epsilon}", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "8307a975-7051-eb41-8506-7356b3f3485e"],
 ". This can be used to find ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["R", "*"], TraditionalForm]],ExpressionUUID->
  "c3ae4c51-31d1-3a4f-8597-6e5577081839"],
 ". ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["C", "*"], TraditionalForm]],ExpressionUUID->
  "7008a64d-ad2f-b547-b184-f5269fbcf6c7"],
 " is then found with the first equation: ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SuperscriptBox[
          StyleBox["C", "TI"], "*"], "\[LongEqual]", 
         FractionBox[
          RowBox[{
            StyleBox["r", "TI"], 
            SuperscriptBox[
             StyleBox["R", "TI"], "*"], 
            RowBox[{"(", 
              RowBox[{"1", "-", 
                FractionBox[
                 SuperscriptBox[
                  StyleBox["R", "TI"], "*"], 
                 StyleBox["k", "TI"]]}], ")"}]}], 
          RowBox[{
            SuperscriptBox[
             StyleBox["R", "TI"], "*"], 
            StyleBox["I", "TI"], 
            RowBox[{"(", 
              SuperscriptBox[
               StyleBox["R", "TI"], "*"], ")"}]}]]}], TraditionalForm], 
     "errors" -> {}, "input" -> 
     "C^*=\\frac{rR^*(1-\\frac{R^*}{k})}{R^*I(R^*)}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "83e9cc64-38a0-484d-a9ce-f4fcd9724131"],
 "."
}], "Text",
 CellChangeTimes->{{3.9690863044144516`*^9, 3.9690863137110195`*^9}, {
  3.96969295794277*^9, 3.9696930268634567`*^9}, {3.9696930852885113`*^9, 
  3.969693098813284*^9}, {3.9696932155738125`*^9, 3.9696932795768967`*^9}, {
  3.9696933122036247`*^9, 3.9696933628785076`*^9}, {3.9696934198072147`*^9, 
  3.969693425579376*^9}, {3.9696934854975605`*^9, 
  3.969693508847681*^9}},ExpressionUUID->"272479aa-f654-f34e-a52f-\
ba047c65fed8"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"params", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"r", "->", "0.3"}], ",", 
     RowBox[{"\[Alpha]", "->", "2"}], ",", 
     RowBox[{"\[Eta]max", "->", "2"}], ",", 
     RowBox[{"\[Eta]min", "->", "1"}], ",", 
     RowBox[{"\[Epsilon]", "->", "0.5"}], ",", 
     RowBox[{"\[Tau]", "->", "1"}], ",", 
     RowBox[{"\[Nu]", "->", "1"}], ",", 
     RowBox[{"k", "->", "1"}], ",", 
     RowBox[{"\[Beta]", "->", "0.1"}], ",", 
     RowBox[{"X", "->", "3"}], ",", 
     RowBox[{"a", "->", "2.5"}], ",", 
     RowBox[{"h", "->", "2.5"}], ",", 
     RowBox[{"\[Sigma]", "->", 
      SqrtBox["3"]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Int1", "[", 
   RowBox[{
    RowBox[{"R_", "?", "NumericQ"}], ",", 
    RowBox[{"a_", "?", "NumericQ"}], ",", 
    RowBox[{"\[Alpha]_", "?", "NumericQ"}], ",", 
    RowBox[{"\[Tau]_", "?", "NumericQ"}], ",", 
    RowBox[{"h_", "?", "NumericQ"}], ",", 
    RowBox[{"\[Eta]min_", "?", "NumericQ"}], ",", 
    RowBox[{"\[Eta]max_", "?", "NumericQ"}], ",", 
    RowBox[{"\[Nu]_", "?", "NumericQ"}], ",", 
    RowBox[{"X_", "?", "NumericQ"}], ",", 
    RowBox[{"\[Sigma]_", "?", "NumericQ"}]}], "]"}], ":=", 
  RowBox[{"NIntegrate", "[", 
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{"attack", "[", 
       RowBox[{"x", ",", "a", ",", "\[Alpha]", ",", "\[Tau]"}], "]"}], 
      RowBox[{"1", "+", 
       RowBox[{
        RowBox[{"attack", "[", 
         RowBox[{"x", ",", "a", ",", "\[Alpha]", ",", "\[Tau]"}], "]"}], 
        RowBox[{"handling", "[", 
         RowBox[{
         "x", ",", "h", ",", "\[Eta]min", ",", "\[Eta]max", ",", "\[Nu]"}], 
         "]"}], "R"}]}]], 
     RowBox[{"pdist", "[", 
      RowBox[{"x", ",", "X", ",", "\[Sigma]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", 
      RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FNum", "[", 
   RowBox[{
    RowBox[{"R_", "?", "NumericQ"}], ",", 
    RowBox[{"a_", "?", "NumericQ"}], ",", 
    RowBox[{"\[Alpha]_", "?", "NumericQ"}], ",", 
    RowBox[{"\[Tau]_", "?", "NumericQ"}], ",", 
    RowBox[{"h_", "?", "NumericQ"}], ",", 
    RowBox[{"\[Eta]min_", "?", "NumericQ"}], ",", 
    RowBox[{"\[Eta]max_", "?", "NumericQ"}], ",", 
    RowBox[{"\[Nu]_", "?", "NumericQ"}], ",", 
    RowBox[{"X_", "?", "NumericQ"}], ",", 
    RowBox[{"\[Sigma]_", "?", "NumericQ"}], ",", 
    RowBox[{"\[Beta]_", "?", "NumericQ"}], ",", 
    RowBox[{"\[Epsilon]_", "?", "NumericQ"}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{"R", " ", 
    RowBox[{"Int1", "[", 
     RowBox[{
     "R", ",", "a", ",", "\[Alpha]", ",", "\[Tau]", ",", "h", ",", 
      "\[Eta]min", ",", "\[Eta]max", ",", "\[Nu]", ",", "X", ",", 
      "\[Sigma]"}], "]"}]}], "-", 
   FractionBox["\[Beta]", "\[Epsilon]"]}]}], "\[IndentingNewLine]", 
 RowBox[{"Rsol", "=", 
  RowBox[{"FindRoot", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"FNum", "[", 
         RowBox[{
         "R", ",", "a", ",", "\[Alpha]", ",", "\[Tau]", ",", "h", ",", 
          "\[Eta]min", ",", "\[Eta]max", ",", "\[Nu]", ",", "X", ",", 
          "\[Sigma]", ",", "\[Beta]", ",", "\[Epsilon]"}], "]"}], "/.", 
        "params"}], ")"}], "==", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"R", ",", "0.5"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"csol", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"c", "->", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        FractionBox[
         RowBox[{"r", " ", "R", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            FractionBox["R", "k"]}], ")"}]}], 
         RowBox[{"R", " ", 
          RowBox[{"Int1", "[", 
           RowBox[{
           "R", ",", "a", ",", "\[Alpha]", ",", "\[Tau]", ",", "h", ",", 
            "\[Eta]min", ",", "\[Eta]max", ",", "\[Nu]", ",", "X", ",", 
            "\[Sigma]"}], "]"}]}]], ")"}], "/.", "params"}], ")"}]}], "/.", 
    "Rsol"}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.9696935171282005`*^9, 3.9696938621040535`*^9}, {
  3.969693999964657*^9, 3.9696940691391716`*^9}, {3.9696941039005566`*^9, 
  3.9696941972093353`*^9}, {3.969694238394335*^9, 3.9696944047919655`*^9}, {
  3.969694569397293*^9, 3.9696945900806293`*^9}, {3.9696946602871017`*^9, 
  3.9696946623564625`*^9}, {3.969695070371876*^9, 3.9696950780813236`*^9}, {
  3.9696951214496136`*^9, 3.969695127655857*^9}, {3.969695207885456*^9, 
  3.9696952433222485`*^9}, {3.9696955735346947`*^9, 3.9696955784578457`*^9}},
 CellLabel->
  "In[215]:=",ExpressionUUID->"255a51d7-8aca-014b-889d-cdac2d7a7900"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"R", "\[Rule]", "0.24900758078834193`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.9696949575478745`*^9, 3.969695079013283*^9, 3.969695124438074*^9, {
   3.9696952173763943`*^9, 3.969695244597664*^9}, 3.9696955810261326`*^9, 
   3.9697008666455517`*^9},
 CellLabel->
  "Out[218]=",ExpressionUUID->"63d07224-6453-1242-b5a0-ded163d529a2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"c", "\[Rule]", "0.28050420824741884`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.9696949575478745`*^9, 3.969695079013283*^9, 3.969695124438074*^9, {
   3.9696952173763943`*^9, 3.969695244597664*^9}, 3.9696955810261326`*^9, 
   3.9697008666600914`*^9},
 CellLabel->
  "Out[219]=",ExpressionUUID->"6e80ea7e-2c10-eb4f-b608-cfef83fbfb6e"]
}, Open  ]],

Cell["\<\
We have a feasible solution, so there\[CloseCurlyQuote]s coexistence. Let\
\[CloseCurlyQuote]s now check what the stability of this solution looks like.\
\>", "Text",
 CellChangeTimes->{{3.9696968962187862`*^9, 
  3.969696934968212*^9}},ExpressionUUID->"95277ae8-3bf5-4049-99f8-\
e24af3e21ac4"],

Cell[TextData[{
 "The Jacobian is defined as: ",
 Cell[BoxData[
  FormBox[
   RowBox[{"J", "=", 
    RowBox[{"(", GridBox[{
       {
        RowBox[{
         SubscriptBox["\[PartialD]", "R"], " ", "f"}], 
        RowBox[{
         SubscriptBox["\[PartialD]", "C"], " ", "f"}]},
       {
        RowBox[{
         SubscriptBox["\[PartialD]", "R"], " ", "g"}], 
        RowBox[{
         SubscriptBox["\[PartialD]", "C"], " ", "g"}]}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "3826b0cf-11e5-b34b-9fdd-d42e175b4b8e"],
 ". This can be formally done because in this case the integral over ",
 Cell[BoxData[
  FormBox["x", TraditionalForm]],ExpressionUUID->
  "b629a026-1ff7-2e46-9fc6-3025f27582a2"],
 " and the derivative with respect to ",
 Cell[BoxData[
  FormBox["R", TraditionalForm]],ExpressionUUID->
  "a1ebd032-a83e-8f4d-8231-fe9a5e555c3d"],
 " can be inverted (dominating function: ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[CurlyPhi]", "(", "x", ")"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        SuperscriptBox[
         RowBox[{"\[Alpha]", "(", "x", ")"}], "2"], 
        RowBox[{"\[Eta]", "(", "x", ")"}], 
        RowBox[{"p", "(", "x", ")"}]}], ">="}], "|", 
      RowBox[{
       SubscriptBox["\[PartialD]", "R"], " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{"\[Alpha]", "(", "x", ")"}], 
          RowBox[{"1", "+", 
           RowBox[{
            RowBox[{"\[Alpha]", "(", "x", ")"}], 
            RowBox[{"\[Eta]", "(", "x", ")"}], "R"}]}]], 
         RowBox[{"p", "(", "x", ")"}]}], ")"}]}], "|"}], "=", 
     RowBox[{
      FractionBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"\[Alpha]", "(", "x", ")"}], "2"], 
        RowBox[{"\[Eta]", "(", "x", ")"}], 
        RowBox[{"p", "(", "x", ")"}]}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{
           RowBox[{"\[Alpha]", "(", "x", ")"}], 
           RowBox[{"\[Eta]", "(", "x", ")"}], "R"}]}], ")"}], "2"]], " ", ">=",
       "0"}]}]}], TraditionalForm]],ExpressionUUID->
  "9c609938-0c32-8546-b33a-f1dd09de1eb8"],
 " ). However, Mathematica doesn\[CloseCurlyQuote]t know that, so we do the \
derivation by hand:\n\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         FractionBox[
          RowBox[{"\[PartialD] ", 
            StyleBox["f", "TI"]}], 
          RowBox[{"\[PartialD] ", 
            StyleBox["R", "TI"]}]], "\[LongEqual]", 
         StyleBox["r", "TI"], 
         RowBox[{"(", 
           RowBox[{"1", "-", 
             FractionBox[
              RowBox[{"2", 
                StyleBox["R", "TI"]}], 
              StyleBox["k", "TI"]]}], ")"}], "-", 
         StyleBox["C", "TI"], 
         SubsuperscriptBox["\[Integral]", 
          RowBox[{"-", "\[Infinity]"}], "\[Infinity]"], 
         RowBox[{"(", 
           RowBox[{
             FractionBox[
              RowBox[{"\[Alpha]", "(", 
                StyleBox["x", "TI"], ")"}], 
              RowBox[{"1", "+", "\[Alpha]", 
                RowBox[{"(", 
                  StyleBox["x", "TI"], ")"}], "\[Eta]", 
                RowBox[{"(", 
                  StyleBox["x", "TI"], ")"}], 
                StyleBox["R", "TI"]}]], 
             StyleBox["p", "TI"], 
             RowBox[{"(", 
               StyleBox["x", "TI"], ")"}], 
             RowBox[{"[", 
               RowBox[{"1", "-", 
                 FractionBox[
                  RowBox[{"\[Alpha]", 
                    RowBox[{"(", 
                    StyleBox["x", "TI"], ")"}], "\[Eta]", 
                    RowBox[{"(", 
                    StyleBox["x", "TI"], ")"}], 
                    StyleBox["R", "TI"]}], 
                  RowBox[{"1", "+", "\[Alpha]", 
                    RowBox[{"(", 
                    StyleBox["x", "TI"], ")"}], "\[Eta]", 
                    RowBox[{"(", 
                    StyleBox["x", "TI"], ")"}], 
                    StyleBox["R", "TI"]}]]}], "]"}], " ", 
             StyleBox["d", FontSlant -> "Plain"], 
             StyleBox["x", "TI"]}], ")"}]}], TraditionalForm], "errors" -> {},
      "input" -> 
     "\\frac{\\partial\\,f}{\\partial\\,R}=r(1-\\frac{2R}{k})-C\\int_{-\\\
infty}^{\\infty}\\left(\\frac{\\alpha(x)}{1+\\alpha(x)\\eta(x)R}p(x)\\Big[1-\\\
frac{\\alpha(x)\\eta(x)R}{1+\\alpha(x)\\eta(x)R}\\Big]\\,\\mathrm{d}x\\right)\
", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "daaeac89-b386-4243-8bab-ef1bda65ca1a"],
 "\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         FractionBox[
          RowBox[{"\[PartialD] ", 
            StyleBox["f", "TI"]}], 
          RowBox[{"\[PartialD] ", 
            StyleBox["C", "TI"]}]], "\[LongEqual]", "-", 
         StyleBox["R", "TI"], 
         SubsuperscriptBox["\[Integral]", 
          RowBox[{"-", "\[Infinity]"}], "\[Infinity]"], 
         RowBox[{"(", 
           RowBox[{
             FractionBox[
              RowBox[{"\[Alpha]", "(", 
                StyleBox["x", "TI"], ")"}], 
              RowBox[{"1", "+", "\[Alpha]", 
                RowBox[{"(", 
                  StyleBox["x", "TI"], ")"}], "\[Eta]", 
                RowBox[{"(", 
                  StyleBox["x", "TI"], ")"}], 
                StyleBox["R", "TI"]}]], 
             StyleBox["p", "TI"], 
             RowBox[{"(", 
               StyleBox["x", "TI"], ")"}], " ", 
             StyleBox["d", FontSlant -> "Plain"], 
             StyleBox["x", "TI"]}], ")"}]}], TraditionalForm], "errors" -> {},
      "input" -> 
     "\\frac{\\partial\\,f}{\\partial\\,C}=-R\\int_{-\\infty}^{\\infty}\\left(\
\\frac{\\alpha(x)}{1+\\alpha(x)\\eta(x)R}p(x)\\,\\mathrm{d}x\\right)", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "f6a91ecb-aa8e-8b44-a390-74e7a832afed"],
 "\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         FractionBox[
          RowBox[{"\[PartialD] ", 
            StyleBox["g", "TI"]}], 
          RowBox[{"\[PartialD] ", 
            StyleBox["R", "TI"]}]], "\[LongEqual]", "\[Epsilon]", 
         StyleBox["C", "TI"], 
         SubsuperscriptBox["\[Integral]", 
          RowBox[{"-", "\[Infinity]"}], "\[Infinity]"], 
         RowBox[{"(", 
           RowBox[{
             FractionBox[
              RowBox[{"\[Alpha]", "(", 
                StyleBox["x", "TI"], ")"}], 
              RowBox[{"1", "+", "\[Alpha]", 
                RowBox[{"(", 
                  StyleBox["x", "TI"], ")"}], "\[Eta]", 
                RowBox[{"(", 
                  StyleBox["x", "TI"], ")"}], 
                StyleBox["R", "TI"]}]], 
             StyleBox["p", "TI"], 
             RowBox[{"(", 
               StyleBox["x", "TI"], ")"}], 
             RowBox[{"[", 
               RowBox[{"1", "-", 
                 FractionBox[
                  RowBox[{"\[Alpha]", 
                    RowBox[{"(", 
                    StyleBox["x", "TI"], ")"}], "\[Eta]", 
                    RowBox[{"(", 
                    StyleBox["x", "TI"], ")"}], 
                    StyleBox["R", "TI"]}], 
                  RowBox[{"1", "+", "\[Alpha]", 
                    RowBox[{"(", 
                    StyleBox["x", "TI"], ")"}], "\[Eta]", 
                    RowBox[{"(", 
                    StyleBox["x", "TI"], ")"}], 
                    StyleBox["R", "TI"]}]]}], "]"}], " ", 
             StyleBox["d", FontSlant -> "Plain"], 
             StyleBox["x", "TI"]}], ")"}]}], TraditionalForm], "errors" -> {},
      "input" -> 
     "\\frac{\\partial\\,g}{\\partial\\,R}=\\epsilon \
C\\int_{-\\infty}^{\\infty}\\left(\\frac{\\alpha(x)}{1+\\alpha(x)\\eta(x)R}p(\
x)\\Big[1-\\frac{\\alpha(x)\\eta(x)R}{1+\\alpha(x)\\eta(x)R}\\Big]\\,\\mathrm{\
d}x\\right)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "10afa037-6158-f042-8314-d09e50358cc3"],
 "\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         FractionBox[
          RowBox[{"\[PartialD] ", 
            StyleBox["g", "TI"]}], 
          RowBox[{"\[PartialD] ", 
            StyleBox["C", "TI"]}]], "\[LongEqual]", "\[Epsilon]", 
         StyleBox["R", "TI"], 
         SubsuperscriptBox["\[Integral]", 
          RowBox[{"-", "\[Infinity]"}], "\[Infinity]"], 
         RowBox[{"(", 
           RowBox[{
             FractionBox[
              RowBox[{"\[Alpha]", "(", 
                StyleBox["x", "TI"], ")"}], 
              RowBox[{"1", "+", "\[Alpha]", 
                RowBox[{"(", 
                  StyleBox["x", "TI"], ")"}], "\[Eta]", 
                RowBox[{"(", 
                  StyleBox["x", "TI"], ")"}], 
                StyleBox["R", "TI"]}]], 
             StyleBox["p", "TI"], 
             RowBox[{"(", 
               StyleBox["x", "TI"], ")"}], " ", 
             StyleBox["d", FontSlant -> "Plain"], 
             StyleBox["x", "TI"]}], ")"}], "-", "\[Beta]"}], TraditionalForm],
      "errors" -> {}, "input" -> 
     "\\frac{\\partial\\,g}{\\partial\\,C}=\\epsilon \
R\\int_{-\\infty}^{\\infty}\\left(\\frac{\\alpha(x)}{1+\\alpha(x)\\eta(x)R}p(\
x)\\,\\mathrm{d}x\\right)-\\beta", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "327a9d92-6b47-9d40-87fd-1b9285288162"]
}], "Text",
 CellChangeTimes->{{3.969088217869524*^9, 3.9690882274967194`*^9}, {
  3.969088270844637*^9, 3.9690883328082924`*^9}, {3.969088366434141*^9, 
  3.9690887040825615`*^9}, {3.9690896832992935`*^9, 3.969089691348757*^9}, {
  3.9690904530555744`*^9, 3.9690908716966248`*^9}, {3.9690909436335125`*^9, 
  3.969090966281307*^9}, {3.9690909983018456`*^9, 3.969091002012064*^9}, {
  3.9690911488595104`*^9, 3.969091150954365*^9}, {3.969091255934601*^9, 
  3.969091257920862*^9}},ExpressionUUID->"6ffa969a-58b4-9547-999f-\
0392b2f1c9d4"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Int2", "[", 
   RowBox[{
    RowBox[{"R_", "?", "NumericQ"}], ",", 
    RowBox[{"a_", "?", "NumericQ"}], ",", 
    RowBox[{"\[Alpha]_", "?", "NumericQ"}], ",", 
    RowBox[{"\[Tau]_", "?", "NumericQ"}], ",", 
    RowBox[{"h_", "?", "NumericQ"}], ",", 
    RowBox[{"\[Eta]min_", "?", "NumericQ"}], ",", 
    RowBox[{"\[Eta]max_", "?", "NumericQ"}], ",", 
    RowBox[{"\[Nu]_", "?", "NumericQ"}], ",", 
    RowBox[{"X_", "?", "NumericQ"}], ",", 
    RowBox[{"\[Sigma]_", "?", "NumericQ"}]}], "]"}], ":=", 
  RowBox[{"NIntegrate", "[", 
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{"attack", "[", 
       RowBox[{"x", ",", "a", ",", "\[Alpha]", ",", "\[Tau]"}], "]"}], 
      RowBox[{"1", "+", 
       RowBox[{
        RowBox[{"attack", "[", 
         RowBox[{"x", ",", "a", ",", "\[Alpha]", ",", "\[Tau]"}], "]"}], 
        RowBox[{"handling", "[", 
         RowBox[{
         "x", ",", "h", ",", "\[Eta]min", ",", "\[Eta]max", ",", "\[Nu]"}], 
         "]"}], "R"}]}]], 
     RowBox[{"pdist", "[", 
      RowBox[{"x", ",", "X", ",", "\[Sigma]"}], "]"}], 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       FractionBox[
        RowBox[{
         RowBox[{"attack", "[", 
          RowBox[{"x", ",", "a", ",", "\[Alpha]", ",", "\[Tau]"}], "]"}], 
         RowBox[{"handling", "[", 
          RowBox[{
          "x", ",", "h", ",", "\[Eta]min", ",", "\[Eta]max", ",", "\[Nu]"}], 
          "]"}], "R"}], 
        RowBox[{"1", "+", 
         RowBox[{
          RowBox[{"attack", "[", 
           RowBox[{"x", ",", "a", ",", "\[Alpha]", ",", "\[Tau]"}], "]"}], 
          RowBox[{"handling", "[", 
           RowBox[{
           "x", ",", "h", ",", "\[Eta]min", ",", "\[Eta]max", ",", "\[Nu]"}], 
           "]"}], "R"}]}]]}], ")"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", 
      RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"JacobiAtEq", "=", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"r", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           FractionBox[
            RowBox[{"2", "R"}], "k"]}], ")"}]}], "-", 
        RowBox[{"c", " ", 
         RowBox[{"Int2", "[", 
          RowBox[{
          "R", ",", "a", ",", "\[Alpha]", ",", "\[Tau]", ",", "h", ",", 
           "\[Eta]min", ",", "\[Eta]max", ",", "\[Nu]", ",", "X", ",", 
           "\[Sigma]"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"-", "R"}], " ", 
        RowBox[{"Int1", "[", 
         RowBox[{
         "R", ",", "a", ",", "\[Alpha]", ",", "\[Tau]", ",", "h", ",", 
          "\[Eta]min", ",", "\[Eta]max", ",", "\[Nu]", ",", "X", ",", 
          "\[Sigma]"}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Epsilon]", " ", "c", " ", 
        RowBox[{"Int2", "[", 
         RowBox[{
         "R", ",", "a", ",", "\[Alpha]", ",", "\[Tau]", ",", "h", ",", 
          "\[Eta]min", ",", "\[Eta]max", ",", "\[Nu]", ",", "X", ",", 
          "\[Sigma]"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Epsilon]", " ", "R", " ", 
         RowBox[{"Int1", "[", 
          RowBox[{
          "R", ",", "a", ",", "\[Alpha]", ",", "\[Tau]", ",", "h", ",", 
           "\[Eta]min", ",", "\[Eta]max", ",", "\[Nu]", ",", "X", ",", 
           "\[Sigma]"}], "]"}]}], "-", "\[Beta]"}]}], "}"}]}], 
    "\[IndentingNewLine]", "}"}], "/.", 
   RowBox[{"Join", "[", 
    RowBox[{"params", ",", "Rsol", ",", "csol"}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.9690897646683865`*^9, 3.969089832292364*^9}, {
  3.969091336629671*^9, 3.969091368797514*^9}, {3.9690914023271046`*^9, 
  3.969091762128729*^9}, {3.9690918066284733`*^9, 3.969091864833351*^9}, {
  3.9696952653329678`*^9, 3.96969565082349*^9}, {3.9696957998656826`*^9, 
  3.969695799987665*^9}, {3.969696115110981*^9, 3.969696151874674*^9}},
 CellLabel->"In[91]:=",ExpressionUUID->"23694446-d90f-e74e-86da-e87dbac1fc38"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.006762211008752211`"}], ",", 
     RowBox[{"-", "0.20000000000000007`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.07867883126787352`", ",", "2.7755575615628914`*^-17"}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.969091773901764*^9, 3.9690918655153313`*^9, 
  3.969092341176365*^9, 3.969695652294716*^9, 3.969695800456257*^9, 
  3.9696961219054527`*^9, 3.969696153147108*^9},
 CellLabel->"Out[92]=",ExpressionUUID->"4164d6b0-bef2-aa44-b407-b873fa6be091"]
}, Open  ]],

Cell["We can now check the stability ", "Text",
 CellChangeTimes->{{3.9696968805808773`*^9, 
  3.969696887828718*^9}},ExpressionUUID->"f613d595-9a72-944f-9f4e-\
dc925ac7d23e"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"det", "=", 
  RowBox[{"Det", "[", "JacobiAtEq", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"tr", "=", 
  RowBox[{"Tr", "[", "JacobiAtEq", "]"}]}]}], "Input",
 CellChangeTimes->{{3.969695845710209*^9, 3.9696958704952908`*^9}, {
  3.9696961582968407`*^9, 3.969696161049143*^9}},
 CellLabel->"In[93]:=",ExpressionUUID->"c9b4358f-9e48-ec42-8bcb-1a8a2f8bf12c"],

Cell[BoxData["0.015735766253574708`"], "Output",
 CellChangeTimes->{3.9696958720503254`*^9, 3.9696961259787445`*^9, 
  3.9696961613667965`*^9},
 CellLabel->"Out[93]=",ExpressionUUID->"167b29fa-28d0-c446-be35-720f2e2e483f"],

Cell[BoxData[
 RowBox[{"-", "0.006762211008752184`"}]], "Output",
 CellChangeTimes->{3.9696958720503254`*^9, 3.9696961259787445`*^9, 
  3.9696961613667965`*^9},
 CellLabel->"Out[94]=",ExpressionUUID->"620ba61c-5526-9e45-813d-de8839165412"]
}, Open  ]],

Cell[TextData[{
 "Here, ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["det", FontSlant -> "Plain"], ">", "0"}], TraditionalForm], 
     "errors" -> {}, "input" -> "\\mathrm{det}>0", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "833cd0d2-63be-0141-b23c-4b649e1340a6"],
 " and ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["tr", FontSlant -> "Plain"], "<", "0"}], TraditionalForm], 
     "errors" -> {}, "input" -> "\\mathrm{tr}<0", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "155a4ed3-dd63-834d-acbf-d8ac35028fbe"],
 " (meaning the real part of both eigenvalues are <0), so \
we\[CloseCurlyQuote]re in a case where the solution converges with time to \
the equilibrium we found earlier ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["R", "*"], ",", 
     SuperscriptBox["C", "*"]}], ")"}], TraditionalForm]],ExpressionUUID->
  "5af88521-3311-3f4f-8728-ed50986ec504"],
 ". Damped oscillations correspond to the complex eigenvalue case, while the \
nonoscillatory case correspond to real eigenvalues. Thus, we can check the \
sign of ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[CapitalDelta]", "\[LongEqual]", 
         SuperscriptBox[
          StyleBox["tr", FontSlant -> "Plain"], "2"], "-", "4", 
         StyleBox["det", FontSlant -> "Plain"]}], TraditionalForm], 
     "errors" -> {}, "input" -> "\\Delta=\\mathrm{tr}^2-4\\mathrm{det}", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "faf5cc2b-c223-664f-97f4-2db4e64ffd51"],
 " (",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[CapitalDelta]", ">=", "0"}], TraditionalForm]],ExpressionUUID->
  "cd47b918-e7db-3a4b-9f90-33d773241ddd"],
 ": real eigenvalues, ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[CapitalDelta]", "<", "0"}], TraditionalForm]],ExpressionUUID->
  "560138c6-a994-0940-8bee-07fbeef2c29d"],
 ": complex eigenvalues)."
}], "Text",
 CellChangeTimes->{{3.969696869713604*^9, 3.969696870263342*^9}, {
  3.9696969397011833`*^9, 3.969697020570038*^9}, {3.9696972309297523`*^9, 
  3.9696973593239555`*^9}, {3.9696973915253067`*^9, 3.9696973948441525`*^9}, {
  3.9696974373370495`*^9, 
  3.9696975094877872`*^9}},ExpressionUUID->"f3f8d07d-8602-0f4c-b4d3-\
e729008f524b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SuperscriptBox["tr", "2"], "-", 
  RowBox[{"4", "det"}]}]], "Input",
 CellChangeTimes->{{3.9696975167760277`*^9, 3.9696975267009487`*^9}},
 CellLabel->"In[95]:=",ExpressionUUID->"4bb2f88c-f91c-e64c-bd3d-a3f86d7d6e12"],

Cell[BoxData[
 RowBox[{"-", "0.06289733751657195`"}]], "Output",
 CellChangeTimes->{3.9696975276242275`*^9},
 CellLabel->"Out[95]=",ExpressionUUID->"20698f66-e764-b547-83aa-aeb399fc2e04"]
}, Open  ]],

Cell["\<\
We are in the damped oscillation window! This is consistent with Figure 3 \
(parameters corresponding to the asterisk)!\
\>", "Text",
 CellChangeTimes->{{3.9696975358588543`*^9, 
  3.9696975918725395`*^9}},ExpressionUUID->"fd21f314-4978-3e4c-b732-\
08b8a0c15890"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "Figure 3 reproduction (iteration over ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["d", "2"], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "c96ae5b1-6077-1b4f-a410-99e40bdf467c"],
 " and ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[Sigma]", "2"], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "00ba3c67-ad44-aa4f-ab69-20d886e10a14"],
 ")"
}], "Section",
 CellChangeTimes->{{3.9696977071826286`*^9, 
  3.9696977372258053`*^9}},ExpressionUUID->"6d0f905b-1a7e-1442-b007-\
2aeadc74cfe6"],

Cell[TextData[{
 "We can now try to reproduce Figure 3, by generalizing this method to ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["d", "2"], ",", 
      SuperscriptBox["\[Sigma]", "2"]}], ")"}], "\[Element]", 
    RowBox[{
     RowBox[{"[", 
      RowBox[{"0", ",", "2.5"}], "]"}], "\[Times]", 
     RowBox[{"[", 
      RowBox[{"0", ",", "6"}], "]"}]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "5e182db2-5c6d-344b-a78d-fed541c941ba"],
 "."
}], "Text",
 CellChangeTimes->{{3.969697771411888*^9, 
  3.969697897977995*^9}},ExpressionUUID->"4a4b1445-82ec-a84d-a375-\
e9fe1c460977"],

Cell[CellGroupData[{

Cell["Classification and functions definition", "Subsection",
 CellChangeTimes->{{3.9696979288436317`*^9, 
  3.969697936121481*^9}},ExpressionUUID->"71f9865a-759f-7e46-88e4-\
916272564c7e"],

Cell[TextData[{
 "The classification is as follows:\n - If ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["R", "*"], "<=", "0"}], TraditionalForm]],ExpressionUUID->
  "3c8a068d-a5db-8b45-afcc-25708f65a84b"],
 " or ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["C", "*"], "<=", "0"}], TraditionalForm]],ExpressionUUID->
  "e84d9b6e-5d4f-cf4c-a86a-18c8657e83cb"],
 ", we are in the \[OpenCurlyDoubleQuote]Noncoexistence\
\[CloseCurlyDoubleQuote] domain (no feasible solution);\n - If ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["R", "*"], ">", "0"}], TraditionalForm]],ExpressionUUID->
  "7bea9c43-e04c-854b-9c07-58e17398424f"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["C", "*"], ">", "0"}], TraditionalForm]],ExpressionUUID->
  "53b4bf43-e492-6549-bfc7-fa5692886be6"],
 ", we are in one of the \[OpenCurlyDoubleQuote]Coexistence\
\[CloseCurlyDoubleQuote] domain;\n \t- If ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["det", FontSlant -> "Plain"], ">", "0"}], TraditionalForm], 
     "errors" -> {}, "input" -> "\\mathrm{det}>0", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "083e4154-7490-f24e-b2df-bfb73c0890fc"],
 ", ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["tr", FontSlant -> "Plain"], "<", "0"}], TraditionalForm], 
     "errors" -> {}, "input" -> "\\mathrm{tr}<0", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "6a35e37a-aade-ee40-8ac2-17e309c5b97f"],
 ", and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[CapitalDelta]", ">=", "0"}], TraditionalForm]],ExpressionUUID->
  "f0383501-dbe0-2b41-8b58-db7181ce7f14"],
 ", we are in the \[OpenCurlyDoubleQuote]Coexistence: nonoscillatory\
\[CloseCurlyDoubleQuote] domain;\n \t- If ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["det", FontSlant -> "Plain"], ">", "0"}], TraditionalForm], 
     "errors" -> {}, "input" -> "\\mathrm{det}>0", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "be372e22-9dcd-ce44-af68-a12dd4b9deef"],
 ", ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["tr", FontSlant -> "Plain"], "<", "0"}], TraditionalForm], 
     "errors" -> {}, "input" -> "\\mathrm{tr}<0", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "f411dd11-8991-2444-a299-f103b39d96e5"],
 ", and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[CapitalDelta]", "<", "0"}], TraditionalForm]],ExpressionUUID->
  "41cfb2a2-42ba-0748-bdf9-7ec5dddc606c"],
 ", we are in the \[OpenCurlyDoubleQuote]Coexistence: damped oscillations\
\[CloseCurlyDoubleQuote] domain;\n \t- If ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["det", FontSlant -> "Plain"], ">", "0"}], TraditionalForm], 
     "errors" -> {}, "input" -> "\\mathrm{det}>0", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "ef83bcf8-4188-3544-83c4-6fd509aa4a42"],
 ", ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["tr", FontSlant -> "Plain"], "\[GreaterEqual]", "0"}], 
       TraditionalForm], "errors" -> {}, "input" -> "\\mathrm{tr}\\geq 0", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "15487e66-caf7-5146-a212-5d6213d968e2"],
 ", we are in the \[OpenCurlyDoubleQuote]Coexistence: limit cycles\
\[CloseCurlyDoubleQuote] domain.\nLet\[CloseCurlyQuote]s first define a \
function computing the equilibrium:"
}], "Text",
 CellChangeTimes->{{3.969697943294586*^9, 3.9696980720996227`*^9}, {
  3.9696982719419785`*^9, 3.969698525487068*^9}, {3.9696986089217052`*^9, 
  3.9696987083878403`*^9}, {3.9696994970206966`*^9, 
  3.9696995002073307`*^9}},ExpressionUUID->"69e4adc6-a449-3849-be02-\
25fec89bb1fb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pdist", "[", 
    RowBox[{"x_", ",", "X_", ",", "\[Sigma]_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", 
     SqrtBox[
      RowBox[{"2", "\[Pi]", " ", "\[Sigma]"}]]], 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"-", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"x", "-", "X"}], ")"}], "2"], 
       RowBox[{"2", "\[Sigma]"}]]}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"attack", "[", 
    RowBox[{"x_", ",", "a_", ",", "\[Alpha]_", ",", "\[Tau]_"}], "]"}], ":=", 
   RowBox[{"\[Alpha]", " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"-", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"x", "-", "a"}], ")"}], "2"], 
       RowBox[{"2", 
        SuperscriptBox["\[Tau]", "2"]}]]}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"handling", "[", 
    RowBox[{
    "x_", ",", "h_", ",", "\[Eta]min_", ",", "\[Eta]max_", ",", "\[Nu]_"}], 
    "]"}], ":=", 
   RowBox[{"\[Eta]max", "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"\[Eta]max", "-", "\[Eta]min"}], ")"}], 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"-", 
       FractionBox[
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"x", "-", "h"}], ")"}], "2"], 
        RowBox[{"2", 
         SuperscriptBox["\[Nu]", "2"]}]]}]]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Int1", "[", 
    RowBox[{
     RowBox[{"R_", "?", "NumericQ"}], ",", 
     RowBox[{"a_", "?", "NumericQ"}], ",", 
     RowBox[{"\[Alpha]_", "?", "NumericQ"}], ",", 
     RowBox[{"\[Tau]_", "?", "NumericQ"}], ",", 
     RowBox[{"h_", "?", "NumericQ"}], ",", 
     RowBox[{"\[Eta]min_", "?", "NumericQ"}], ",", 
     RowBox[{"\[Eta]max_", "?", "NumericQ"}], ",", 
     RowBox[{"\[Nu]_", "?", "NumericQ"}], ",", 
     RowBox[{"X_", "?", "NumericQ"}], ",", 
     RowBox[{"\[Sigma]_", "?", "NumericQ"}]}], "]"}], ":=", 
   RowBox[{"NIntegrate", "[", 
    RowBox[{
     RowBox[{
      FractionBox[
       RowBox[{"attack", "[", 
        RowBox[{"x", ",", "a", ",", "\[Alpha]", ",", "\[Tau]"}], "]"}], 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{"attack", "[", 
          RowBox[{"x", ",", "a", ",", "\[Alpha]", ",", "\[Tau]"}], "]"}], 
         RowBox[{"handling", "[", 
          RowBox[{
          "x", ",", "h", ",", "\[Eta]min", ",", "\[Eta]max", ",", "\[Nu]"}], 
          "]"}], "R"}]}]], 
      RowBox[{"pdist", "[", 
       RowBox[{"x", ",", "X", ",", "\[Sigma]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Int2", "[", 
    RowBox[{
     RowBox[{"R_", "?", "NumericQ"}], ",", 
     RowBox[{"a_", "?", "NumericQ"}], ",", 
     RowBox[{"\[Alpha]_", "?", "NumericQ"}], ",", 
     RowBox[{"\[Tau]_", "?", "NumericQ"}], ",", 
     RowBox[{"h_", "?", "NumericQ"}], ",", 
     RowBox[{"\[Eta]min_", "?", "NumericQ"}], ",", 
     RowBox[{"\[Eta]max_", "?", "NumericQ"}], ",", 
     RowBox[{"\[Nu]_", "?", "NumericQ"}], ",", 
     RowBox[{"X_", "?", "NumericQ"}], ",", 
     RowBox[{"\[Sigma]_", "?", "NumericQ"}]}], "]"}], ":=", 
   RowBox[{"NIntegrate", "[", 
    RowBox[{
     RowBox[{
      FractionBox[
       RowBox[{"attack", "[", 
        RowBox[{"x", ",", "a", ",", "\[Alpha]", ",", "\[Tau]"}], "]"}], 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{"attack", "[", 
          RowBox[{"x", ",", "a", ",", "\[Alpha]", ",", "\[Tau]"}], "]"}], 
         RowBox[{"handling", "[", 
          RowBox[{
          "x", ",", "h", ",", "\[Eta]min", ",", "\[Eta]max", ",", "\[Nu]"}], 
          "]"}], "R"}]}]], 
      RowBox[{"pdist", "[", 
       RowBox[{"x", ",", "X", ",", "\[Sigma]"}], "]"}], 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        FractionBox[
         RowBox[{
          RowBox[{"attack", "[", 
           RowBox[{"x", ",", "a", ",", "\[Alpha]", ",", "\[Tau]"}], "]"}], 
          RowBox[{"handling", "[", 
           RowBox[{
           "x", ",", "h", ",", "\[Eta]min", ",", "\[Eta]max", ",", "\[Nu]"}], 
           "]"}], "R"}], 
         RowBox[{"1", "+", 
          RowBox[{
           RowBox[{"attack", "[", 
            RowBox[{"x", ",", "a", ",", "\[Alpha]", ",", "\[Tau]"}], "]"}], 
           RowBox[{"handling", "[", 
            RowBox[{
            "x", ",", "h", ",", "\[Eta]min", ",", "\[Eta]max", ",", "\[Nu]"}],
             "]"}], "R"}]}]]}], ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FNum", "[", 
    RowBox[{
     RowBox[{"R_", "?", "NumericQ"}], ",", 
     RowBox[{"a_", "?", "NumericQ"}], ",", 
     RowBox[{"\[Alpha]_", "?", "NumericQ"}], ",", 
     RowBox[{"\[Tau]_", "?", "NumericQ"}], ",", 
     RowBox[{"h_", "?", "NumericQ"}], ",", 
     RowBox[{"\[Eta]min_", "?", "NumericQ"}], ",", 
     RowBox[{"\[Eta]max_", "?", "NumericQ"}], ",", 
     RowBox[{"\[Nu]_", "?", "NumericQ"}], ",", 
     RowBox[{"X_", "?", "NumericQ"}], ",", 
     RowBox[{"\[Sigma]_", "?", "NumericQ"}], ",", 
     RowBox[{"\[Beta]_", "?", "NumericQ"}], ",", 
     RowBox[{"\[Epsilon]_", "?", "NumericQ"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"R", " ", 
     RowBox[{"Int1", "[", 
      RowBox[{
      "R", ",", "a", ",", "\[Alpha]", ",", "\[Tau]", ",", "h", ",", 
       "\[Eta]min", ",", "\[Eta]max", ",", "\[Nu]", ",", "X", ",", 
       "\[Sigma]"}], "]"}]}], "-", 
    FractionBox["\[Beta]", "\[Epsilon]"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"X", "=", "3"}], ";"}], 
  RowBox[{"(*", "arbitrary", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"paramsGen", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"r", "->", "0.3"}], ",", 
     RowBox[{"\[Alpha]", "->", "2"}], ",", 
     RowBox[{"\[Eta]max", "->", "2"}], ",", 
     RowBox[{"\[Eta]min", "->", "1"}], ",", 
     RowBox[{"\[Epsilon]", "->", "0.5"}], ",", 
     RowBox[{"\[Tau]", "->", "1"}], ",", 
     RowBox[{"\[Nu]", "->", "1"}], ",", 
     RowBox[{"k", "->", "1"}], ",", 
     RowBox[{"\[Beta]", "->", "0.1"}], ",", 
     RowBox[{"X", "->", "X"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EqSol", "[", 
   RowBox[{
    RowBox[{"dval_", "?", "NumericQ"}], ",", 
    RowBox[{"\[Sigma]val_", "?", "NumericQ"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"paramsSpec", ",", "FNumVal", ",", "Rsol", ",", "csol"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"paramsSpec", "=", 
      RowBox[{"Join", "[", 
       RowBox[{"paramsGen", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"a", "->", 
           RowBox[{"X", "-", "dval"}]}], ",", 
          RowBox[{"h", "->", 
           RowBox[{"X", "-", "dval"}]}], ",", 
          RowBox[{"\[Sigma]", "->", "\[Sigma]val"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FNumVal", "[", 
       RowBox[{"R_", "?", "NumericQ"}], "]"}], ":=", 
      RowBox[{
       RowBox[{"FNum", "[", 
        RowBox[{
        "R", ",", "a", ",", "\[Alpha]", ",", "\[Tau]", ",", "h", ",", 
         "\[Eta]min", ",", "\[Eta]max", ",", "\[Nu]", ",", "X", ",", 
         "\[Sigma]", ",", "\[Beta]", ",", "\[Epsilon]"}], "]"}], "/.", 
       "paramsSpec"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Rsol", "=", 
      RowBox[{"FindRoot", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"FNumVal", "[", "R", "]"}], "==", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"R", ",", "0.5"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"csol", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"c", "->", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            FractionBox[
             RowBox[{"r", " ", "R", 
              RowBox[{"(", 
               RowBox[{"1", "-", 
                FractionBox["R", "k"]}], ")"}]}], 
             RowBox[{"R", " ", 
              RowBox[{"Int1", "[", 
               RowBox[{
               "R", ",", "a", ",", "\[Alpha]", ",", "\[Tau]", ",", "h", ",", 
                "\[Eta]min", ",", "\[Eta]max", ",", "\[Nu]", ",", "X", ",", 
                "\[Sigma]"}], "]"}]}]], ")"}], "/.", "paramsSpec"}], ")"}]}], 
        "/.", "Rsol"}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"R", ",", "c"}], "}"}], "/.", 
      RowBox[{"Join", "[", 
       RowBox[{"Rsol", ",", "csol"}], "]"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.9696987350269985`*^9, 3.969699465240507*^9}, {
   3.969699520489191*^9, 3.969699675414263*^9}, 3.969699758529169*^9, {
   3.969699793544367*^9, 3.9696997945304966`*^9}, 3.969699832359812*^9, {
   3.96969988363974*^9, 3.9696999227681656`*^9}, {3.969700131523674*^9, 
   3.9697001377613983`*^9}, {3.969700219346857*^9, 3.9697002290199356`*^9}, {
   3.9697003320375957`*^9, 3.9697003353562813`*^9}, {3.9697003781092186`*^9, 
   3.969700384346386*^9}, {3.96970042117766*^9, 3.969700429548933*^9}, {
   3.9697004665365753`*^9, 3.969700497356209*^9}, {3.969700547643175*^9, 
   3.9697005520193214`*^9}, {3.9697007488057613`*^9, 
   3.9697007821679516`*^9}, {3.96970095351462*^9, 3.969701089026018*^9}, {
   3.9697012239693775`*^9, 3.9697012275892296`*^9}, {3.9697013073746147`*^9, 
   3.969701449055443*^9}, {3.9697015696213055`*^9, 3.9697016005621376`*^9}},
 CellLabel->"In[25]:=",ExpressionUUID->"c1f29499-ae35-b849-a535-0157ca144b73"],

Cell["Let\[CloseCurlyQuote]s check with the parameters we already looked \
at:", "Text",
 CellChangeTimes->{{3.9696999462377796`*^9, 
  3.9696999615659084`*^9}},ExpressionUUID->"ba6f3f90-c588-c642-b90f-\
5e620e2f5763"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"testSol", "=", 
  RowBox[{"EqSol", "[", 
   RowBox[{"0.5", ",", 
    SqrtBox["3"]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.969699964951994*^9, 3.969700012208679*^9}, {
  3.969700064134447*^9, 3.9697001165101433`*^9}, {3.969701891233307*^9, 
  3.9697018929858723`*^9}},
 CellLabel->"In[35]:=",ExpressionUUID->"e312d441-66b7-9d4d-9ed8-216b0282b114"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.24900758125846617`", ",", "0.2805042086014117`"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.969701604656479*^9, 3.9697019342938423`*^9, 
  3.9699337807064114`*^9},
 CellLabel->"Out[35]=",ExpressionUUID->"c96b64e7-110a-0a47-a4cb-2615e12475c2"]
}, Open  ]],

Cell["\<\
Perfect! Now let\[CloseCurlyQuote]s write a function that computes the det \
and tr from the equilibrium:\
\>", "Text",
 CellChangeTimes->{{3.9697016105207787`*^9, 
  3.969701649087618*^9}},ExpressionUUID->"e9e19e25-3757-ba48-bfb4-\
c43ac0af6581"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DetTr", "[", 
   RowBox[{
    RowBox[{"dval_", "?", "NumericQ"}], ",", 
    RowBox[{"\[Sigma]val_", "?", "NumericQ"}], ",", "sol_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"Rsol", ",", "csol", ",", "paramsSpec", ",", "JacobiAtEq"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Rsol", "=", 
      RowBox[{"sol", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"csol", "=", 
      RowBox[{"sol", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"paramsSpec", "=", 
      RowBox[{"Join", "[", 
       RowBox[{"paramsGen", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"a", "->", 
           RowBox[{"X", "-", "dval"}]}], ",", 
          RowBox[{"h", "->", 
           RowBox[{"X", "-", "dval"}]}], ",", 
          RowBox[{"\[Sigma]", "->", "\[Sigma]val"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"JacobiAtEq", "=", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"r", 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               FractionBox[
                RowBox[{"2", "R"}], "k"]}], ")"}]}], "-", 
            RowBox[{"c", " ", 
             RowBox[{"Int2", "[", 
              RowBox[{
              "R", ",", "a", ",", "\[Alpha]", ",", "\[Tau]", ",", "h", ",", 
               "\[Eta]min", ",", "\[Eta]max", ",", "\[Nu]", ",", "X", ",", 
               "\[Sigma]"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"-", "R"}], " ", 
            RowBox[{"Int1", "[", 
             RowBox[{
             "R", ",", "a", ",", "\[Alpha]", ",", "\[Tau]", ",", "h", ",", 
              "\[Eta]min", ",", "\[Eta]max", ",", "\[Nu]", ",", "X", ",", 
              "\[Sigma]"}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\[Epsilon]", " ", "c", " ", 
            RowBox[{"Int2", "[", 
             RowBox[{
             "R", ",", "a", ",", "\[Alpha]", ",", "\[Tau]", ",", "h", ",", 
              "\[Eta]min", ",", "\[Eta]max", ",", "\[Nu]", ",", "X", ",", 
              "\[Sigma]"}], "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"\[Epsilon]", " ", "R", " ", 
             RowBox[{"Int1", "[", 
              RowBox[{
              "R", ",", "a", ",", "\[Alpha]", ",", "\[Tau]", ",", "h", ",", 
               "\[Eta]min", ",", "\[Eta]max", ",", "\[Nu]", ",", "X", ",", 
               "\[Sigma]"}], "]"}]}], "-", "\[Beta]"}]}], "}"}]}], 
        "\[IndentingNewLine]", "}"}], "/.", 
       RowBox[{"Join", "[", 
        RowBox[{"paramsSpec", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"R", "->", "Rsol"}], ",", 
           RowBox[{"c", "->", "csol"}]}], "}"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Det", "[", "JacobiAtEq", "]"}], ",", 
       RowBox[{"Tr", "[", "JacobiAtEq", "]"}]}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.9697016683501453`*^9, 3.969701859142267*^9}, {
  3.9697019550249443`*^9, 3.969701955455572*^9}, {3.969701986850874*^9, 
  3.969701996073925*^9}, {3.9697020963163624`*^9, 3.969702135718649*^9}},
 CellLabel->"In[36]:=",ExpressionUUID->"053ff32c-9391-8843-ad0f-02d40e2a8bb0"],

Cell["Let\[CloseCurlyQuote]s check as before:", "Text",
 CellChangeTimes->{{3.9697018684325695`*^9, 
  3.9697018770561256`*^9}},ExpressionUUID->"7e1389ea-68a4-d04f-aece-\
f9651594553f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"testMat", "=", 
  RowBox[{"DetTr", "[", 
   RowBox[{"0.5", ",", 
    SqrtBox["3"], ",", "testSol"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.969701881225321*^9, 3.9697019209252853`*^9}, {
   3.9697020274621277`*^9, 3.9697020393553963`*^9}, 3.969702091481735*^9},
 CellLabel->"In[37]:=",ExpressionUUID->"f024415c-2eb0-e141-80f9-b11580070afa"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.015735766287973622`", ",", 
   RowBox[{"-", "0.006762211634815871`"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.969701921620064*^9, 3.9697019593560314`*^9}, 
   3.96970200197509*^9, 3.9697020396694107`*^9, 3.9697021405273895`*^9, 
   3.969933786710724*^9},
 CellLabel->"Out[37]=",ExpressionUUID->"71a32c2e-da4b-6c4c-af71-2eda4cbfaf25"]
}, Open  ]],

Cell["\<\
Perfect! Let\[CloseCurlyQuote]s move on to the automatic classification \
function. It will return:
 - 0 if noncoexistence
 - 1 if coexistence: nonoscillatory
 - 2 if coexistence: damped oscillations
 - 3 if coexistence: limit cycles\
\>", "Text",
 CellChangeTimes->{{3.969702051565647*^9, 3.969702072232708*^9}, {
  3.969702187226055*^9, 
  3.9697022363837833`*^9}},ExpressionUUID->"4af98b0e-9dbf-3f46-89cd-\
b9cfc5c950d7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Classifying", "[", 
   RowBox[{
    RowBox[{"dval_", "?", "NumericQ"}], ",", 
    RowBox[{"\[Sigma]val_", "?", "NumericQ"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"sol", ",", "coeffs"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"sol", "=", 
      RowBox[{"EqSol", "[", 
       RowBox[{"dval", ",", "\[Sigma]val"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"sol", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ">", "0"}], "&&", 
        RowBox[{
         RowBox[{"sol", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ">", "0"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"True", ":", " ", "coexistence"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"coeffs", "=", 
         RowBox[{"DetTr", "[", 
          RowBox[{"dval", ",", "\[Sigma]val", ",", "sol"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"coeffs", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ">", "0"}], "&&", 
           RowBox[{
            RowBox[{"coeffs", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "<", "0"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"True", ":", " ", 
            RowBox[{"no", " ", "limit", " ", "cycles"}]}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              SuperscriptBox[
               RowBox[{"coeffs", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "2"], "-", 
              RowBox[{"4", 
               RowBox[{"coeffs", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}]}], ">=", "0"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"True", ":", " ", "nonoscillatory"}], "*)"}], 
            "\[IndentingNewLine]", "1", ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"False", ":", " ", 
              RowBox[{"damped", " ", "oscillations"}]}], "*)"}], 
            "\[IndentingNewLine]", "2"}], "\[IndentingNewLine]", "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"False", ":", " ", 
            RowBox[{"limit", " ", "cycles"}]}], "*)"}], "\[IndentingNewLine]",
           "3"}], "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"False", ":", " ", 
         RowBox[{"no", " ", "coexistence"}]}], "*)"}], "\[IndentingNewLine]", 
       "0"}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.9697021565388756`*^9, 3.9697021807210045`*^9}, {
   3.9697022453506165`*^9, 3.9697022761849766`*^9}, {3.9697023318442745`*^9, 
   3.969702343314457*^9}, {3.969702450625513*^9, 3.969702489007353*^9}, {
   3.969702557565567*^9, 3.969702612858656*^9}, {3.969702652158684*^9, 
   3.9697026881535587`*^9}, 3.969702729004265*^9, {3.9697028083364887`*^9, 
   3.9697029017277412`*^9}, {3.969702936674801*^9, 3.9697030420120735`*^9}, {
   3.969703195669647*^9, 3.969703207801134*^9}},
 CellLabel->"In[38]:=",ExpressionUUID->"bc688d43-4555-1e49-b1b0-bf0db778f2ec"],

Cell["Last check, it should return 2:", "Text",
 CellChangeTimes->{{3.969703269284607*^9, 
  3.9697032752223797`*^9}},ExpressionUUID->"01efc728-db44-5743-99ef-\
816ca48a79d9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Classifying", "[", 
  RowBox[{"0.5", ",", 
   SqrtBox["3"]}], "]"}]], "Input",
 CellChangeTimes->{{3.9697032769542236`*^9, 3.9697032836672554`*^9}},
 CellLabel->"In[39]:=",ExpressionUUID->"b08cde4d-44db-8643-bacb-d98f720315a0"],

Cell[BoxData["2"], "Output",
 CellChangeTimes->{3.9697032893146114`*^9, 3.96993379817099*^9},
 CellLabel->"Out[39]=",ExpressionUUID->"361a9128-df19-404d-8b42-e43a86d44d0b"]
}, Open  ]],

Cell["Amazing! Let\[CloseCurlyQuote]s move on.", "Text",
 CellChangeTimes->{{3.9697032942954216`*^9, 
  3.969703300755354*^9}},ExpressionUUID->"b95b5daa-493f-d94b-8a0a-\
33e94658bd58"]
}, Closed]],

Cell[CellGroupData[{

Cell["Iteration to create the plot", "Subsection",
 CellChangeTimes->{{3.969703319721813*^9, 
  3.9697033242454205`*^9}},ExpressionUUID->"19f36801-e264-bf41-89be-\
84fa9dd2b942"],

Cell[TextData[{
 "We can now create a grid of ",
 Cell[BoxData[
  FormBox["d", TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "5815977c-48ba-ec49-b429-70a3bf52ad8c"],
 " and ",
 Cell[BoxData[
  FormBox["\[Sigma]", TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "aee73437-fb41-b64a-a66e-2d894d7325b5"],
 ", iterate the classification and create the plot."
}], "Text",
 CellChangeTimes->{{3.9697033293817043`*^9, 
  3.9697033616397705`*^9}},ExpressionUUID->"a071c051-7ad5-ca44-9d46-\
8dfd31ae92b0"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"dvals", "=", 
   RowBox[{"Range", "[", 
    RowBox[{"0.01", ",", "2.5", ",", "0.02"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]vals", "=", 
   RowBox[{"Range", "[", 
    RowBox[{"0.01", ",", "6", ",", "0.05"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Length", "[", "dvals", "]"}], 
  RowBox[{
  "Length", "[", "\[Sigma]vals", "]"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.9697033745641766`*^9, 3.969703396106827*^9}, {
  3.9697034413948536`*^9, 3.969703689687271*^9}, {3.9697039087205887`*^9, 
  3.969703966839525*^9}, {3.969704036061716*^9, 3.9697040632352905`*^9}, {
  3.969704192068348*^9, 3.969704200133747*^9}, {3.969705260017275*^9, 
  3.9697052681883373`*^9}},
 CellLabel->"In[40]:=",ExpressionUUID->"8fc8c1c1-4ebf-1c4b-a03d-6c8388c28b30"],

Cell[BoxData["15000"], "Output",
 CellChangeTimes->{
  3.9697038820042686`*^9, 3.9697039156944695`*^9, {3.969703947686491*^9, 
   3.9697039682513676`*^9}, {3.9697040417496185`*^9, 3.969704064352009*^9}, 
   3.969704201103552*^9, 3.9697052688566666`*^9, 3.969933801175955*^9},
 CellLabel->"Out[42]=",ExpressionUUID->"29dcc054-9240-ce42-b6ea-925fa498d63a"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{"ParallelTable", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Classifying", "[", 
      RowBox[{"d", ",", "\[Sigma]"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"d", ",", "dvals"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\[Sigma]", ",", "\[Sigma]vals"}], "}"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9697039526739597`*^9, 3.969703954131695*^9}, {
  3.969704408632988*^9, 3.969704424509121*^9}, {3.969704570573183*^9, 
  3.9697047340432415`*^9}, {3.969705165340227*^9, 3.969705170678684*^9}},
 CellLabel->"In[43]:=",ExpressionUUID->"68437034-3588-4f41-bfb1-bf44946fc77e"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"leg", "=", 
   RowBox[{"SwatchLegend", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Black", ",", "White", ",", "LightGray", ",", "Gray"}], "}"}], ",",
      "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\"\<Noncoexistence\>\"", 
       ",", "\"\<Coexistence: nonoscillatory\>\"", 
       ",", "\"\<Coexistence: damped oscillations\>\"", 
       ",", "\"\<Coexistence: limit cycles\>\""}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"LegendMarkers", "->", "\"\<Rectangle\>\""}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Legended", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ArrayPlot", "[", 
    RowBox[{"data", ",", "\[IndentingNewLine]", 
     RowBox[{"DataReversed", "->", "True"}], ",", "\[IndentingNewLine]", 
     RowBox[{"ColorRules", "->", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"0", "->", "Black"}], ",", "\[IndentingNewLine]", 
        RowBox[{"1", "->", "White"}], ",", "\[IndentingNewLine]", 
        RowBox[{"2", "->", "LightGray"}], ",", "\[IndentingNewLine]", 
        RowBox[{"3", "->", "Gray"}]}], "\[IndentingNewLine]", "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Frame", "->", "True"}], ",", "\[IndentingNewLine]", 
     RowBox[{"FrameTicks", "->", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Round", "[", 
             RowBox[{
              RowBox[{"dvals", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", "0.01"}], "]"}]}], "}"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "dvals", "]"}], ",", "25"}], "}"}]}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Round", "[", 
             RowBox[{
              RowBox[{"\[Sigma]vals", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", "0.01"}], "]"}]}], "}"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "\[Sigma]vals", "]"}], ",", "25"}], 
           "}"}]}], "]"}]}], "\[IndentingNewLine]", "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"FrameLabel", "->", 
      RowBox[{"{", 
       RowBox[{"\"\<Phenomtypic mismatch (\!\(\*SuperscriptBox[\(d\), \
\(2\)]\))\>\"", 
        ",", "\"\<Individual variation (\!\(\*SuperscriptBox[\(\[Sigma]\), \
\(2\)]\))\>\""}], "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"Mesh", "->", "False"}], ",", "\[IndentingNewLine]", 
     RowBox[{"AspectRatio", "->", 
      RowBox[{"1", "/", "1.5"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
   "\[IndentingNewLine]", "leg"}], "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.969704796299547*^9, 3.969704797743044*^9}, {
   3.9697048344994774`*^9, 3.9697048368661213`*^9}, {3.9697049602067947`*^9, 
   3.9697050147812386`*^9}, {3.9697053897899075`*^9, 3.9697054441345787`*^9}, 
   3.9697055198245945`*^9, {3.9697057145618095`*^9, 3.9697057900841007`*^9}, {
   3.9697058370238056`*^9, 3.969705843593668*^9}, {3.9699536287795353`*^9, 
   3.969953654611189*^9}, {3.9699537127122173`*^9, 3.969953712871395*^9}, {
   3.969953743913004*^9, 
   3.969953745198042*^9}},ExpressionUUID->"46e53977-73f4-d14b-8290-\
5fa9329a8831"],

Cell[BoxData[
 TemplateBox[{
   GraphicsBox[
    RasterBox[SparseArray[Automatic, {125, 120}, 0., {1, {CompressedData["
1:eJx9zStIxXAYhvHX65n3eTv+ve94nXo8zhssyeLiMC3JsLikS4eDQcQgRqPR
aDAYDEbBYlOwCBajaFlc9AG7H/zKxwtPZf9o97BJ0on+roEcKc9PxM3SK8IW
6RF+q3QHt026hmmXLmGVpFMUyCzpC0mH9I6oU3pG0CU9wOuWbuD0SFewe6UL
qI8+cqQ2fcT99BEO0Ic/SB/uEH2YYfqwyvRRIBuhj8TQRzRKH8EYfXjj9OFM
0Ic9SR+aoo8c6TR9xA59hBX68Gfow52lDzNHH9Y8fRTIFugjWaSPyKWPYIk+
vGX6cFbow67Sh1alOn6wV5NesLMm3cJ40hm+Ea1L9yhvsMcbapvSOT5Q3ZKO
8YTSNl0c/OMXVVFMJw==
        "], CompressedData["
1:eJztzVc/gmEAhvGnrAgpexcls6ysEBpGRbJX8hplZuvj8xHwe5/nPbmO7qP7
+ru0QlozCyFyASFMP2syl5SWlVdYKqus1TW1tjq7o76hsam5pbWtvaOzq9vp
6ul1e/q8/QODQ8MjPv/o2PjEZGBqemZ2Lji/sBhaWl4JR6Kx1bX1jXgiubmV
2k7v7O7tHxweHZ+cnmXOsxfa5dX1TS5/e3f/8PhUeH55fXv/+Pwq4uLi4uLi
4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uL+1TVGNQQ1
gFQOKubUaiotdZIqR42iwpAvyO5LjUtMy+pKieoe1LemW0iPxr/fvzx8A89z
+/I=
        "]}, CompressedData["
1:eJzt07FNg0EMhuHLKMyAqNmBESIhSlZOT8MISFGqiOJXBPrO9nPN055sv0/n
z7f301rr42Xd3uV1is/X90W2MN2Tfkn96pYTTXelX1K/+uVE013pl9SvfjnR
dFf6JfWrX0403ZV+Sf3qlxNNd6VbUr/65UTTfemX1K9+OdF0X/ol9atbTjTd
mX5J/eqXE013pltSv/rlRNO96ZfUb3qOpH71S07qNz0/Ur/6JSf1m54buYPp
DvVLzuk3PS9yJ9M96pfs3296TuSOprvUL9m33/R8yJ1N96lbUr/kRNOd6pas
3296DmRFdUvWVbdkXXVL1lW3ZF11S9ZVr2RddUvWVa9kXfVK1lWnJEmSJEmS
JEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSfMR1
fd/xf5A83uu96X+RPN6rfsn9PNqrfsm8j/aqY7J+r3om63eqZ7JPp3om+/Wq
Z04w3dEupvdA6lTXrG363rub3i9rm75f/m76LriH6Tvk/5i+K/6N6Tvinqbv
crrp/bOn6buuYnpPZOfO0/MhSZIkSZIkSZIkSZIkSZIkSZIkSZIkyS7+APrj
Sm0=
       "]}], {{0, 0}, {120, 125}}, {0, 1}], AspectRatio -> 0.6666666666666666,
     Frame -> True, FrameLabel -> {
      FormBox[
      "\"Individual variation (\\!\\(\\*SuperscriptBox[\\(\[Sigma]\\), \
\\(2\\)]\\))\"", TraditionalForm], 
      FormBox[
      "\"Phenomtypic mismatch (\\!\\(\\*SuperscriptBox[\\(d\\), \
\\(2\\)]\\))\"", TraditionalForm]}, FrameTicks -> {{{{0.5, 
         FormBox["0.01`", TraditionalForm]}, {25.5, 
         FormBox["0.51`", TraditionalForm]}, {50.5, 
         FormBox["1.01`", TraditionalForm]}, {75.5, 
         FormBox["1.51`", TraditionalForm]}, {100.5, 
         FormBox["2.0100000000000002`", TraditionalForm]}}, None}, {{{0.5, 
         FormBox["0.01`", TraditionalForm]}, {25.5, 
         FormBox["1.26`", TraditionalForm]}, {50.5, 
         FormBox["2.5100000000000002`", TraditionalForm]}, {75.5, 
         FormBox["3.7600000000000002`", TraditionalForm]}, {100.5, 
         FormBox["5.01`", TraditionalForm]}}, None}}, GridLinesStyle -> 
    Directive[
      GrayLevel[0.5, 0.4]], 
    Method -> {
     "GridLinesInFront" -> True, "DefaultBoundaryStyle" -> Automatic, 
      "DefaultGraphicsInteraction" -> {
       "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
        "Effects" -> {
         "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
          "Droplines" -> {
           "freeformCursorMode" -> True, 
            "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
      "DefaultPlotStyle" -> Automatic}], 
   FormBox[
    FormBox[
     TemplateBox[{
      "\"Noncoexistence\"", "\"Coexistence: nonoscillatory\"", 
       "\"Coexistence: damped oscillations\"", 
       "\"Coexistence: limit cycles\""}, "SwatchLegend", 
      DisplayFunction -> (FormBox[
        StyleBox[
         StyleBox[
          PaneBox[
           TagBox[
            GridBox[{{
               TagBox[
                GridBox[{{
                   GraphicsBox[{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    AbsoluteThickness[1.6], 
                    GrayLevel[0]], 
                    RectangleBox[{0, 0}, {10, 10}, "RoundingRadius" -> 0]}, 
                    AspectRatio -> Full, ImageSize -> {10, 10}, 
                    PlotRangePadding -> None, ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #}, {
                   GraphicsBox[{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    AbsoluteThickness[1.6], 
                    GrayLevel[1]], 
                    RectangleBox[{0, 0}, {10, 10}, "RoundingRadius" -> 0]}, 
                    AspectRatio -> Full, ImageSize -> {10, 10}, 
                    PlotRangePadding -> None, ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #2}, {
                   GraphicsBox[{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    AbsoluteThickness[1.6], 
                    GrayLevel[0.85]], 
                    RectangleBox[{0, 0}, {10, 10}, "RoundingRadius" -> 0]}, 
                    AspectRatio -> Full, ImageSize -> {10, 10}, 
                    PlotRangePadding -> None, ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #3}, {
                   GraphicsBox[{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    AbsoluteThickness[1.6], 
                    GrayLevel[0.5]], 
                    RectangleBox[{0, 0}, {10, 10}, "RoundingRadius" -> 0]}, 
                    AspectRatio -> Full, ImageSize -> {10, 10}, 
                    PlotRangePadding -> None, ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #4}}, 
                 GridBoxAlignment -> {
                  "Columns" -> {Center, Left}, "Rows" -> {{Baseline}}}, 
                 AutoDelete -> False, 
                 GridBoxDividers -> {
                  "Columns" -> {{False}}, "Rows" -> {{False}}}, 
                 GridBoxItemSize -> {"Columns" -> {{All}}, "Rows" -> {{All}}},
                  GridBoxSpacings -> {
                  "Columns" -> {{0.3}}, "Rows" -> {{0.5}}}], "Grid"]}}, 
             GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
             AutoDelete -> False, 
             GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{1}}, "Rows" -> {{0}}}], 
            "Grid"], Alignment -> Left, AppearanceElements -> None, 
           ImageMargins -> {{5, 5}, {5, 5}}, ImageSizeAction -> 
           "ResizeToFit"], LineIndent -> 0, StripOnInput -> False], {
         FontFamily -> "Arial"}, Background -> Automatic, StripOnInput -> 
         False], TraditionalForm]& ), Editable -> True, 
      InterpretationFunction :> (RowBox[{"SwatchLegend", "[", 
         RowBox[{
           RowBox[{"{", 
             RowBox[{
               
               TemplateBox[<|"color" -> GrayLevel[0]|>, 
                "GrayLevelColorSwatchTemplate"], ",", 
               
               TemplateBox[<|"color" -> GrayLevel[1]|>, 
                "GrayLevelColorSwatchTemplate"], ",", 
               
               TemplateBox[<|"color" -> GrayLevel[0.85]|>, 
                "GrayLevelColorSwatchTemplate"], ",", 
               
               TemplateBox[<|"color" -> GrayLevel[0.5]|>, 
                "GrayLevelColorSwatchTemplate"]}], "}"}], ",", 
           RowBox[{"{", 
             RowBox[{#, ",", #2, ",", #3, ",", #4}], "}"}], ",", 
           RowBox[{"LegendMarkers", "\[Rule]", "\"Rectangle\""}]}], "]"}]& )],
      TraditionalForm], TraditionalForm]},
  "Legended",
  DisplayFunction->(GridBox[{{
      TagBox[
       ItemBox[
        PaneBox[
         TagBox[#, "SkipImageSizeLevel"], Alignment -> {Center, Baseline}, 
         BaselinePosition -> Baseline], DefaultBaseStyle -> "Labeled"], 
       "SkipImageSizeLevel"], 
      ItemBox[#2, DefaultBaseStyle -> "LabeledLabel"]}}, 
    GridBoxAlignment -> {"Columns" -> {{Center}}, "Rows" -> {{Center}}}, 
    AutoDelete -> False, GridBoxItemSize -> Automatic, 
    BaselinePosition -> {1, 1}]& ),
  Editable->True,
  InterpretationFunction->(RowBox[{"Legended", "[", 
     RowBox[{#, ",", 
       RowBox[{"Placed", "[", 
         RowBox[{#2, ",", "After"}], "]"}]}], "]"}]& )]], "Output",
 CellChangeTimes->{3.96970523197567*^9, 3.969705585209564*^9, 
  3.9697057924647846`*^9, 3.96970584468025*^9, 3.969934155733841*^9},
 CellLabel->"Out[45]=",ExpressionUUID->"80028722-9d9f-514d-bf18-50a9fed35d08"]
}, Open  ]],

Cell[TextData[{
 "This plot took 5\[CloseCurlyQuote]45 to compute.\nThis is a bit different \
from the original figure: the \[OpenCurlyDoubleQuote]Coexistence: damped \
oscillations\[CloseCurlyDoubleQuote] domain looks a lot greater, which is due \
to the fact that the \[OpenCurlyDoubleQuote]manual\[CloseCurlyDoubleQuote] \
criterium for this on the original figure was wrong.\nIndeed, the last \
example on the original figure, which is supposed to be nonoscillatory, has \
one (greatly damped) oscillation. Here, the right formalism is taken, which \
is stricter.\nA similar effect can be observed for the \
\[OpenCurlyDoubleQuote]Noncoexistence\[CloseCurlyDoubleQuote] domain, which \
looks smaller here. However, we can suppose that the \
\[OpenCurlyDoubleQuote]manual\[CloseCurlyDoubleQuote] criterium to \
distinguish between \[OpenCurlyDoubleQuote]Coexistence: nonoscillatory\
\[CloseCurlyDoubleQuote] and \[OpenCurlyDoubleQuote]Noncoexistence\
\[CloseCurlyDoubleQuote] fails when there is an equilibrium with ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["R", "*"], "\[NotEqual]", "0"}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "ed328000-998a-eb4e-928c-16cd9aa33c56"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["C", "*"], "\[NotEqual]", "0"}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "720b1a1e-af84-c243-81a8-f699c4e1261c"],
 ", but with very slow convergence, which would happen very late."
}], "Text",
 CellChangeTimes->{{3.9699313286028614`*^9, 3.9699313365952377`*^9}, {
  3.969934161440565*^9, 3.9699341778896217`*^9}, {3.9700358264468555`*^9, 
  3.9700361282030983`*^9}},ExpressionUUID->"e87341cc-5d22-3f44-9103-\
3ecc22405505"]
}, Closed]],

Cell[CellGroupData[{

Cell["Optimization of the previous sections", "Subsection",
 CellChangeTimes->{{3.9699313806485367`*^9, 
  3.9699313904358807`*^9}},ExpressionUUID->"e303f804-08cc-224c-bd73-\
ec5ea66c5744"],

Cell[TextData[{
 "Let\[CloseCurlyQuote]s change a few things to obtain this plot quicker and \
get a better resolution without hours of computation.\n\
What\[CloseCurlyQuote]s new?\n - NIntegrate options:\n \t- Method: \
\[OpenCurlyDoubleQuote]GlobalAdaptive\[CloseCurlyDoubleQuote]\n \t- \
MaxRecursion: 20 (10 was not enough)\n \t- AccuracyGoal: 6 (4 was not enough)\
\n \t- PrecisionGoal: 6\n - FindRoot options. This is important because if \
the solution is wrong, then the stability is also wrong:\n \t- Method: \
\[OpenCurlyDoubleQuote]Secant\[CloseCurlyDoubleQuote] (default is \
\[OpenCurlyDoubleQuote]Newton\[CloseCurlyDoubleQuote], slower)\n \t- \
WorkingPrecision: 20\n \t- AccuracyGoal: 8\n \t- PrecisionGoal: 8\n \t- \
MaxIteration: 100\n - Integrals functions are memoized, this means for each \
set of parameters, the value is stored, so that it\[CloseCurlyQuote]s not \
computed twice. This is especially important for `Int1` which is called in \
the root finding algorithm, so possibly lots of times. The formalism is \
`f[x_?NumericQ,y_?NumericQ,z_?NumericQ]:=f[x,y,z]=...\.08`.\n - The \
integration limits are set to ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         OverscriptBox[
          StyleBox["x", "TI"], "_"], "\[PlusMinus]", "5", "\[Sigma]"}], 
       TraditionalForm], "errors" -> {}, "input" -> "\\bar{x}\\pm 5\\sigma", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "6f27877d-36df-2447-bbd3-c6213b968447"],
 ", since ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["p", "TI"], "(", 
         StyleBox["x", "TI"], ")"}], TraditionalForm], "errors" -> {}, 
     "input" -> "p(x)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "a1df528c-2fc8-ce48-aa90-3002f6cc48a1"],
 " is a normal law of standard deviation ",
 Cell[BoxData[
  FormBox["\[Sigma]", TraditionalForm]],ExpressionUUID->
  "f68f28ad-40d1-f848-af58-edabd4ef9e54"],
 ". However, this caused huge instability very close to ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Sigma]", "=", "0"}], TraditionalForm]],ExpressionUUID->
  "826d0290-e522-3b45-a217-fcdf09375376"],
 ", so for ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Sigma]", "<", "1"}], TraditionalForm]],ExpressionUUID->
  "8336118b-05bc-2b4e-8213-031f31066f3b"],
 ", the integration limits are set to ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         OverscriptBox[
          StyleBox["x", "TI"], "_"], "\[PlusMinus]", "5"}], TraditionalForm], 
     "errors" -> {}, "input" -> "\\bar{x}\\pm 5", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "dee8f90f-2135-4142-afde-c5e615c74040"],
 "."
}], "Text",
 CellChangeTimes->{{3.9699313977584343`*^9, 3.9699314199453335`*^9}, {
  3.9699347456525383`*^9, 3.9699347628495407`*^9}, {3.969938061254324*^9, 
  3.969938062679741*^9}, {3.970035154501789*^9, 3.970035234687004*^9}, {
  3.9700353303903275`*^9, 3.9700353415768795`*^9}, {3.970035400518587*^9, 
  3.9700356101403027`*^9}, {3.9700356563774395`*^9, 3.9700358031846046`*^9}, {
  3.9714028281326084`*^9, 
  3.9714028771440067`*^9}},ExpressionUUID->"58bae07a-3ef2-de4d-aba6-\
a57e593a7c17"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"--", 
      RowBox[{"-", " ", "GLOBAL"}]}], " ", 
     RowBox[{"SETTINGS", " ", "--"}]}], "-"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SetOptions", "[", 
     RowBox[{"NIntegrate", ",", 
      RowBox[{"Method", "->", "\"\<GlobalAdaptive\>\""}], ",", 
      RowBox[{"MaxRecursion", "->", "20"}], ",", 
      RowBox[{"AccuracyGoal", "->", "6"}], ",", 
      RowBox[{"PrecisionGoal", "->", "6"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"--", 
       RowBox[{"-", " ", "FUNCTIONS"}]}], " ", 
      RowBox[{"DEFINITIONS", " ", "--"}]}], "-"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ClearAll", "[", 
     RowBox[{"pdist", ",", "attack", ",", "handling"}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"pdist", "[", 
      RowBox[{"x_", ",", "X_", ",", "\[Sigma]_"}], "]"}], ":=", 
     RowBox[{
      FractionBox["1", 
       SqrtBox[
        RowBox[{"2", "\[Pi]", " ", "\[Sigma]"}]]], 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"x", "-", "X"}], ")"}], "2"], 
         RowBox[{"2", "\[Sigma]"}]]}]]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"attack", "[", 
      RowBox[{"x_", ",", "a_", ",", "\[Alpha]_", ",", "\[Tau]_"}], "]"}], ":=", 
     RowBox[{"\[Alpha]", " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"x", "-", "a"}], ")"}], "2"], 
         RowBox[{"2", 
          SuperscriptBox["\[Tau]", "2"]}]]}]]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"handling", "[", 
      RowBox[{
      "x_", ",", "h_", ",", "\[Eta]min_", ",", "\[Eta]max_", ",", "\[Nu]_"}], 
      "]"}], ":=", 
     RowBox[{"\[Eta]max", "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"\[Eta]max", "-", "\[Eta]min"}], ")"}], 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"-", 
         FractionBox[
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"x", "-", "h"}], ")"}], "2"], 
          RowBox[{"2", 
           SuperscriptBox["\[Nu]", "2"]}]]}]]}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"--", 
       RowBox[{"-", " ", "MEMOIZED"}]}], " ", 
      RowBox[{"INTEGRALS", " ", "--"}]}], "-"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ClearAll", "[", 
     RowBox[{"Int1", ",", "Int2"}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Int1", "[", 
      RowBox[{
       RowBox[{"R_", "?", "NumericQ"}], ",", 
       RowBox[{"a_", "?", "NumericQ"}], ",", 
       RowBox[{"\[Alpha]_", "?", "NumericQ"}], ",", 
       RowBox[{"\[Tau]_", "?", "NumericQ"}], ",", 
       RowBox[{"h_", "?", "NumericQ"}], ",", 
       RowBox[{"\[Eta]min_", "?", "NumericQ"}], ",", 
       RowBox[{"\[Eta]max_", "?", "NumericQ"}], ",", 
       RowBox[{"\[Nu]_", "?", "NumericQ"}], ",", 
       RowBox[{"X_", "?", "NumericQ"}], ",", 
       RowBox[{"\[Sigma]_", "?", "NumericQ"}]}], "]"}], ":=", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Int1", "[", 
       RowBox[{
       "R", ",", "a", ",", "\[Alpha]", ",", "\[Tau]", ",", "h", ",", 
        "\[Eta]min", ",", "\[Eta]max", ",", "\[Nu]", ",", "X", ",", 
        "\[Sigma]"}], "]"}], "=", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"xmin", "=", 
           RowBox[{"X", "-", 
            RowBox[{"5", "\[Sigma]"}]}]}], ",", 
          RowBox[{"xmax", "=", 
           RowBox[{"X", "+", 
            RowBox[{"5", "\[Sigma]"}]}]}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"NIntegrate", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"attack", "[", 
             RowBox[{"x", ",", "a", ",", "\[Alpha]", ",", "\[Tau]"}], "]"}], "/", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{
               RowBox[{"attack", "[", 
                RowBox[{"x", ",", "a", ",", "\[Alpha]", ",", "\[Tau]"}], 
                "]"}], 
               RowBox[{"handling", "[", 
                RowBox[{
                "x", ",", "h", ",", "\[Eta]min", ",", "\[Eta]max", ",", 
                 "\[Nu]"}], "]"}], "R"}]}], ")"}]}], 
           RowBox[{"pdist", "[", 
            RowBox[{"x", ",", "X", ",", "\[Sigma]"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"\[Sigma]", "<", "1"}], ",", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{"adaptive", " ", "integration", " ", "limits"}], ",", 
              " ", 
              RowBox[{
              "because", " ", "when", " ", "\[Sigma]", " ", "is", " ", "too", 
               " ", "small"}], ",", " ", 
              RowBox[{
              "numerical", " ", "integration", " ", "is", " ", "wrong"}]}], 
             "*)"}], "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{"X", "-", "5"}], ",", 
              RowBox[{"X", "+", "5"}]}], "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"x", ",", "xmin", ",", "xmax"}], "}"}]}], 
           "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
       "\[IndentingNewLine]", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Int2", "[", 
      RowBox[{
       RowBox[{"R_", "?", "NumericQ"}], ",", 
       RowBox[{"a_", "?", "NumericQ"}], ",", 
       RowBox[{"\[Alpha]_", "?", "NumericQ"}], ",", 
       RowBox[{"\[Tau]_", "?", "NumericQ"}], ",", 
       RowBox[{"h_", "?", "NumericQ"}], ",", 
       RowBox[{"\[Eta]min_", "?", "NumericQ"}], ",", 
       RowBox[{"\[Eta]max_", "?", "NumericQ"}], ",", 
       RowBox[{"\[Nu]_", "?", "NumericQ"}], ",", 
       RowBox[{"X_", "?", "NumericQ"}], ",", 
       RowBox[{"\[Sigma]_", "?", "NumericQ"}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{"Int2", "[", 
       RowBox[{
       "R", ",", "a", ",", "\[Alpha]", ",", "\[Tau]", ",", "h", ",", 
        "\[Eta]min", ",", "\[Eta]max", ",", "\[Nu]", ",", "X", ",", 
        "\[Sigma]"}], "]"}], "=", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"xmin", "=", 
           RowBox[{"X", "-", 
            RowBox[{"5", "\[Sigma]"}]}]}], ",", 
          RowBox[{"xmax", "=", 
           RowBox[{"X", "+", 
            RowBox[{"5", "\[Sigma]"}]}]}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"NIntegrate", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"With", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"A", "=", 
               RowBox[{"attack", "[", 
                RowBox[{"x", ",", "a", ",", "\[Alpha]", ",", "\[Tau]"}], 
                "]"}]}], ",", 
              RowBox[{"H", "=", 
               RowBox[{"handling", "[", 
                RowBox[{
                "x", ",", "h", ",", "\[Eta]min", ",", "\[Eta]max", ",", 
                 "\[Nu]"}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"A", "/", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"A", " ", "H", " ", "R"}]}], ")"}]}], 
             RowBox[{"pdist", "[", 
              RowBox[{"x", ",", "X", ",", "\[Sigma]"}], "]"}], 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"A", " ", "H", " ", "R"}], ")"}], "/", 
                RowBox[{"(", 
                 RowBox[{"1", "+", 
                  RowBox[{"A", " ", "H", " ", "R"}]}], ")"}]}]}], ")"}]}]}], 
           "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"\[Sigma]", "<", "1"}], ",", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{"adaptive", " ", "integration", " ", "limits"}], ",", 
              " ", 
              RowBox[{
              "because", " ", "when", " ", "\[Sigma]", " ", "is", " ", "too", 
               " ", "small"}], ",", " ", 
              RowBox[{
              "numerical", " ", "integration", " ", "is", " ", "wrong"}]}], 
             "*)"}], "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{"X", "-", "5"}], ",", 
              RowBox[{"X", "+", "5"}]}], "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"x", ",", "xmin", ",", "xmax"}], "}"}]}], 
           "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
       "\[IndentingNewLine]", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"--", 
       RowBox[{"-", " ", "MODEL"}]}], " ", 
      RowBox[{"DEFINITION", " ", "--"}]}], "-"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ClearAll", "[", 
     RowBox[{"FNum", ",", "EqSol", ",", "DetTr", ",", "Classifying"}], "]"}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"FNum", "[", 
      RowBox[{
       RowBox[{"R_", "?", "NumericQ"}], ",", 
       RowBox[{"a_", "?", "NumericQ"}], ",", 
       RowBox[{"\[Alpha]_", "?", "NumericQ"}], ",", 
       RowBox[{"\[Tau]_", "?", "NumericQ"}], ",", 
       RowBox[{"h_", "?", "NumericQ"}], ",", 
       RowBox[{"\[Eta]min_", "?", "NumericQ"}], ",", 
       RowBox[{"\[Eta]max_", "?", "NumericQ"}], ",", 
       RowBox[{"\[Nu]_", "?", "NumericQ"}], ",", 
       RowBox[{"X_", "?", "NumericQ"}], ",", 
       RowBox[{"\[Sigma]_", "?", "NumericQ"}], ",", 
       RowBox[{"\[Beta]_", "?", "NumericQ"}], ",", 
       RowBox[{"\[Epsilon]_", "?", "NumericQ"}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{"R", " ", 
       RowBox[{"Int1", "[", 
        RowBox[{
        "R", ",", "a", ",", "\[Alpha]", ",", "\[Tau]", ",", "h", ",", 
         "\[Eta]min", ",", "\[Eta]max", ",", "\[Nu]", ",", "X", ",", 
         "\[Sigma]"}], "]"}]}], "-", 
      FractionBox["\[Beta]", "\[Epsilon]"]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"X", "=", "3"}], ";"}], 
   RowBox[{"(*", 
    RowBox[{"arbitrary", ",", " ", 
     RowBox[{"can", " ", "be", " ", "any", " ", "real", " ", "number"}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"paramsGen", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"r", "->", "0.3"}], ",", 
       RowBox[{"\[Alpha]", "->", "2"}], ",", 
       RowBox[{"\[Eta]max", "->", "2"}], ",", 
       RowBox[{"\[Eta]min", "->", "1"}], ",", 
       RowBox[{"\[Epsilon]", "->", "0.5"}], ",", 
       RowBox[{"\[Tau]", "->", "1"}], ",", 
       RowBox[{"\[Nu]", "->", "1"}], ",", 
       RowBox[{"k", "->", "1"}], ",", 
       RowBox[{"\[Beta]", "->", "0.1"}], ",", 
       RowBox[{"X", "->", "X"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"EqSol", "[", 
     RowBox[{
      RowBox[{"dval_", "?", "NumericQ"}], ",", 
      RowBox[{"\[Sigma]val_", "?", "NumericQ"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"paramsSpec", ",", "FNumVal", ",", "Rsol", ",", "csol"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"paramsSpec", "=", 
        RowBox[{"Join", "[", 
         RowBox[{"paramsGen", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"a", "->", 
             RowBox[{"X", "-", "dval"}]}], ",", 
            RowBox[{"h", "->", 
             RowBox[{"X", "-", "dval"}]}], ",", 
            RowBox[{"\[Sigma]", "->", "\[Sigma]val"}]}], "}"}]}], "]"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"FNumVal", "[", 
         RowBox[{"R_", "?", "NumericQ"}], "]"}], ":=", 
        RowBox[{
         RowBox[{"FNum", "[", 
          RowBox[{
          "R", ",", "a", ",", "\[Alpha]", ",", "\[Tau]", ",", "h", ",", 
           "\[Eta]min", ",", "\[Eta]max", ",", "\[Nu]", ",", "X", ",", 
           "\[Sigma]", ",", "\[Beta]", ",", "\[Epsilon]"}], "]"}], "/.", 
         "paramsSpec"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Rsol", "=", 
        RowBox[{"Quiet", "@", 
         RowBox[{"FindRoot", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"FNumVal", "[", "R", "]"}], "==", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"R", ",", "0.5"}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Method", "->", "\"\<Secant\>\""}], ",", " ", 
           RowBox[{"WorkingPrecision", "->", "20"}], ",", 
           RowBox[{"AccuracyGoal", "->", "8"}], ",", 
           RowBox[{"PrecisionGoal", "->", "8"}], ",", 
           RowBox[{"MaxIterations", "->", "100"}]}], "\[IndentingNewLine]", 
          "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"csol", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"c", "->", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              FractionBox[
               RowBox[{"r", " ", "R", 
                RowBox[{"(", 
                 RowBox[{"1", "-", 
                  FractionBox["R", "k"]}], ")"}]}], 
               RowBox[{"R", " ", 
                RowBox[{"Int1", "[", 
                 RowBox[{
                 "R", ",", "a", ",", "\[Alpha]", ",", "\[Tau]", ",", "h", ",",
                   "\[Eta]min", ",", "\[Eta]max", ",", "\[Nu]", ",", "X", ",",
                   "\[Sigma]"}], "]"}]}]], ")"}], "/.", "paramsSpec"}], 
            ")"}]}], "/.", "Rsol"}], "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"R", ",", "c"}], "}"}], "/.", 
        RowBox[{"Join", "[", 
         RowBox[{"Rsol", ",", "csol"}], "]"}]}]}]}], "\[IndentingNewLine]", 
     "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DetTr", "[", 
     RowBox[{
      RowBox[{"dval_", "?", "NumericQ"}], ",", 
      RowBox[{"\[Sigma]val_", "?", "NumericQ"}], ",", "sol_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Rsol", ",", "csol", ",", "paramsSpec", ",", "JacobiAtEq"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Rsol", "=", 
        RowBox[{"sol", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"csol", "=", 
        RowBox[{"sol", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"paramsSpec", "=", 
        RowBox[{"Join", "[", 
         RowBox[{"paramsGen", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"a", "->", 
             RowBox[{"X", "-", "dval"}]}], ",", 
            RowBox[{"h", "->", 
             RowBox[{"X", "-", "dval"}]}], ",", 
            RowBox[{"\[Sigma]", "->", "\[Sigma]val"}]}], "}"}]}], "]"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"JacobiAtEq", "=", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"r", 
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 FractionBox[
                  RowBox[{"2", "R"}], "k"]}], ")"}]}], "-", 
              RowBox[{"c", " ", 
               RowBox[{"Int2", "[", 
                RowBox[{
                "R", ",", "a", ",", "\[Alpha]", ",", "\[Tau]", ",", "h", ",", 
                 "\[Eta]min", ",", "\[Eta]max", ",", "\[Nu]", ",", "X", ",", 
                 "\[Sigma]"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"-", "R"}], " ", 
              RowBox[{"Int1", "[", 
               RowBox[{
               "R", ",", "a", ",", "\[Alpha]", ",", "\[Tau]", ",", "h", ",", 
                "\[Eta]min", ",", "\[Eta]max", ",", "\[Nu]", ",", "X", ",", 
                "\[Sigma]"}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\[Epsilon]", " ", "c", " ", 
              RowBox[{"Int2", "[", 
               RowBox[{
               "R", ",", "a", ",", "\[Alpha]", ",", "\[Tau]", ",", "h", ",", 
                "\[Eta]min", ",", "\[Eta]max", ",", "\[Nu]", ",", "X", ",", 
                "\[Sigma]"}], "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"\[Epsilon]", " ", "R", " ", 
               RowBox[{"Int1", "[", 
                RowBox[{
                "R", ",", "a", ",", "\[Alpha]", ",", "\[Tau]", ",", "h", ",", 
                 "\[Eta]min", ",", "\[Eta]max", ",", "\[Nu]", ",", "X", ",", 
                 "\[Sigma]"}], "]"}]}], "-", "\[Beta]"}]}], "}"}]}], 
          "\[IndentingNewLine]", "}"}], "/.", 
         RowBox[{"Join", "[", 
          RowBox[{"paramsSpec", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"R", "->", "Rsol"}], ",", 
             RowBox[{"c", "->", "csol"}]}], "}"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Det", "[", "JacobiAtEq", "]"}], ",", 
         RowBox[{"Tr", "[", "JacobiAtEq", "]"}]}], "}"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Classifying", "[", 
      RowBox[{
       RowBox[{"dval_", "?", "NumericQ"}], ",", 
       RowBox[{"\[Sigma]val_", "?", "NumericQ"}]}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"sol", ",", "coeffs"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"sol", "=", 
         RowBox[{"EqSol", "[", 
          RowBox[{"dval", ",", "\[Sigma]val"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"VectorQ", "[", 
            RowBox[{"sol", ",", "NumericQ"}], "]"}], "&&", 
           RowBox[{
            RowBox[{"sol", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ">", "0"}], "&&", 
           RowBox[{
            RowBox[{"sol", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ">", "0"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"True", ":", " ", "coexistence"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"coeffs", "=", 
            RowBox[{"DetTr", "[", 
             RowBox[{"dval", ",", "\[Sigma]val", ",", "sol"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Which", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"coeffs", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "<", "0"}], ",", "0", 
             RowBox[{"(*", "noncoexistence", "*)"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"coeffs", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ">=", "0"}], "&&", 
              RowBox[{
               RowBox[{"coeffs", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "<", "0"}], "&&", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"coeffs", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "^", "2"}], "-", 
                RowBox[{"4", 
                 RowBox[{"coeffs", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}]}], ">=", "0"}]}], ",", "1",
              ",", 
             RowBox[{"(*", "nonoscillatory", "*)"}], "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"coeffs", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ">=", "0"}], "&&", 
              RowBox[{
               RowBox[{"coeffs", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "<", "0"}], "&&", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"coeffs", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "^", "2"}], "-", 
                RowBox[{"4", 
                 RowBox[{"coeffs", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}]}], "<", "0"}]}], ",", "2", 
             ",", 
             RowBox[{"(*", 
              RowBox[{"damped", " ", "oscillations"}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"coeffs", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ">=", "0"}], "&&", 
              RowBox[{
               RowBox[{"coeffs", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ">=", "0"}]}], ",", "3"}], 
            RowBox[{"(*", 
             RowBox[{"limit", " ", "cycles"}], "*)"}], "\[IndentingNewLine]", 
            "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"False", ":", " ", "noncoexistence"}], "*)"}], 
          "\[IndentingNewLine]", "0"}], "\[IndentingNewLine]", "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"--", 
       RowBox[{"-", " ", "PARALLEL"}]}], " ", 
      RowBox[{"SCAN", " ", "--"}]}], "-"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dvals", "=", 
     RowBox[{"Range", "[", 
      RowBox[{"0", ",", "2.5", ",", "0.02"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Sigma]vals", "=", 
     RowBox[{"Range", "[", 
      RowBox[{"0.01", ",", "6", ",", "0.05"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DistributeDefinitions", "[", 
     RowBox[{
     "pdist", ",", "attack", ",", "handling", ",", "Int1", ",", "Int2", ",", 
      "FNum", ",", "EqSol", ",", "DetTr", ",", "Classifying", ",", 
      "paramsGen", ",", "X"}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"LaunchKernels", "[", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"data", "=", 
     RowBox[{"ParallelTable", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Classifying", "[", 
        RowBox[{"d", ",", "\[Sigma]"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"d", ",", "dvals"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"\[Sigma]", ",", "\[Sigma]vals"}], "}"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"leg", "=", 
     RowBox[{"SwatchLegend", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Black", ",", "White", ",", "LightGray", ",", "Gray"}], "}"}],
        ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"\"\<Noncoexistence\>\"", 
         ",", "\"\<Coexistence: nonoscillatory\>\"", 
         ",", "\"\<Coexistence: damped oscillations\>\"", 
         ",", "\"\<Coexistence: limit cycles\>\""}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"LegendMarkers", "->", "\"\<Rectangle\>\""}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Legended", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ArrayPlot", "[", 
      RowBox[{"data", ",", "\[IndentingNewLine]", 
       RowBox[{"DataReversed", "->", "True"}], ",", "\[IndentingNewLine]", 
       RowBox[{"ColorRules", "->", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"0", "->", "Black"}], ",", "\[IndentingNewLine]", 
          RowBox[{"1", "->", "White"}], ",", "\[IndentingNewLine]", 
          RowBox[{"2", "->", "LightGray"}], ",", "\[IndentingNewLine]", 
          RowBox[{"3", "->", "Gray"}]}], "\[IndentingNewLine]", "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Frame", "->", "True"}], ",", "\[IndentingNewLine]", 
       RowBox[{"FrameTicks", "->", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Round", "[", 
               RowBox[{
                RowBox[{"dvals", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", "0.01"}], "]"}]}], 
             "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "26", ",", 
              RowBox[{"Length", "[", "dvals", "]"}], ",", "25"}], "}"}]}], 
           "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Round", "[", 
               RowBox[{
                RowBox[{"\[Sigma]vals", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", "0.01"}], "]"}]}], 
             "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "20", ",", 
              RowBox[{"Length", "[", "\[Sigma]vals", "]"}], ",", "20"}], 
             "}"}]}], "]"}]}], "\[IndentingNewLine]", "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"FrameLabel", "->", 
        RowBox[{"{", 
         RowBox[{"\"\<Phenotypic mismatch (\!\(\*SuperscriptBox[\(d\), \(2\)]\
\))\>\"", 
          ",", "\"\<Individual variation (\!\(\*SuperscriptBox[\(\[Sigma]\), \
\(2\)]\))\>\""}], "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"Mesh", "->", "False"}], ",", "\[IndentingNewLine]", 
       RowBox[{"AspectRatio", "->", 
        RowBox[{"1", "/", "1.5"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
     "\[IndentingNewLine]", "leg"}], "\[IndentingNewLine]", 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.9699314511689224`*^9, 3.9699329334934235`*^9}, {
   3.9699330284665756`*^9, 3.969933194692686*^9}, {3.969934193787689*^9, 
   3.9699342511674366`*^9}, {3.9699347251351566`*^9, 3.969934739771393*^9}, {
   3.969935054461746*^9, 3.9699350565672264`*^9}, {3.9699353224078197`*^9, 
   3.9699353346830807`*^9}, {3.9699355823378353`*^9, 
   3.9699355846272984`*^9}, {3.969935810456297*^9, 3.9699358268057194`*^9}, {
   3.969936298816349*^9, 3.969936372924412*^9}, {3.9699364110091286`*^9, 
   3.969936495309992*^9}, {3.9699365280351944`*^9, 3.9699365364423504`*^9}, {
   3.9699365735263863`*^9, 3.9699366587386303`*^9}, {3.969936888344055*^9, 
   3.969936930673424*^9}, {3.9699370246162243`*^9, 3.969937027176504*^9}, {
   3.9699370730526276`*^9, 3.9699370796622543`*^9}, {3.9699373801024*^9, 
   3.9699373951485405`*^9}, {3.9699376775480366`*^9, 
   3.9699377153512707`*^9}, {3.9699506599045258`*^9, 3.9699510454556103`*^9}, 
   3.969951210806761*^9, 3.9699512948931465`*^9, {3.9699531568015823`*^9, 
   3.969953159046135*^9}, 3.9699534437117825`*^9, {3.970033741360098*^9, 
   3.970034033867916*^9}, {3.9700343455279255`*^9, 3.970034355794407*^9}, {
   3.970034429902439*^9, 3.9700344541374264`*^9}, {3.9700344872196217`*^9, 
   3.97003448942428*^9}, {3.97003452121496*^9, 3.9700345255074444`*^9}, {
   3.9700345585092697`*^9, 3.9700345598206882`*^9}, 3.970034602676258*^9, {
   3.970034777989235*^9, 3.9700347802198505`*^9}, {3.9700353481091347`*^9, 
   3.970035354823639*^9}, {3.9714028028138676`*^9, 3.971402817822254*^9}, {
   3.9714029219409275`*^9, 3.97140292589814*^9}, {3.97245705021719*^9, 
   3.9724570545814342`*^9}},ExpressionUUID->"b1b60d2e-07af-1c4b-8247-\
e4442d0b7453"],

Cell[BoxData[
 TemplateBox[{
  "LaunchKernels", "nodef", 
   "\"Some parallel subkernels are already running. Not launching default \
kernels again.\"", 2, 66, 2, 17617277808946189884, "Local"},
  "MessageTemplate",
  BaseStyle->"MSG"]], "Message",
 CellChangeTimes->{3.9714032342837353`*^9, 3.9714034400490456`*^9},
 CellLabel->
  "Lors de l\[CloseCurlyQuote]\[EAcute]valuation de \
In[47]:=",ExpressionUUID->"2d5c7423-b417-cc45-a8be-60e42ae41fbd"],

Cell[BoxData[
 TemplateBox[{
   GraphicsBox[
    RasterBox[SparseArray[Automatic, {126, 120}, 0., {1, {CompressedData["
1:eJx9zitIxAAcx/Gfno/5nu/5vN2devM9X7AkA8viMA3T1LKki9cULGISDBqN
Fwxismk0ChaDQUyWg4Fl0S/Y/cOn/Mv3Vzo43j1qknSiv6shQ8LzE1Gz9Iqg
ID3Da5Hu4bRKt7DapEsY7dIpcqSG9I24Q3pH2Cm9wO+SHuF2S3XYPdINzF7p
HOqjjwyJSR9RP30EA/ThDdKHM0Qf1jB9GCP0kSMdpY/Yoo9wjD78cfpwJ+jD
nqQPc4o+NE0fGZIifUQ2fQQl+vDK9OFU6MOaoQ9jlj5ypHP0EVfpI3Tow5+n
D3eBPuxF+jCX6EPL9NHA/or0hp1V6QFFV7rAD/bWpCeU16UzfGF7Q7pGA/4m
m/CBypZ0iCvc/eMX81dP8w==
        "], CompressedData["
1:eJztzdk2gmEUh/G3zPM8R0JIyJShTJmHChEy95nHzLooF6kb6MDyvbtlredo
n/z383MYiYhhVUp9e5WypK7FmpWdk5uXX1BYVFxSWlZeUVlVXVNbV9/Q2GRr
brG3OtraO5ydXd2uHndvX79nYHBoeMQ7OjY+4fNPTk3PzAbm5hcWl5ZXVtfW
g6HwxuZWZHsnuru3Hzs4PDo+OT2LG+cXl1fXN7d39w+PT4nnl9e394/PryQu
Li4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4u7n9x
M4JmwpQXpT1hThQTpMQgIUYEESC0A5rzOtvawnqqGpJm98xsmZT5a+C3j2lH
P74CDUM=
        "]}, CompressedData["
1:eJzt07FNRDEURNFPKdSAiOmBEpA2pjGKIiehBKTVinQXhBg/z3FyUsuee//y
+ny6O47j7fG4nPenFh/O54PcwnRP+iX1q182mu5Jt6R+9ctG013pl9Svftlo
uiv9kvrVLxtNd6VfUr/6ZaPprvRL6le3bDTdl35J/eqXjab70i+pX92y0XRn
+iX1q182mu5Mv6R+dctG073pl9Rv+h1J/eqX1C/ZYbo73ZL6JRtN96dbUr9k
o+kOdUvql2w03aNuyX37Tb8PubLpPvVL7tdv+l3ICaY71S05v9/0O5AT1S05
V/2Sc9UtOVe9knPVLTlX3ZJz1Ss5V92Sc9UrOVedkiRJkiRJkiRJkiRJkiRJ
kiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkmSHx/l8fpu+D8nb
e9Uvua7XetUvuY4/7VW/5Nxe9UzO71TP5H696pmc36me2Wy6Kz2TOv0r0//E
btP73830f3JP07tuN/3/XNv0Pvk707vh/5jeGTOmd8fbTO+EM03vdlfT/8pu
0/vXG0mSJEmSJEmSJEmSJEmSJEmSJEmSJEmS6/sFc5/G/g==
       "]}], {{0, 0}, {120, 126}}, {0, 1}], AspectRatio -> 0.6666666666666666,
     Frame -> True, FrameLabel -> {
      FormBox[
      "\"Individual variation (\\!\\(\\*SuperscriptBox[\\(\[Sigma]\\), \
\\(2\\)]\\))\"", TraditionalForm], 
      FormBox[
      "\"Phenotypic mismatch (\\!\\(\\*SuperscriptBox[\\(d\\), \
\\(2\\)]\\))\"", TraditionalForm]}, FrameTicks -> {{{{25.5, 
         FormBox["0.5`", TraditionalForm]}, {50.5, 
         FormBox["1.`", TraditionalForm]}, {75.5, 
         FormBox["1.5`", TraditionalForm]}, {100.5, 
         FormBox["2.`", TraditionalForm]}, {125.5, 
         FormBox["2.5`", TraditionalForm]}}, None}, {{{19.5, 
         FormBox["0.96`", TraditionalForm]}, {39.5, 
         FormBox["1.96`", TraditionalForm]}, {59.5, 
         FormBox["2.96`", TraditionalForm]}, {79.5, 
         FormBox["3.96`", TraditionalForm]}, {99.5, 
         FormBox["4.96`", TraditionalForm]}, {119.5, 
         FormBox["5.96`", TraditionalForm]}}, None}}, GridLinesStyle -> 
    Directive[
      GrayLevel[0.5, 0.4]], 
    Method -> {
     "GridLinesInFront" -> True, "DefaultBoundaryStyle" -> Automatic, 
      "DefaultGraphicsInteraction" -> {
       "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
        "Effects" -> {
         "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
          "Droplines" -> {
           "freeformCursorMode" -> True, 
            "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
      "DefaultPlotStyle" -> Automatic}], 
   FormBox[
    FormBox[
     TemplateBox[{
      "\"Noncoexistence\"", "\"Coexistence: nonoscillatory\"", 
       "\"Coexistence: damped oscillations\"", 
       "\"Coexistence: limit cycles\""}, "SwatchLegend", 
      DisplayFunction -> (FormBox[
        StyleBox[
         StyleBox[
          PaneBox[
           TagBox[
            GridBox[{{
               TagBox[
                GridBox[{{
                   GraphicsBox[{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    AbsoluteThickness[1.6], 
                    GrayLevel[0]], 
                    RectangleBox[{0, 0}, {10, 10}, "RoundingRadius" -> 0]}, 
                    AspectRatio -> Full, ImageSize -> {10, 10}, 
                    PlotRangePadding -> None, ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #}, {
                   GraphicsBox[{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    AbsoluteThickness[1.6], 
                    GrayLevel[1]], 
                    RectangleBox[{0, 0}, {10, 10}, "RoundingRadius" -> 0]}, 
                    AspectRatio -> Full, ImageSize -> {10, 10}, 
                    PlotRangePadding -> None, ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #2}, {
                   GraphicsBox[{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    AbsoluteThickness[1.6], 
                    GrayLevel[0.85]], 
                    RectangleBox[{0, 0}, {10, 10}, "RoundingRadius" -> 0]}, 
                    AspectRatio -> Full, ImageSize -> {10, 10}, 
                    PlotRangePadding -> None, ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #3}, {
                   GraphicsBox[{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    AbsoluteThickness[1.6], 
                    GrayLevel[0.5]], 
                    RectangleBox[{0, 0}, {10, 10}, "RoundingRadius" -> 0]}, 
                    AspectRatio -> Full, ImageSize -> {10, 10}, 
                    PlotRangePadding -> None, ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #4}}, 
                 GridBoxAlignment -> {
                  "Columns" -> {Center, Left}, "Rows" -> {{Baseline}}}, 
                 AutoDelete -> False, 
                 GridBoxDividers -> {
                  "Columns" -> {{False}}, "Rows" -> {{False}}}, 
                 GridBoxItemSize -> {"Columns" -> {{All}}, "Rows" -> {{All}}},
                  GridBoxSpacings -> {
                  "Columns" -> {{0.3}}, "Rows" -> {{0.5}}}], "Grid"]}}, 
             GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
             AutoDelete -> False, 
             GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{1}}, "Rows" -> {{0}}}], 
            "Grid"], Alignment -> Left, AppearanceElements -> None, 
           ImageMargins -> {{5, 5}, {5, 5}}, ImageSizeAction -> 
           "ResizeToFit"], LineIndent -> 0, StripOnInput -> False], {
         FontFamily -> "Arial"}, Background -> Automatic, StripOnInput -> 
         False], TraditionalForm]& ), 
      InterpretationFunction :> (RowBox[{"SwatchLegend", "[", 
         RowBox[{
           RowBox[{"{", 
             RowBox[{
               
               TemplateBox[<|"color" -> GrayLevel[0]|>, 
                "GrayLevelColorSwatchTemplate"], ",", 
               
               TemplateBox[<|"color" -> GrayLevel[1]|>, 
                "GrayLevelColorSwatchTemplate"], ",", 
               
               TemplateBox[<|"color" -> GrayLevel[0.85]|>, 
                "GrayLevelColorSwatchTemplate"], ",", 
               
               TemplateBox[<|"color" -> GrayLevel[0.5]|>, 
                "GrayLevelColorSwatchTemplate"]}], "}"}], ",", 
           RowBox[{"{", 
             RowBox[{#, ",", #2, ",", #3, ",", #4}], "}"}], ",", 
           RowBox[{"LegendMarkers", "\[Rule]", "\"Rectangle\""}]}], "]"}]& ), 
      Editable -> True], TraditionalForm], TraditionalForm]},
  "Legended",
  DisplayFunction->(GridBox[{{
      TagBox[
       ItemBox[
        PaneBox[
         TagBox[#, "SkipImageSizeLevel"], Alignment -> {Center, Baseline}, 
         BaselinePosition -> Baseline], DefaultBaseStyle -> "Labeled"], 
       "SkipImageSizeLevel"], 
      ItemBox[#2, DefaultBaseStyle -> "LabeledLabel"]}}, 
    GridBoxAlignment -> {"Columns" -> {{Center}}, "Rows" -> {{Center}}}, 
    AutoDelete -> False, GridBoxItemSize -> Automatic, 
    BaselinePosition -> {1, 1}]& ),
  Editable->True,
  InterpretationFunction->(RowBox[{"Legended", "[", 
     RowBox[{#, ",", 
       RowBox[{"Placed", "[", 
         RowBox[{#2, ",", "After"}], "]"}]}], "]"}]& )]], "Output",
 CellChangeTimes->{3.969933754314596*^9, 3.96993446820998*^9, 
  3.969935029683735*^9, 3.9699352898852425`*^9, 3.9699355455521584`*^9, 
  3.9699357824327984`*^9, 3.9699360450401306`*^9, 3.969936356261156*^9, 
  3.9699364491555767`*^9, 3.969936510196743*^9, 3.9699365520359344`*^9, 
  3.9699368695221443`*^9, 3.969937020170532*^9, 3.9699370659163837`*^9, 
  3.969937309785284*^9, 3.9699376205093937`*^9, 3.9699379216681557`*^9, 
  3.970033992484541*^9, 3.970034215831072*^9, 3.9700343393611336`*^9, 
  3.9700347654055214`*^9, 3.9700349385872803`*^9, 3.9714031473884354`*^9, 
  3.971403403894562*^9, 3.9714035982150154`*^9},
 CellLabel->"Out[69]=",ExpressionUUID->"b65e87d9-dc97-8949-aa14-caff3f2d5baa"]
}, Open  ]],

Cell["This plot took 2\[CloseCurlyQuote]40, so 2.2 times faster.", "Text",
 CellChangeTimes->{{3.9699344795980263`*^9, 3.969934484829487*^9}, {
  3.9699345446945324`*^9, 3.9699345487355576`*^9}, {3.9699379246392937`*^9, 
  3.969937934515127*^9}, {3.9699641362975864`*^9, 3.9699641524350452`*^9}, {
  3.9700347687355194`*^9, 3.970034770700369*^9}, {3.970034951512232*^9, 
  3.9700349631307125`*^9}},ExpressionUUID->"952e030b-8a04-2e46-be55-\
d0ea6bc904d1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"N", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"5", "*", "60"}], "+", "45"}], ")"}], "/", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", "*", "60"}], "+", "40"}], ")"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.9699344932942715`*^9, 3.969934535329914*^9}, {
  3.9699379295041924`*^9, 3.969937929873663*^9}, {3.9700349467185*^9, 
  3.970034948825905*^9}},
 CellLabel->
  "In[715]:=",ExpressionUUID->"c5b64192-7ae4-1340-a20e-18271f8bc927"],

Cell[BoxData["2.15625`"], "Output",
 CellChangeTimes->{{3.969934510283455*^9, 3.969934535680111*^9}, 
   3.9699379311349335`*^9, 3.9700349491282253`*^9},
 CellLabel->
  "Out[715]=",ExpressionUUID->"12ea9c3e-520c-3545-8bbc-1dd307215086"]
}, Open  ]],

Cell[TextData[{
 "Let\[CloseCurlyQuote]s increase the resolution. ",
 Cell[BoxData[
  FormBox[
   RowBox[{"d", ":", 
    RowBox[{"\[Times]", "4"}]}], TraditionalForm]],ExpressionUUID->
  "d7de5dfe-6b38-6445-9489-0a170958a2c7"],
 " (step=0.005), ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Sigma]", ":", 
    RowBox[{"\[Times]", "5"}]}], TraditionalForm]],ExpressionUUID->
  "a285a163-9b8c-d841-9a88-f88a5e960161"],
 " (step=0.01) ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Rule]", 
    RowBox[{"\[Times]", 
     RowBox[{"20", "~", "53"}]}]}], TraditionalForm]],ExpressionUUID->
  "2520f8e1-71fe-ac4a-ba34-02f81691b604"],
 "\[CloseCurlyQuote]."
}], "Text",
 CellChangeTimes->{{3.9699377420350494`*^9, 3.9699377610634136`*^9}, {
  3.969938068690134*^9, 3.9699382179906673`*^9}, {3.9700348524300537`*^9, 
  3.9700348524300537`*^9}, {3.9700350048641033`*^9, 
  3.970035019910267*^9}},ExpressionUUID->"da5fe91d-bb30-4543-bd88-\
c55d13a05dfe"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"--", 
      RowBox[{"-", " ", "GLOBAL"}]}], " ", 
     RowBox[{"SETTINGS", " ", "--"}]}], "-"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SetOptions", "[", 
     RowBox[{"NIntegrate", ",", 
      RowBox[{"Method", "->", "\"\<GlobalAdaptive\>\""}], ",", 
      RowBox[{"MaxRecursion", "->", "20"}], ",", 
      RowBox[{"AccuracyGoal", "->", "6"}], ",", 
      RowBox[{"PrecisionGoal", "->", "6"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"--", 
       RowBox[{"-", " ", "FUNCTIONS"}]}], " ", 
      RowBox[{"DEFINITIONS", " ", "--"}]}], "-"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ClearAll", "[", 
     RowBox[{"pdist", ",", "attack", ",", "handling"}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"pdist", "[", 
      RowBox[{"x_", ",", "X_", ",", "\[Sigma]_"}], "]"}], ":=", 
     RowBox[{
      FractionBox["1", 
       SqrtBox[
        RowBox[{"2", "\[Pi]", " ", "\[Sigma]"}]]], 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"x", "-", "X"}], ")"}], "2"], 
         RowBox[{"2", "\[Sigma]"}]]}]]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"attack", "[", 
      RowBox[{"x_", ",", "a_", ",", "\[Alpha]_", ",", "\[Tau]_"}], "]"}], ":=", 
     RowBox[{"\[Alpha]", " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"x", "-", "a"}], ")"}], "2"], 
         RowBox[{"2", 
          SuperscriptBox["\[Tau]", "2"]}]]}]]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"handling", "[", 
      RowBox[{
      "x_", ",", "h_", ",", "\[Eta]min_", ",", "\[Eta]max_", ",", "\[Nu]_"}], 
      "]"}], ":=", 
     RowBox[{"\[Eta]max", "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"\[Eta]max", "-", "\[Eta]min"}], ")"}], 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"-", 
         FractionBox[
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"x", "-", "h"}], ")"}], "2"], 
          RowBox[{"2", 
           SuperscriptBox["\[Nu]", "2"]}]]}]]}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"--", 
       RowBox[{"-", " ", "MEMOIZED"}]}], " ", 
      RowBox[{"INTEGRALS", " ", "--"}]}], "-"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ClearAll", "[", 
     RowBox[{"Int1", ",", "Int2"}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Int1", "[", 
      RowBox[{
       RowBox[{"R_", "?", "NumericQ"}], ",", 
       RowBox[{"a_", "?", "NumericQ"}], ",", 
       RowBox[{"\[Alpha]_", "?", "NumericQ"}], ",", 
       RowBox[{"\[Tau]_", "?", "NumericQ"}], ",", 
       RowBox[{"h_", "?", "NumericQ"}], ",", 
       RowBox[{"\[Eta]min_", "?", "NumericQ"}], ",", 
       RowBox[{"\[Eta]max_", "?", "NumericQ"}], ",", 
       RowBox[{"\[Nu]_", "?", "NumericQ"}], ",", 
       RowBox[{"X_", "?", "NumericQ"}], ",", 
       RowBox[{"\[Sigma]_", "?", "NumericQ"}]}], "]"}], ":=", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Int1", "[", 
       RowBox[{
       "R", ",", "a", ",", "\[Alpha]", ",", "\[Tau]", ",", "h", ",", 
        "\[Eta]min", ",", "\[Eta]max", ",", "\[Nu]", ",", "X", ",", 
        "\[Sigma]"}], "]"}], "=", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"xmin", "=", 
           RowBox[{"X", "-", 
            RowBox[{"5", "\[Sigma]"}]}]}], ",", 
          RowBox[{"xmax", "=", 
           RowBox[{"X", "+", 
            RowBox[{"5", "\[Sigma]"}]}]}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"NIntegrate", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"attack", "[", 
             RowBox[{"x", ",", "a", ",", "\[Alpha]", ",", "\[Tau]"}], "]"}], "/", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{
               RowBox[{"attack", "[", 
                RowBox[{"x", ",", "a", ",", "\[Alpha]", ",", "\[Tau]"}], 
                "]"}], 
               RowBox[{"handling", "[", 
                RowBox[{
                "x", ",", "h", ",", "\[Eta]min", ",", "\[Eta]max", ",", 
                 "\[Nu]"}], "]"}], "R"}]}], ")"}]}], 
           RowBox[{"pdist", "[", 
            RowBox[{"x", ",", "X", ",", "\[Sigma]"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"\[Sigma]", "<", "1"}], ",", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{"adaptive", " ", "integration", " ", "limits"}], ",", 
              " ", 
              RowBox[{
              "because", " ", "when", " ", "\[Sigma]", " ", "is", " ", "too", 
               " ", "small"}], ",", " ", 
              RowBox[{
              "numerical", " ", "integration", " ", "is", " ", "wrong"}]}], 
             "*)"}], "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{"X", "-", "5"}], ",", 
              RowBox[{"X", "+", "5"}]}], "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"x", ",", "xmin", ",", "xmax"}], "}"}]}], 
           "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
       "\[IndentingNewLine]", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Int2", "[", 
      RowBox[{
       RowBox[{"R_", "?", "NumericQ"}], ",", 
       RowBox[{"a_", "?", "NumericQ"}], ",", 
       RowBox[{"\[Alpha]_", "?", "NumericQ"}], ",", 
       RowBox[{"\[Tau]_", "?", "NumericQ"}], ",", 
       RowBox[{"h_", "?", "NumericQ"}], ",", 
       RowBox[{"\[Eta]min_", "?", "NumericQ"}], ",", 
       RowBox[{"\[Eta]max_", "?", "NumericQ"}], ",", 
       RowBox[{"\[Nu]_", "?", "NumericQ"}], ",", 
       RowBox[{"X_", "?", "NumericQ"}], ",", 
       RowBox[{"\[Sigma]_", "?", "NumericQ"}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{"Int2", "[", 
       RowBox[{
       "R", ",", "a", ",", "\[Alpha]", ",", "\[Tau]", ",", "h", ",", 
        "\[Eta]min", ",", "\[Eta]max", ",", "\[Nu]", ",", "X", ",", 
        "\[Sigma]"}], "]"}], "=", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"xmin", "=", 
           RowBox[{"X", "-", 
            RowBox[{"5", "\[Sigma]"}]}]}], ",", 
          RowBox[{"xmax", "=", 
           RowBox[{"X", "+", 
            RowBox[{"5", "\[Sigma]"}]}]}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"NIntegrate", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"With", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"A", "=", 
               RowBox[{"attack", "[", 
                RowBox[{"x", ",", "a", ",", "\[Alpha]", ",", "\[Tau]"}], 
                "]"}]}], ",", 
              RowBox[{"H", "=", 
               RowBox[{"handling", "[", 
                RowBox[{
                "x", ",", "h", ",", "\[Eta]min", ",", "\[Eta]max", ",", 
                 "\[Nu]"}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"A", "/", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"A", " ", "H", " ", "R"}]}], ")"}]}], 
             RowBox[{"pdist", "[", 
              RowBox[{"x", ",", "X", ",", "\[Sigma]"}], "]"}], 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"A", " ", "H", " ", "R"}], ")"}], "/", 
                RowBox[{"(", 
                 RowBox[{"1", "+", 
                  RowBox[{"A", " ", "H", " ", "R"}]}], ")"}]}]}], ")"}]}]}], 
           "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"\[Sigma]", "<", "1"}], ",", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{"adaptive", " ", "integration", " ", "limits"}], ",", 
              " ", 
              RowBox[{
              "because", " ", "when", " ", "\[Sigma]", " ", "is", " ", "too", 
               " ", "small"}], ",", " ", 
              RowBox[{
              "numerical", " ", "integration", " ", "is", " ", "wrong"}]}], 
             "*)"}], "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{"X", "-", "5"}], ",", 
              RowBox[{"X", "+", "5"}]}], "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"x", ",", "xmin", ",", "xmax"}], "}"}]}], 
           "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
       "\[IndentingNewLine]", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"--", 
       RowBox[{"-", " ", "MODEL"}]}], " ", 
      RowBox[{"DEFINITION", " ", "--"}]}], "-"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ClearAll", "[", 
     RowBox[{"FNum", ",", "EqSol", ",", "DetTr", ",", "Classifying"}], "]"}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"FNum", "[", 
      RowBox[{
       RowBox[{"R_", "?", "NumericQ"}], ",", 
       RowBox[{"a_", "?", "NumericQ"}], ",", 
       RowBox[{"\[Alpha]_", "?", "NumericQ"}], ",", 
       RowBox[{"\[Tau]_", "?", "NumericQ"}], ",", 
       RowBox[{"h_", "?", "NumericQ"}], ",", 
       RowBox[{"\[Eta]min_", "?", "NumericQ"}], ",", 
       RowBox[{"\[Eta]max_", "?", "NumericQ"}], ",", 
       RowBox[{"\[Nu]_", "?", "NumericQ"}], ",", 
       RowBox[{"X_", "?", "NumericQ"}], ",", 
       RowBox[{"\[Sigma]_", "?", "NumericQ"}], ",", 
       RowBox[{"\[Beta]_", "?", "NumericQ"}], ",", 
       RowBox[{"\[Epsilon]_", "?", "NumericQ"}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{"R", " ", 
       RowBox[{"Int1", "[", 
        RowBox[{
        "R", ",", "a", ",", "\[Alpha]", ",", "\[Tau]", ",", "h", ",", 
         "\[Eta]min", ",", "\[Eta]max", ",", "\[Nu]", ",", "X", ",", 
         "\[Sigma]"}], "]"}]}], "-", 
      FractionBox["\[Beta]", "\[Epsilon]"]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"X", "=", "3"}], ";"}], 
   RowBox[{"(*", 
    RowBox[{"arbitrary", ",", " ", 
     RowBox[{"can", " ", "be", " ", "any", " ", "real", " ", "number"}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"paramsGen", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"r", "->", "0.3"}], ",", 
       RowBox[{"\[Alpha]", "->", "2"}], ",", 
       RowBox[{"\[Eta]max", "->", "2"}], ",", 
       RowBox[{"\[Eta]min", "->", "1"}], ",", 
       RowBox[{"\[Epsilon]", "->", "0.5"}], ",", 
       RowBox[{"\[Tau]", "->", "1"}], ",", 
       RowBox[{"\[Nu]", "->", "1"}], ",", 
       RowBox[{"k", "->", "1"}], ",", 
       RowBox[{"\[Beta]", "->", "0.1"}], ",", 
       RowBox[{"X", "->", "X"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"EqSol", "[", 
     RowBox[{
      RowBox[{"dval_", "?", "NumericQ"}], ",", 
      RowBox[{"\[Sigma]val_", "?", "NumericQ"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"paramsSpec", ",", "FNumVal", ",", "Rsol", ",", "csol"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"paramsSpec", "=", 
        RowBox[{"Join", "[", 
         RowBox[{"paramsGen", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"a", "->", 
             RowBox[{"X", "-", "dval"}]}], ",", 
            RowBox[{"h", "->", 
             RowBox[{"X", "-", "dval"}]}], ",", 
            RowBox[{"\[Sigma]", "->", "\[Sigma]val"}]}], "}"}]}], "]"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"FNumVal", "[", 
         RowBox[{"R_", "?", "NumericQ"}], "]"}], ":=", 
        RowBox[{
         RowBox[{"FNum", "[", 
          RowBox[{
          "R", ",", "a", ",", "\[Alpha]", ",", "\[Tau]", ",", "h", ",", 
           "\[Eta]min", ",", "\[Eta]max", ",", "\[Nu]", ",", "X", ",", 
           "\[Sigma]", ",", "\[Beta]", ",", "\[Epsilon]"}], "]"}], "/.", 
         "paramsSpec"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Rsol", "=", 
        RowBox[{"Quiet", "@", 
         RowBox[{"FindRoot", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"FNumVal", "[", "R", "]"}], "==", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"R", ",", "0.5"}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Method", "->", "\"\<Secant\>\""}], ",", " ", 
           RowBox[{"WorkingPrecision", "->", "20"}], ",", 
           RowBox[{"AccuracyGoal", "->", "8"}], ",", 
           RowBox[{"PrecisionGoal", "->", "8"}], ",", 
           RowBox[{"MaxIterations", "->", "100"}]}], "\[IndentingNewLine]", 
          "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"csol", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"c", "->", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              FractionBox[
               RowBox[{"r", " ", "R", 
                RowBox[{"(", 
                 RowBox[{"1", "-", 
                  FractionBox["R", "k"]}], ")"}]}], 
               RowBox[{"R", " ", 
                RowBox[{"Int1", "[", 
                 RowBox[{
                 "R", ",", "a", ",", "\[Alpha]", ",", "\[Tau]", ",", "h", ",",
                   "\[Eta]min", ",", "\[Eta]max", ",", "\[Nu]", ",", "X", ",",
                   "\[Sigma]"}], "]"}]}]], ")"}], "/.", "paramsSpec"}], 
            ")"}]}], "/.", "Rsol"}], "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"R", ",", "c"}], "}"}], "/.", 
        RowBox[{"Join", "[", 
         RowBox[{"Rsol", ",", "csol"}], "]"}]}]}]}], "\[IndentingNewLine]", 
     "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DetTr", "[", 
     RowBox[{
      RowBox[{"dval_", "?", "NumericQ"}], ",", 
      RowBox[{"\[Sigma]val_", "?", "NumericQ"}], ",", "sol_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Rsol", ",", "csol", ",", "paramsSpec", ",", "JacobiAtEq"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Rsol", "=", 
        RowBox[{"sol", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"csol", "=", 
        RowBox[{"sol", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"paramsSpec", "=", 
        RowBox[{"Join", "[", 
         RowBox[{"paramsGen", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"a", "->", 
             RowBox[{"X", "-", "dval"}]}], ",", 
            RowBox[{"h", "->", 
             RowBox[{"X", "-", "dval"}]}], ",", 
            RowBox[{"\[Sigma]", "->", "\[Sigma]val"}]}], "}"}]}], "]"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"JacobiAtEq", "=", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"r", 
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 FractionBox[
                  RowBox[{"2", "R"}], "k"]}], ")"}]}], "-", 
              RowBox[{"c", " ", 
               RowBox[{"Int2", "[", 
                RowBox[{
                "R", ",", "a", ",", "\[Alpha]", ",", "\[Tau]", ",", "h", ",", 
                 "\[Eta]min", ",", "\[Eta]max", ",", "\[Nu]", ",", "X", ",", 
                 "\[Sigma]"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"-", "R"}], " ", 
              RowBox[{"Int1", "[", 
               RowBox[{
               "R", ",", "a", ",", "\[Alpha]", ",", "\[Tau]", ",", "h", ",", 
                "\[Eta]min", ",", "\[Eta]max", ",", "\[Nu]", ",", "X", ",", 
                "\[Sigma]"}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\[Epsilon]", " ", "c", " ", 
              RowBox[{"Int2", "[", 
               RowBox[{
               "R", ",", "a", ",", "\[Alpha]", ",", "\[Tau]", ",", "h", ",", 
                "\[Eta]min", ",", "\[Eta]max", ",", "\[Nu]", ",", "X", ",", 
                "\[Sigma]"}], "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"\[Epsilon]", " ", "R", " ", 
               RowBox[{"Int1", "[", 
                RowBox[{
                "R", ",", "a", ",", "\[Alpha]", ",", "\[Tau]", ",", "h", ",", 
                 "\[Eta]min", ",", "\[Eta]max", ",", "\[Nu]", ",", "X", ",", 
                 "\[Sigma]"}], "]"}]}], "-", "\[Beta]"}]}], "}"}]}], 
          "\[IndentingNewLine]", "}"}], "/.", 
         RowBox[{"Join", "[", 
          RowBox[{"paramsSpec", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"R", "->", "Rsol"}], ",", 
             RowBox[{"c", "->", "csol"}]}], "}"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Det", "[", "JacobiAtEq", "]"}], ",", 
         RowBox[{"Tr", "[", "JacobiAtEq", "]"}]}], "}"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Classifying", "[", 
      RowBox[{
       RowBox[{"dval_", "?", "NumericQ"}], ",", 
       RowBox[{"\[Sigma]val_", "?", "NumericQ"}]}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"sol", ",", "coeffs"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"sol", "=", 
         RowBox[{"EqSol", "[", 
          RowBox[{"dval", ",", "\[Sigma]val"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"VectorQ", "[", 
            RowBox[{"sol", ",", "NumericQ"}], "]"}], "&&", 
           RowBox[{
            RowBox[{"sol", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ">", "0"}], "&&", 
           RowBox[{
            RowBox[{"sol", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ">", "0"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"True", ":", " ", "coexistence"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"coeffs", "=", 
            RowBox[{"DetTr", "[", 
             RowBox[{"dval", ",", "\[Sigma]val", ",", "sol"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Which", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"coeffs", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "<", "0"}], ",", "0", 
             RowBox[{"(*", "noncoexistence", "*)"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"coeffs", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ">=", "0"}], "&&", 
              RowBox[{
               RowBox[{"coeffs", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "<", "0"}], "&&", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"coeffs", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "^", "2"}], "-", 
                RowBox[{"4", 
                 RowBox[{"coeffs", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}]}], ">=", "0"}]}], ",", "1",
              ",", 
             RowBox[{"(*", "nonoscillatory", "*)"}], "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"coeffs", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ">=", "0"}], "&&", 
              RowBox[{
               RowBox[{"coeffs", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "<", "0"}], "&&", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"coeffs", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "^", "2"}], "-", 
                RowBox[{"4", 
                 RowBox[{"coeffs", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}]}], "<", "0"}]}], ",", "2", 
             ",", 
             RowBox[{"(*", 
              RowBox[{"damped", " ", "oscillations"}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"coeffs", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ">=", "0"}], "&&", 
              RowBox[{
               RowBox[{"coeffs", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ">=", "0"}]}], ",", "3"}], 
            RowBox[{"(*", 
             RowBox[{"limit", " ", "cycles"}], "*)"}], "\[IndentingNewLine]", 
            "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"False", ":", " ", "noncoexistence"}], "*)"}], 
          "\[IndentingNewLine]", "0"}], "\[IndentingNewLine]", "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"--", 
       RowBox[{"-", " ", "PARALLEL"}]}], " ", 
      RowBox[{"SCAN", " ", "--"}]}], "-"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dvals", "=", 
     RowBox[{"Range", "[", 
      RowBox[{"0", ",", "2.5", ",", "0.005"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Sigma]vals", "=", 
     RowBox[{"Range", "[", 
      RowBox[{"0.01", ",", "6", ",", "0.01"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DistributeDefinitions", "[", 
     RowBox[{
     "pdist", ",", "attack", ",", "handling", ",", "Int1", ",", "Int2", ",", 
      "FNum", ",", "EqSol", ",", "DetTr", ",", "Classifying", ",", 
      "paramsGen", ",", "X"}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"LaunchKernels", "[", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"data", "=", 
     RowBox[{"ParallelTable", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Classifying", "[", 
        RowBox[{"d", ",", "\[Sigma]"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"d", ",", "dvals"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"\[Sigma]", ",", "\[Sigma]vals"}], "}"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"--", 
       RowBox[{"-", " ", "EXPORTING"}]}], " ", 
      RowBox[{"RESULT", " ", "--"}]}], "-"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dataWithCols", "=", 
     RowBox[{"Prepend", "[", 
      RowBox[{"data", ",", "\[Sigma]vals"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dataWithHeader", "=", 
     RowBox[{"MapThread", "[", 
      RowBox[{"Prepend", ",", 
       RowBox[{"{", 
        RowBox[{"dataWithCols", ",", 
         RowBox[{"Prepend", "[", 
          RowBox[{"dvals", ",", "\"\<d^2\\\\sigma^2\>\""}], "]"}]}], "}"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
    "dataDir", 
     "=", "\"\<D:\\\\OneDrive - agroparistech.fr\\\\predator-prey-ecotox-vi\\\
\\outputs\\\\data\\\\\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"!", 
       RowBox[{"DirectoryQ", "[", "dataDir", "]"}]}], ",", 
      RowBox[{"CreateDirectory", "[", "dataDir", "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"dataDir", "<>", "\"\<fig_3_data.csv\>\""}], ",", 
      "dataWithHeader"}], "]"}], ";"}]}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQAWIQ7eN2U4dvylvHP6FKeiC6Yl6lG4g+IHUWTBtM2BAr
CKR/BDHFg2gBtsIUEL2hRCgdREuwrroIonU4VtwE0SmFiz+BaBuv319AdMQE
vr8gOiThBY8QkPbwdzAA0QWfMoxAtEXBNjMQvaNwsjmINjkY7gCiH5xQdgSL
W/tVg2gN+3YwnfEg/BGIvqOcBqbnnJsXJgKkYzafDgfRb7oLk0H0lYv2qSCa
4/ujdSDao4T7KIiuMMmrtAXSCyLfN4DoMwbqq0D0mre1q8H8Mze3gmiHWp5t
ILonSe4qiA6J7AXTMi/Pv7o5Daie+8sbEA0APPCcQA==
  "],
 CellLabel->"In[1]:=",ExpressionUUID->"1e0e7e20-decf-ec4d-9bf1-d7c56dc44286"],

Cell["Here\[CloseCurlyQuote]s the plot:", "Text",
 CellChangeTimes->{{3.9699457741773014`*^9, 3.9699457922112617`*^9}, {
   3.9699459572341995`*^9, 3.969945960129965*^9}, 
   3.9699460598700905`*^9},ExpressionUUID->"262cde47-3201-8f49-b26a-\
df662d59c316"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"--", 
      RowBox[{"-", " ", "IMPORTING"}]}], " ", 
     RowBox[{"RESULTS", " ", "--"}]}], "-"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "dataDir", 
   "=", "\"\<D:\\\\OneDrive - \
agroparistech.fr\\\\predator-prey-ecotox-vi\\\\outputs\\\\data\\\\\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"raw", "=", 
   RowBox[{"Import", "[", 
    RowBox[{"dataDir", "<>", "\"\<fig_3_data.csv\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dvals", "=", 
   RowBox[{"ToExpression", "/@", 
    RowBox[{"Rest", "[", 
     RowBox[{"First", "[", "raw", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]vals", "=", 
   RowBox[{"ToExpression", "/@", 
    RowBox[{"Rest", "[", 
     RowBox[{"raw", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"data", "=", 
    RowBox[{"ToExpression", "/@", 
     RowBox[{"raw", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"2", ";;"}], ",", 
        RowBox[{"2", ";;"}]}], "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]",
   "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"--", 
      RowBox[{"-", " ", "DEFINING"}]}], " ", 
     RowBox[{"PLOT", " ", "--"}]}], "-"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"leg", "=", 
   RowBox[{"SwatchLegend", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Black", ",", "White", ",", "LightGray", ",", "Gray"}], "}"}], ",",
      "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\"\<Noncoexistence\>\"", 
       ",", "\"\<Coexistence: nonoscillatory\>\"", 
       ",", "\"\<Coexistence: damped oscillations\>\"", 
       ",", "\"\<Coexistence: limit cycles\>\""}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"LegendMarkers", "->", "\"\<Rectangle\>\""}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"plot", "=", 
   RowBox[{"Legended", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ArrayPlot", "[", 
      RowBox[{"data", ",", "\[IndentingNewLine]", 
       RowBox[{"DataReversed", "->", "True"}], ",", "\[IndentingNewLine]", 
       RowBox[{"ColorRules", "->", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"0", "->", "Black"}], ",", "\[IndentingNewLine]", 
          RowBox[{"1", "->", "White"}], ",", "\[IndentingNewLine]", 
          RowBox[{"2", "->", "LightGray"}], ",", "\[IndentingNewLine]", 
          RowBox[{"3", "->", "Gray"}]}], "\[IndentingNewLine]", "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Frame", "->", "True"}], ",", "\[IndentingNewLine]", 
       RowBox[{"FrameTicks", "->", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Round", "[", 
               RowBox[{
                RowBox[{"\[Sigma]vals", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", "0.01"}], "]"}]}], 
             "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "101", ",", 
              RowBox[{"Length", "[", "dvals", "]"}], ",", "100"}], "}"}]}], 
           "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Round", "[", 
               RowBox[{
                RowBox[{"dvals", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", "0.01"}], "]"}]}], 
             "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "100", ",", 
              RowBox[{"Length", "[", "\[Sigma]vals", "]"}], ",", "100"}], 
             "}"}]}], "]"}]}], "\[IndentingNewLine]", "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"FrameLabel", "->", 
        RowBox[{"{", 
         RowBox[{"\"\<Phenotypic mismatch (\!\(\*SuperscriptBox[\(d\), \(2\)]\
\))\>\"", 
          ",", "\"\<Individual variation (\!\(\*SuperscriptBox[\(\[Sigma]\), \
\(2\)]\))\>\""}], "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"Mesh", "->", "False"}], ",", "\[IndentingNewLine]", 
       RowBox[{"AspectRatio", "->", 
        RowBox[{"1", "/", "1.5"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
     "\[IndentingNewLine]", "leg"}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"--", 
      RowBox[{"-", " ", "EXPORTING"}]}], " ", 
     RowBox[{"PLOT", " ", "--"}]}], "-"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "plotDir", 
   "=", "\"\<D:\\\\OneDrive - \
agroparistech.fr\\\\predator-prey-ecotox-vi\\\\outputs\\\\figs\\\\\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"DirectoryQ", "[", "plotDir", "]"}]}], ",", 
    RowBox[{"CreateDirectory", "[", "plotDir", "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"plotDir", "<>", "\"\<fig_3_repro.pdf\>\""}], ",", "plot"}], 
   "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.9699443934310703`*^9, 3.9699444195379353`*^9}, {
   3.9699444524659767`*^9, 3.969944452775429*^9}, {3.9699445118013287`*^9, 
   3.969944515168091*^9}, {3.9699447258241673`*^9, 3.96994497015374*^9}, {
   3.9699450892350636`*^9, 3.9699450949071426`*^9}, {3.969945137318886*^9, 
   3.969945138203232*^9}, 3.969945249950777*^9, {3.96994574028125*^9, 
   3.969945761592119*^9}, {3.969945829532799*^9, 3.9699460151796856`*^9}, 
   3.9699461334195824`*^9, {3.9699461782141*^9, 3.969946179656412*^9}, {
   3.969950628457138*^9, 3.9699506368363304`*^9}, {3.9699533240452023`*^9, 
   3.9699533245187225`*^9}, {3.969953373641964*^9, 3.9699533747262993`*^9}, {
   3.9699534561313095`*^9, 3.969953456697958*^9}, {3.9699621028451595`*^9, 
   3.969962105049305*^9}, {3.969962261916317*^9, 3.969962264153023*^9}, {
   3.96996341358823*^9, 3.9699634140979366`*^9}, {3.9700346781002197`*^9, 
   3.9700346847065353`*^9}, {3.9700374736121407`*^9, 3.970037532716961*^9}},
 CellLabel->"In[27]:=",ExpressionUUID->"5c3b416e-f1d8-cc4d-9e26-94a53c6950fe"],

Cell[BoxData[
 TemplateBox[{
   GraphicsBox[
    RasterBox[SparseArray[Automatic, {501, 600}, 0., {1, {CompressedData["
1:eJy11Yt7CFQYx/HfOe9ZlktGLiM0t4zQkMylGlJDsdxaCnOJIUy5rKtVLuui
Vi6tFeZxack1YZQseTR0WVIm0hI1Ja2EKalv/Q+d5znnPOec53k/7znPOc9p
OGJSv4lO0rl/G0qyl9YHKbKClHK5lF9JirpCSo2SCqpL0TWltNpSYR0ppp6U
3kAqipFiG0sZTaXiZlJcCymzpVTSWopvI2W1k0rbSwnxUnYnqayLlHizlNtV
Ku8uJd0q5SWC98a/A78vfj/8AfiD8O/Gvwd/CH4K/gj8Ufhj8Mfij8efiJ+G
/wD+VPzp+A/hP4r/OH4G/lP4s/Dn4D+D/xz+8/gv4s/DX4ifjZ+Dvwh/Cf5S
/OX4K/Hz8N/EX4O/Dv8t/LfxN+NvxX8Hfzt+Af5O/F34H+Lvwd+H/wl+Ef5+
/C/wD+Ifwj+CfxT/W/zv8E/gl+L/iH8K/xf8X/HP4J/DL8f/A/8v/L/xnVNs
cMq4zKk40imuklNmFaeSqk7x1Z2yajiV1nJKqOOUfZVTWX2nxBin3EZO5U2c
kpo55TXnArR0Sm7ttD7OKbKdU0p7p/wOTlGdnFK7OBXc5BTd1Smtu1NhD6eY
RKf0Xk5Ft+P3xb8Tvz/+IPxk/MH4Q/CH4Q/HH4U/Gj8Vfzz+BPxJ+A/gT8Gf
jv8Q/iP4j+Nn4D+JPwt/Dv7T+M/hP4+fhT8PfwH+y/g5+K/hL8Zfir8MfwV+
Hv4q/NX46/A34G/E34yfj78Nfzv+Dvyd+Lvwd+Pvwd+H/zF+Ef5+/AP4B/EP
4R/GP4pfgn8M/wT+D/gn8U/hn8Yvwz+Dfxb/PP4f+BfxL+E7r1zzKo/wSor0
yqvIw6vilVzVa301r8gaXim1vPKjvaKu8kqt71VwtVd0I6+0Jl6F13jFNPdK
v9arqJVXbJxXRluv4uu94jp4ZXb0KunsFX+TV1aCV2k3r4QeXtm3eZX19Eq8
Hb8PfhJ+f/yB/r/HnzwY/178YfjD8Ufij8ZPxR+HPwF/Ev5k/Cn40/DT8R/B
fwx/Bv6T+DPxZ+M/jf8s/lz8LPyX8Ofjv4z/Cv6r+Ivxc/GX4a/Afx1/Ff5q
/LX4G/A34m/Cz8ffhv8u/g789/E/wN+NX4i/F/9j/E/xP8M/gP8lfjH+Yfyv
8b/BP4Z/HP97/JP4P+Gfxi/D/w3/LP55/Av4F/Ev4csUbaa0CFNhBVNMRVN6
ZVPRFabYaqaMK03FNU1x0abMuqaSeqb4q01ZDU2ljU0J15iyY01lLUyJrUy5
15nK25iSrjfl3WBSR1NyZ9P6G02RCaaUbqb8W0xRt5lSe5oKeuP3wU/C74c/
EP8u/Lvx78Ufip+CPxL/Pvwx+OPw78efiD8Z/0H8qfjp+A/jP4o/A/8J/Jn4
s01rMk1/P2PqO9f02gumH14k5nzTtIWmbdmmizmmLotMDy8xbVpqOr3M1HSl
aXCeae4q03urTT+vNdXdYOqx0TRhk2neFtOWraZD75gubDfVLjC13Wnqvcs0
YjexC8l5L/l9ZFrxCWdQZNq637TjgOmDL027ium/YnyE+aOsl5iWHzMtPG6a
9b1pcin+j+zxlKnJaVNEmem7X8nljGnBWdPY86ZOFzjXP02fXzTlXDINVVAD
H3TYguZHBPWsEPRnZNAbFYP6Vw66UCUop2pQh2pBRdWDRtUI+r1m0IzaQRF1
gmbXDfL1gtLrB51sEDQgJmhrw6DajYMmNQkqaMpH2iyodWxQr+bEbBF067VB
jVoGHafOaRUUWuP+z/UfRCLd2Q==
        "], CompressedData["
1:eJzt1mOQ7We+huE3tu0V27ZtZzwrYyVja41t27Zt20bGtj136tSpOqdmJjOz
k+x0774+3NXVX7v/7++5trzw4rMuWnqMceJuy46l+nlpl/6+TC1by9XytUKt
WCvVyrVKrVqr1eq1Rq1Za9XatU6tW+vV+rVBbVgb1ca1SW1am9XmtUVNasva
qraubWrb2q62rx1qx9qpdq5datfarXavPWrP2qv2rn1q39qv9q8D6sA6qA6u
Q+rQOqwOryPqyDqqjq5j6tg6ro6vEy79O9VJdXKdUqfWaXV6nVFn1ll1dp1T
59Z5dX5dUFerq9c16pp1rbp2XaeuW9O6sK5X168b1A3rRnXjukndtG5WN69b
1EV1cd2yblW3rtvUbet2dfu6Q92x7lR3rrvUXetudfe6R92zZnWvunfdp+5b
96v71wPqgfWgenA9pB5aD6uH1yPqkfWoenQ9ph5bj6vH1xPqifWkenI9pZ5a
T6un1zPqmfWsenY9p55bz6vn1wvqhfWienG9pF5aL6uX1yvqlfWqenW9pl5b
r6vX1xvqjfWmenO9pd5ab6u31zvqnfWuene9p95b76v31wfqg/Wh+nB9pD5a
H6uP1yfqk/Wp+nR9pj5bn6vP1xfqi/Wl+nJ9pb5aX6uv1yX1jfpmfau+Xd+p
79b36vv1g/ph/ah+XD+pn9bP6uf1i/pl/ap+Xb+p39bv6vf1h/pj/an+XH+p
v9bf6tLHv1QtXcvUsrVcLV8r1Iq1Uq1cq9SqtVqtXmvUmrVWrV3r1Lq1Xq1f
G9SGtVFtXJvUprVZbV5b1KS2rK1q69qmtq3tavvaoXasnWrn2qV2rd1q99qj
9qy9au/ap/at/Wr/OqAOrIPq4DqkDq3D6vA6oo6so+roOqaOrePq+DqhTqyT
6uQ6pU6t0+r0OqPOrLPq7Dqnzq3z6vy6oK5WV69r1DXrWnXtuk5dt6Z1YV2v
rl83qBvWjerGdZO6ad2sbl63qIvq4rpl3apuXbep29bt6vZ1h7pj3anuXHep
u9bd6u51j7pnzepede+6T9237lf3rwfUA+tB9eB6SD20HlYPr0fUI+tR9eh6
TD22HlePryfUE+tJ9eR6Sj21nlZPr2fUM+tZ9ex6Tj23nlfPrxfUC+tF9eJ6
Sb20XlYvr1fUK+tV9ep6Tb22XlevrzfUG+tN9eZ6S7213lZvr3fUO+td9e56
T7233lfvrw/UB+tD9eH6SH20PlYfr0/UJ+tT9en6TH22Plefry/UF+tL9eX6
Sn21vlZfr0vqG/XN+lZ9u75T363v1ffrB/XD+lH9uH5SP62f1c/rF/XL+lX9
un5Tv63f1e/rD/XH+lP9uf5Sf62/1aXDv1QtXcvUsrVcLV8r1Iq1Uq1cq9Sq
tVqtXmvUmrVWrV3r1Lq1Xq1fG9SGtVFtXJvUprVZbV5b1KS2rK1q69qmtq3t
avvaoXasnWrn2qV2rd1q99qj9qy9au/ap/at/Wr/OqAOrIPq4DqkDq3D6vA6
oo6so+roOqaOrePq+DqhTqyT6uQ6pU6t0+r0OqPOrLPq7Dqnzq3z6vy6YGm+
OnLwFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x
FV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x1XTwFV/xFV/xFV/xFV/xFV/x
FV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x
FV/xFV/xFV/x1WzwFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x
FV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x1WTw1XTwFV/xFV/x
FV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x
FV/xFV/xFV/xFV/xFV/xFV/x1WzwFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x
FV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x1WTw
1XTwFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x
FV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x1WzwFV/xFV/xFV/xFV/xFV/x
FV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x
FV/xFV/x1WTw1XTwFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x
FV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x1WzwFV/xFV/x
FV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x
FV/xFV/xFV/xFV/xFV/x1WTw1XTwFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x
FV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x
1WzwFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x
FV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x1WTw1XTwFV/xFV/xFV/xFV/xFV/x
FV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x
FV/xFV/xFV/x1WzwFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x
FV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x1WTw1XTwFV/xFV/x
FV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x
FV/xFV/xFV/xFV/xFV/xFV/x1WzwFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x
FV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x1WTw
1XTwFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x
FV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x1WzwFV/xFV/xFV/xFV/xFV/x
FV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x
FV/xFV/x1WTw1XTwFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x
FV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x1WzwFV/xFV/x
FV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x
FV/xFV/xFV/xFV/xFV/x1WTw1XTwFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x
FV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x
1WzwFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x
FV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x1WTw1XTwFV/xFV/xFV/xFV/xFV/x
FV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x
FV/xFV/xFV/x1WzwFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x
FV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x1WTw1XTwFV/xFV/x
FV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x
FV/xFV/xFV/xFV/xFV/xFV/x1WzwFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x
FV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x1WTw
1XTwFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x
FV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x1WzwFV/xFV/xFV/xFV/xFV/x
FV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x
FV/xFV/x1WTw1XTwFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x
FV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x1WzwFV/xFV/x
FV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x
FV/xFV/xFV/xFV/xFV/x1WTw1XTwFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x
FV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x
1WzwFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x
FV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x1WTw1XTwFV/xFV/xFV/xFV/xFV/x
FV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x
FV/xFV/xFV/x1WzwFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x
FV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x1WTw1XTwFV/xFV/x
FV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x
FV/xFV/xFV/xFV/xFV/xFV/x1WzwFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x
FV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x1WTw
1XTwFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x
FV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x1WzwFV/xFV/xFV/xFV/xFV/x
FV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x
FV/xFV/x1WTw1XTwFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x
FV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x1WzwFV/xFV/x
FV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x
FV/xFV/xFV/xFV/xFV/x1WTw1XTwFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x
FV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x
1WzwFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x
FV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x1WTw1XTwFV/xFV/xFV/xFV/xFV/x
FV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x
FV/xFV/xFV/x1WzwFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x
FV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x1WTw1XTwFV/xFV/x
FV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x
FV/xFV/xFV/xFV/xFV/xFV/x1WzwFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x
FV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x1WTw
1XTwFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x
FV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x1WzwFV/xFV/xFV/xFV/xFV/x
FV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x
FV/xFV/x1WTw1XTwFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x
FV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x1WzwFV/xFV/x
FV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x
FV/xFV/xFV/xFV/xFV/x1WTw1XTwFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x
FV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x
1WzwFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x
FV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x1WTw1XTwFV/xFV/xFV/xFV/xFV/x
FV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x
FV/xFV/xFV/x1WzwFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x
FV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x1WTw1XTwFV/xFV/x
FV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x
FV/xFV/xFV/xFV/xFV/xFV/x1WzwFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x
FV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x1WTw
1XTwFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x
FV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x1WzwFV/xFV/xFV/xFV/xFV/x
FV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x
FV/xFV/x1WTw1XTwFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x
FV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x1WzwFV/xFV/x
FV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x
FV/xFV/xFV/xFV/xFV/x1WTw1XTwFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x
FV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x
1WzwFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x
FV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x1WTw1XTwFV/xFV/xFV/xFV/xFV/x
FV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x
FV/xFV/xFV/x1WzwFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x
FV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x1WTw1XTwFV/xFV/x
FV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x
FV/xFV/xFV/xFV/xFV/xFV/x1WzwFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x
FV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x1WTw
1XTwFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x
FV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x1WzwFV/xFV/xFV/xFV/xFV/x
FV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x
FV/xFV/x1WTw1XTwFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x
FV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x1WzwFV/xFV/x
FV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x
FV/xFV/xFV/xFV/xFV/x1WTw1XTwFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x
FV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x
1WzwFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x
FV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x1WTw1XTwFV/xFV/xFV/xFV/xFV/x
FV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x
FV/xFV/xFV/x1WzwFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x
FV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x1WTw1XTwFV/xFV/x
FV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x
FV/xFV/xFV/xFV/xFV/xFV/x1WzwFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x
FV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x1WTw
1XTwFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x
FV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x1WzwFV/xFV/xFV/xFV/xFV/x
FV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/xFV/x1aL6iqmYiqmY
iqmYiqmYiqkuv6k4iqM4iqM4iqM4iqM4atEcxU/8xE/8xE/8xE/8xE//nZ+Y
iZmYiZmYiZmYiZmY6d+biZVYiZVYiZVYiZVYiZX+tZUYiZEYiZEYiZEYiZEY
6R+NxEVcxEVcxEVcxEVcxEX/4yIe4iEe4iEe4iEe4qGF7iEO4iAO4iAO4iAO
4qCF6iD+4R/+4R/+4R/+4Z+F5h/u4R7u4R7u4R7u4Z6F4h7WYR3WYR3WYR3W
YZ0l2TqTwTjTwTiMwziMwziMwzhLmnHYhm3Yhm3Yhm3Yhm2WJNswDdMwDdMw
DdMwDdMsCaZhGZZhGZZhGZZhGZaZz5ZhGIZhGIZhGIZhGIaZj4ZhF3ZhF3Zh
F3ZhF3aZT3ZhFmZhFmZhFmZhFmaZD2ZhFVZhFVZhFVZhFVaZy1bhEz7hEz7h
Ez7hEz6Zaz7hEi7hEi7hEi7hEi6ZKy7hER7hER7hER7hER65qj3CIRzCIRzC
IRzCIRxyVTmEP/iDP/iDP/iDP/hjcfuDO7iDO7iDO7iDO7hjcbmDNViDNQZr
LMUarMEarHHlWeOIwRizwRiMwRiMwRiMwRhXtDHYgi3Ygi3Ygi3Ygi2uSFvw
BE/wBE/wBE/wBE9cXk9wBEdwBEdwBEdwBEcsqiP4gR/4gR/4gR/4gR/+Wz8w
AzMwAzMwAzMwAzP8J2ZgBVZgBVZgBVZgBVa4LCswAiMwAiMwAiMwAiP8MyNw
ARdwARdwARdwARf8rwt4gAd4gAd4gAd4gAcYgAEYgAEYgAEYYGEawPbbfttv
+22/7bf9C2v77b29t/f23t7be3u/5O+9nbfzlww7b+ftvJ2380vqztt2227b
bbttt+22fcnadntuz+25Pbfn9tyez/89t+N23I7bcTtux+34/N1x2227bbft
tt2223bPr+221/baXttre22v7fXc32sbbaNttI220TbaRs/NjbbLdtku22W7
bJft8tzZZXtsj+2xPbbH9tgeX/V7bINtsA22wTbYBtvgq2aD7a7dtbt21+7a
Xbu7+HbX1tpaW2trba2ttbVX7tbaVttqW22rbbWttvWK3VZ7ak/tqT21p/bU
nl7+PbWhNtSG2lAbakNt6KJtqN20m3bTbtpNu2k3//PdtJW20lbaSltpK23l
ZW+lbbSNttE22kbbaBv//zbaQ3toD+2hPbSH9tD+2T/7Z//sn/1bmPtn82ye
zbN5Ns/mLZTNs3E2zsbZOBtn45bUjbNpNs2m2TSbZtOWlE2zY3bMjtkxO2bH
5vOO2S27Zbfslt2yW/Npt+yUnbJTdspO2am5vFN2yS7ZJbtkl+zSXNolG2SD
bJANskE26KraIJtjc2yOzbE5NmdxbY6NsTE2xsbYGBtzZW2MPbEn9sSe2BN7
ckXsif2wH/bDftgP+7Eo+2ErbIWtsBW2wlb8u62wC3bBLtgFu2AX/u8u2AAb
YANsgA1YuBvg3rv37r17794vjHvvrrvr7rq77q4vWXfdDXfD3XA33A2fvzfc
rXar3Wq32q2e+7faTXaT3WQ32U2eOzfZ3XV33V13191dvHfXfXVf3Vf31X29
cu6rG+qGuqFuqBu66DfUjXQj3Ug3cqHeSPfNfXPf3Lf5dt/cJXfJXXKXFtdd
ckvcErfELbmsW+Lte/ve/pLx9r1P79P7XHzv0/vxfrwf37Jvee58y76hhfcN
+T/84//h7wUHLns=
        "]}, CompressedData["
1:eJzt2DGSnTkZhWFTxUbYAAkLICZlCVNFzJbJSVgCdcfVg21sjdvu268+6enk
SV2+0vl1zp9++eff//GHDx8+/O3Pf/zw8e9ffyXJ2r/8+vdvkiRJkiQ/s+6r
JPlinYckSZIkyT2t+ypJvljnIUmSJElyT+u+SpIv1nlIkiRJktzTuq+S5It1
HpIkSZIk97TuqyT5Yp2HJEmSJMk9rfsqSb5Y5yFJkiRJck/rvkqSL9Z5SJIk
SZLc07qvkuSLdR6SJEmSJPe07qskWecgSZIkSXJv695KknUOkiRJkiT3tu6t
JFnnIEmSJElyb+veSpJ1DpIkSZIk97burSRZ5yBJkiRJcm/r3kqSdQ6SJEmS
JPe27q0kWecgSZIkSXJv695KknUOkiRJkiT3tu6tJFnnIEmSJElyb+veSpJ1
DpIkSZIk97burSRZ5yBJkiRJcm/r3kqSdQ6SJEmSJPe27q0kWecgSZIkSXJv
695K8l7r/CNJkiRJzrDuryTvtc4/kiRJkuQM6/5K8l7r/CNJkiRJzrDuryTv
tc4/kiRJkuQM6/5K8l7r/CNJkiRJzrDuryTvtc4/kiRJkuQM6/5K8l7r/CNJ
kiRJzrDuryTvtc4/kiRJkuQM6/5K8j7r3CNJkiRJzrLusSTvs849kiRJkuQs
6x5L8j7r3CNJkiRJzrLusSTvs849kiRJkuQs6x5L8j7r3CNJkiRJzrLusSTv
s849kiRJkuQs6x5L8h7rvCNJkiRJzrTusyTvsc47kiRJkuRM6z5L8h7rvCNJ
kiRJzrTusyTvsc47kiRJkuRM6z5L8h7rvCNJkiRJzrTusyTPt845kiRJkuRs
615L8nzrnCNJkiRJzrbutSTPt845kiRJkuRs615L8nzrnCNJkiRJzrbutSTP
t845kiRJkuRs615L8lzrfCNJkiRJnmHdb0mea51vJEmSJMkzrPstyXOt840k
SZIkeYZ1vyV5rnW+kSRJkiTPsO63JM+zzjWSJEmS5FnWPZfkeda5RpIkSZI8
y7rnkjzPOtdIkiRJkmdZ91yS51nnGkmSJEnyLOueS/Ic6zwjSZIkSZ5p3XdJ
nmOdZyRJkiTJM637LslzrPOMJEmSJHmmdd8lOd86x0iSJEmSZ1v3XpLzrXOM
JEmSJHm2de8lOd86x0iSJEmSZ1v3XpJzrfOLJEmSJHmHdf8lOdc6v0iSJEmS
d1j3X5JzrfOLJEmSJHmHdf8lOdc6v0iSJEmSd1j3X5LzrHOLJEmSJHmXdQ8m
Oc86t0iSJEmSd1n3YJLzrHOLJEmSJHmXdQ8mOcc6r0iSJEmSd1r3YZJzrPOK
JEmSJHmndR8mub91TpEkSZIk77buxST3t84pkiRJkuTd1r2Y5P7WOUWSJEmS
vNu6F5Pc1zqfSJIkSZJ8WPdjkvta5xNJkiRJkg/rfkxyX+t8IkmSJEnyYd2P
Se5nnUskSZIkSX5q3ZNJ7medSyRJkiRJfmrdk0nuY51HJEmSJEl+zbovk9zH
Oo9IkiRJkvyadV8m2VvnEEmSJEmSK+veTLK3ziGSJEmSJFfWvZlkb51DJEmS
JEmurHszSbsVSZIkSZIr6/5M0n5FkiRJkuTKuj+TtFuRJEmSJLmy7tEk7Vck
SZIkSa6sezRJuxVJkiRJkivrPk3SfkWSJEmS5Mq6T5O0W5EkSZIkubLu1STt
VyRJkiRJrqx7NUm7FUmSJEmSK+t+TdJ+RZIkSZLkyrpfk7RbkSRJkiS5su7Z
JO1XJEmSJEmurHs2SbsVSZIkSZIr675N0n5FkiRJkuTKum+TtFuRJEmSJLmy
7t0k7VckSZIkSa6sezdJuxVJkiRJkivr/k3SfkWSJEmS5Mq6f5O0W5EkSZIk
ubLu4STtViRJkiRJrqz7OEn7FUmSJEmSK+s+TtJuRZIkSZLkyrqXk7RfkSRJ
kiS5su7lJO1WJEmSJEmurPs5SbsVSZIkSZIr655O0n5FkiRJkuTKuqeTtFuR
JEmSJLmy7usk7VckSZIkSa6s+zpJuxVJkiRJkivr3k7ebH3/SZIkSZKcYN3f
yZut7z9JkiRJkhOs+zt5o/W9J0mSJElyknWPJ2+yvu8kSZIkSU607vPkDdb3
nCRJkiTJyda9nrzB+p6TJEmSJDnZuteTJ1vfb5IkSZIkT7Du9+SJ1veaJEmS
JMmTrHs+eaL1vSZJkiRJ8iTrnk+eZH2fSZIkSZI80brvkydY32OSJEmSJE+2
7v3kZOv7S5IkSZLkDdb9n5xsfX9JkiRJkrzBuv+TE63vLUmSJEmSN1nvAOQk
6/tKkiRJkuSN1nsAOcH6npIkSZIkebP1LkDubH0/SZIkSZKk/Yq0X5EkSZIk
ubf1PkDuaH0vSZIkSZLk/6x3AnIn6/tIkiRJkiT/33ovIHewvockSZIkSfLb
1rsBabciSZIkSZIr6/2AtFuRJEmSJMmV9Y5A2q1IkiRJkuTKek8g7VYkSZIk
SXJlvSuQ9iuSJEmSJLmy3hVIuxVJkiRJklxZ7wuk3YokSZIkSa6sdwbSbkWS
JEmSJFfWewNptyJJkiRJkivr3YG0W5EkSZIkyZX1/kDarUiSJEmS5Mp6hyDt
ViRJkiRJcmW9R5B2K5IkSZIkubLeJUi7FUmSJEmSXFnvE6S9iiRJkiRJrqz3
CtJuRZIkSZIkV9a7Be+2Pv8kSZIkSXJ/6/2Cd1qfe5IkSZIkOcd6x+Bd1ued
JEmSJEnOs94zeIf1OSdJkiRJknOtdw2ebX2+SZIkSZLkfOt9g2dZn2eSJEmS
JHme9d7BM6zPMUmSJEmSPNd69+Bs6/NLkiRJkiTPt94/ONP63JIkSZIkyXus
dxDOsD6nJEmSJEnyXutdhHtbn0+SJEmSJMl6H+Ge1ueSJEmSJEnyxXon4R7W
55AkSZIkSfJb1rsJW+vzR5IkSZIk+XvW+wnf1/q8kSRJkiRJvtZ6T+H7WJ8z
kiRJkiTJH7XeVfgc63NFkiRJkiT5VtY7C9/W+jyRJEmSJEm+tfXewp+zPj8k
SZIkSZLPtt5f+Drr80KSJEmSJPne1nsMv8/6nJAkSZIkSVbWuwy/bn0uSJIk
SZIkd7HeafjR+hyQJEmSJEnuar3b3Gr9u5MkSZIkSU6x3nFusf6dSZIkSZIk
p1rvOqda/64kSZIkSZKnWO88p1j/jiRJkiRJkqda7z5TrX83kiRJkiTJW6x3
oCnWvxNJkiRJkuSt1rvQrta/C0mSJEmSJD9a70S19f8/SZIkSZIk19b7kb2K
JEmSJEmSK+s9yU5FkiRJkiTJlfXOZKciSZIkSZLkynp/slORJEmSJElyZb1L
2alIkiRJkiS50k5FkiRJkiTJnbVPkSRJkiRJcmftUyRJkiRJktxZ+xRJkiRJ
kiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJ
kiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJ
kiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJ
kiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJ
kiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJ
kiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJ
kiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJ
kiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJ
kiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJ
kiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJ
kiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJ
kiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJ
kiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJ
kiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJ
kiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJ
kiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJ
kiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJ
kiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJ
kiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJ
kiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJ
kiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkvv54de///xm
/e8hSZIkSZLknX65U33L+t9JkiRJkiTJO/zevcp+RZIkSZIkyWf6ozuV/Yok
SZIkSZLP8K33KvsVSZIkSZIkf8Rn71T2K5IkSZIkSX6P1U5lvyJJkiRJkuTX
rPcp+xVJkiRJkiQf1juU/YokSZIkSZKfWu9O9iuSJEmSJEk+rPcl+xVJkiRJ
kiQf1juS/YokSZIkSZIP671oN+vfgyRJkiRJ8nbrfWh369+HJEmSJEnyFusd
aKr170aSJEmSJHma9d5zmvXvSZIkSZIkOdV617nF+ncmSZIkSZLc3Xq/ud36
9ydJkiRJktzFeqfh163PBUmSJEmS5Htb7zF8nfV5IUmSJEmSfLb1/sLnWJ8r
kiRJkiTJ11rvKdzD+hySJEmSJMl7rXcRzrY+vyRJkiRJ8hzrnYN3WZ93kiRJ
kiS5r/VuQdqzSJIkSZLkw3qPIO1aJEmSJEnyYb0vkPYskiRJkiT5sN4NyJ2t
7ydJkiRJkjdZ7wDkCdb3mCRJkiTJyda9nrzZ+v6TJEmSJLmTdU8nac8iSZIk
SfJh3b9J2rVIkiRJkndb92iSvXUOkSRJkiT5sO7HJOdZ5xZJkiRJ8izrnkvy
fOucI0mSJEnOsO6vJPmldS6SJEmSJN/XuoeS5M9a5yhJkiRJ8ueseyVJVtb5
S5IkSZL83LonkuQU67wmSZIkyVOt+x5Jnm6d8yRJkiS5u3VvI0l+bv1dIEmS
JMn3tu5hJMm3sf6ekCRJkuSPWvcpkmRr/R0iSZIkyboXkSRnWn+/SJIkSZ5j
3W9IkndZf/dIkiRJ7mfdU0iS/B7r7yVJkiTJ51n3DZIkn2n9nSVJkiT5beu+
QJLkBOvvNUmSJHmy9XufJMmTrb/zJEmS5M7W73WSJPn71u8FkiRJ8pnW722S
JPk863cGSZIkubJ+L5Mkyf2t3yskSZI80/qdS5Ik77F+95AkSXIv6/cpSZLk
a63fTyRJknwb63clSZJkZf0OI0mSvN36PUiSJDnd+j1HkiQ5zfr9RpIkyc+t
34ckSZLvZf3uIkmS5HOt35skSZJfWr+PSJIkOdP6HUuSJOdav2NIkiTJT63f
xyRJ8nnW7wySJEnyPa3f3yRJ0h5FkiRJvqX1+54kyZ2tv9MkSZIkX2/dI0iS
/BHr7ydJkiTJfaz7CUlytvV3jCRJkuQ91v2HJPk21t8TkiRJknxr655FktOt
c5wkSZIkT7PueST5vdZ5SZIkSZJ8rnXvJNlb5xBJkiRJkp9a92RykvV9JUmS
JEnyJusdgHtan0uSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmS
JEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmS
JEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmS
JEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmS
JEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmS
JEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmS
JEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmS
JEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmS
JEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmS
JEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmS
JEmSJEmSJEmSJEmSJEmSJHf2vyvbtEM=
       "]}], {{0, 0}, {600, 501}}, {0, 1}], AspectRatio -> 0.6666666666666666,
     Frame -> True, FrameLabel -> {
      FormBox[
      "\"Individual variation (\\!\\(\\*SuperscriptBox[\\(\[Sigma]\\), \
\\(2\\)]\\))\"", TraditionalForm], 
      FormBox[
      "\"Phenotypic mismatch (\\!\\(\\*SuperscriptBox[\\(d\\), \
\\(2\\)]\\))\"", TraditionalForm]}, FrameTicks -> {{{{100.5, 
         FormBox["0.5`", TraditionalForm]}, {200.5, 
         FormBox["1.`", TraditionalForm]}, {300.5, 
         FormBox["1.5`", TraditionalForm]}, {400.5, 
         FormBox["2.`", TraditionalForm]}, {500.5, 
         FormBox["2.5`", TraditionalForm]}}, None}, {{{99.5, 
         FormBox["1.`", TraditionalForm]}, {199.5, 
         FormBox["2.`", TraditionalForm]}, {299.5, 
         FormBox["3.`", TraditionalForm]}, {399.5, 
         FormBox["4.`", TraditionalForm]}, {499.5, 
         FormBox["5.`", TraditionalForm]}}, None}}, GridLinesStyle -> 
    Directive[
      GrayLevel[0.5, 0.4]], 
    Method -> {
     "GridLinesInFront" -> True, "DefaultBoundaryStyle" -> Automatic, 
      "DefaultGraphicsInteraction" -> {
       "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
        "Effects" -> {
         "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
          "Droplines" -> {
           "freeformCursorMode" -> True, 
            "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
      "DefaultPlotStyle" -> Automatic}], 
   FormBox[
    FormBox[
     TemplateBox[{
      "\"Noncoexistence\"", "\"Coexistence: nonoscillatory\"", 
       "\"Coexistence: damped oscillations\"", 
       "\"Coexistence: limit cycles\""}, "SwatchLegend", 
      DisplayFunction -> (FormBox[
        StyleBox[
         StyleBox[
          PaneBox[
           TagBox[
            GridBox[{{
               TagBox[
                GridBox[{{
                   GraphicsBox[{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    AbsoluteThickness[1.6], 
                    GrayLevel[0]], 
                    RectangleBox[{0, 0}, {10, 10}, "RoundingRadius" -> 0]}, 
                    AspectRatio -> Full, ImageSize -> {10, 10}, 
                    PlotRangePadding -> None, ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #}, {
                   GraphicsBox[{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    AbsoluteThickness[1.6], 
                    GrayLevel[1]], 
                    RectangleBox[{0, 0}, {10, 10}, "RoundingRadius" -> 0]}, 
                    AspectRatio -> Full, ImageSize -> {10, 10}, 
                    PlotRangePadding -> None, ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #2}, {
                   GraphicsBox[{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    AbsoluteThickness[1.6], 
                    GrayLevel[0.85]], 
                    RectangleBox[{0, 0}, {10, 10}, "RoundingRadius" -> 0]}, 
                    AspectRatio -> Full, ImageSize -> {10, 10}, 
                    PlotRangePadding -> None, ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #3}, {
                   GraphicsBox[{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    AbsoluteThickness[1.6], 
                    GrayLevel[0.5]], 
                    RectangleBox[{0, 0}, {10, 10}, "RoundingRadius" -> 0]}, 
                    AspectRatio -> Full, ImageSize -> {10, 10}, 
                    PlotRangePadding -> None, ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #4}}, 
                 GridBoxAlignment -> {
                  "Columns" -> {Center, Left}, "Rows" -> {{Baseline}}}, 
                 AutoDelete -> False, 
                 GridBoxDividers -> {
                  "Columns" -> {{False}}, "Rows" -> {{False}}}, 
                 GridBoxItemSize -> {"Columns" -> {{All}}, "Rows" -> {{All}}},
                  GridBoxSpacings -> {
                  "Columns" -> {{0.3}}, "Rows" -> {{0.5}}}], "Grid"]}}, 
             GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
             AutoDelete -> False, 
             GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{1}}, "Rows" -> {{0}}}], 
            "Grid"], Alignment -> Left, AppearanceElements -> None, 
           ImageMargins -> {{5, 5}, {5, 5}}, ImageSizeAction -> 
           "ResizeToFit"], LineIndent -> 0, StripOnInput -> False], {
         FontFamily -> "Arial"}, Background -> Automatic, StripOnInput -> 
         False], TraditionalForm]& ), 
      InterpretationFunction :> (RowBox[{"SwatchLegend", "[", 
         RowBox[{
           RowBox[{"{", 
             RowBox[{
               
               TemplateBox[<|"color" -> GrayLevel[0]|>, 
                "GrayLevelColorSwatchTemplate"], ",", 
               
               TemplateBox[<|"color" -> GrayLevel[1]|>, 
                "GrayLevelColorSwatchTemplate"], ",", 
               
               TemplateBox[<|"color" -> GrayLevel[0.85]|>, 
                "GrayLevelColorSwatchTemplate"], ",", 
               
               TemplateBox[<|"color" -> GrayLevel[0.5]|>, 
                "GrayLevelColorSwatchTemplate"]}], "}"}], ",", 
           RowBox[{"{", 
             RowBox[{#, ",", #2, ",", #3, ",", #4}], "}"}], ",", 
           RowBox[{"LegendMarkers", "\[Rule]", "\"Rectangle\""}]}], "]"}]& ), 
      Editable -> True], TraditionalForm], TraditionalForm]},
  "Legended",
  DisplayFunction->(GridBox[{{
      TagBox[
       ItemBox[
        PaneBox[
         TagBox[#, "SkipImageSizeLevel"], Alignment -> {Center, Baseline}, 
         BaselinePosition -> Baseline], DefaultBaseStyle -> "Labeled"], 
       "SkipImageSizeLevel"], 
      ItemBox[#2, DefaultBaseStyle -> "LabeledLabel"]}}, 
    GridBoxAlignment -> {"Columns" -> {{Center}}, "Rows" -> {{Center}}}, 
    AutoDelete -> False, GridBoxItemSize -> Automatic, 
    BaselinePosition -> {1, 1}]& ),
  Editable->True,
  InterpretationFunction->(RowBox[{"Legended", "[", 
     RowBox[{#, ",", 
       RowBox[{"Placed", "[", 
         RowBox[{#2, ",", "After"}], "]"}]}], "]"}]& )]], "Output",
 CellChangeTimes->{3.9699443892818184`*^9, 3.9699445167880745`*^9, 
  3.969944983289345*^9, 3.9699450979637947`*^9, 3.969945139004999*^9, 
  3.969950441662262*^9, 3.9699532908471813`*^9, 3.969953326131962*^9, 
  3.9699534583219986`*^9, 3.9699621067771034`*^9, 3.9699622656573944`*^9, 
  3.969963415967785*^9, 3.970038949762535*^9, 3.971407341022833*^9, 
  3.9714140253370495`*^9},
 CellLabel->"Out[34]=",ExpressionUUID->"bb537d4d-fe46-a34b-ae60-4f4b9543ef4a"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1536, 795.5999999999999},
WindowMargins->{{
  Automatic, -5.399999999999864}, {-5.399999999999977, Automatic}},
Magnification:>0.9 Inherited,
FrontEndVersion->"14.3 pour Microsoft Windows (64-bit) (July 8, 2025)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"6b4d75c3-407e-a742-b6c0-a9e6c4cc7062"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[576, 22, 156, 3, 60, "Chapter",ExpressionUUID->"3b65c0ac-6816-2b48-be0c-6872b12c2216"],
Cell[735, 27, 292, 5, 39, "Input",ExpressionUUID->"9077352c-c07a-7f44-80e2-f41b7e90635a"],
Cell[1030, 34, 14324, 380, 404, "Text",ExpressionUUID->"fd39c993-bcdf-3944-8a5b-2fb22813f981"],
Cell[CellGroupData[{
Cell[15379, 418, 3794, 108, 219, "Input",ExpressionUUID->"095903af-07a6-0d40-95a3-bf739a198119"],
Cell[19176, 528, 3586, 66, 455, "Output",ExpressionUUID->"b80fffa5-bc66-a341-8c3d-cc9949d3294c"]
}, Open  ]],
Cell[22777, 597, 194, 3, 29, "Text",ExpressionUUID->"42ba4b2d-e940-7942-b01b-6ea5dd08beb8"],
Cell[CellGroupData[{
Cell[22996, 604, 1060, 28, 31, "Input",ExpressionUUID->"e276b17b-7eb7-8e49-ba20-975ce8ad2a16"],
Cell[24059, 634, 1877, 56, 85, "Output",ExpressionUUID->"4235812d-f39b-044b-a3ec-16e61f36080c"]
}, Open  ]],
Cell[25951, 693, 2830, 72, 62, "Text",ExpressionUUID->"5ed7661b-6a75-014c-ab24-3daad5ddc1af"],
Cell[CellGroupData[{
Cell[28806, 769, 2785, 77, 204, "Input",ExpressionUUID->"5f07fcad-7649-0a43-9471-ff32b36adf5d"],
Cell[31594, 848, 1074, 31, 79, "Output",ExpressionUUID->"17b48c2e-d683-714a-a439-28a57f304ed8"],
Cell[32671, 881, 708, 20, 71, "Output",ExpressionUUID->"51e79dbd-ae6d-f441-a0ba-117b65fc4402"]
}, Open  ]],
Cell[CellGroupData[{
Cell[33416, 906, 3458, 92, 236, "Input",ExpressionUUID->"0b1444f5-8ac4-c946-b708-959b810ae12b"],
Cell[36877, 1000, 1362, 36, 77, "Output",ExpressionUUID->"66539279-7b4c-884f-a353-6c39ada4da9a"],
Cell[38242, 1038, 1212, 32, 83, "Output",ExpressionUUID->"d080a847-09ef-5c43-af72-48c9e4af36d5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[39491, 1075, 3768, 110, 277, "Input",ExpressionUUID->"550d4ba5-78fd-e841-9dc7-6f81559eb1d3"],
Cell[43262, 1187, 3199, 60, 416, "Output",ExpressionUUID->"657d882b-441c-3a4d-b551-d7561363c72e"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[46510, 1253, 164, 3, 51, "Chapter",ExpressionUUID->"4376ad1a-4815-4342-97a2-c297be7e7f58"],
Cell[46677, 1258, 365, 7, 30, "Text",ExpressionUUID->"3a795b00-9cd4-124f-b619-54c553267921"],
Cell[CellGroupData[{
Cell[47067, 1269, 181, 3, 59, "Section",ExpressionUUID->"639647dd-b771-ee44-89c9-4ad174976195"],
Cell[47251, 1274, 343, 7, 29, "Text",ExpressionUUID->"f3def23c-42e4-2449-8bf5-a293118a7b08"],
Cell[47597, 1283, 3661, 92, 115, "Input",ExpressionUUID->"c049110d-378b-7440-ace7-61afd1f26e6a"],
Cell[51261, 1377, 5771, 151, 118, "Text",ExpressionUUID->"272479aa-f654-f34e-a52f-ba047c65fed8"],
Cell[CellGroupData[{
Cell[57057, 1532, 4623, 116, 266, "Input",ExpressionUUID->"255a51d7-8aca-014b-889d-cdac2d7a7900"],
Cell[61683, 1650, 376, 8, 28, "Output",ExpressionUUID->"63d07224-6453-1242-b5a0-ded163d529a2"],
Cell[62062, 1660, 376, 8, 28, "Output",ExpressionUUID->"6e80ea7e-2c10-eb4f-b608-cfef83fbfb6e"]
}, Open  ]],
Cell[62453, 1671, 304, 6, 29, "Text",ExpressionUUID->"95277ae8-3bf5-4049-99f8-e24af3e21ac4"],
Cell[62760, 1679, 9863, 253, 223, "Text",ExpressionUUID->"6ffa969a-58b4-9547-999f-0392b2f1c9d4"],
Cell[CellGroupData[{
Cell[72648, 1936, 4052, 99, 249, "Input",ExpressionUUID->"23694446-d90f-e74e-86da-e87dbac1fc38"],
Cell[76703, 2037, 562, 13, 30, "Output",ExpressionUUID->"4164d6b0-bef2-aa44-b407-b873fa6be091"]
}, Open  ]],
Cell[77280, 2053, 175, 3, 29, "Text",ExpressionUUID->"f613d595-9a72-944f-9f4e-dc925ac7d23e"],
Cell[CellGroupData[{
Cell[77480, 2060, 379, 7, 71, "Input",ExpressionUUID->"c9b4358f-9e48-ec42-8bcb-1a8a2f8bf12c"],
Cell[77862, 2069, 222, 3, 28, "Output",ExpressionUUID->"167b29fa-28d0-c446-be35-720f2e2e483f"],
Cell[78087, 2074, 239, 4, 28, "Output",ExpressionUUID->"620ba61c-5526-9e45-813d-de8839165412"]
}, Open  ]],
Cell[78341, 2081, 2439, 60, 49, "Text",ExpressionUUID->"f3f8d07d-8602-0f4c-b4d3-e729008f524b"],
Cell[CellGroupData[{
Cell[80805, 2145, 243, 5, 25, "Input",ExpressionUUID->"4bb2f88c-f91c-e64c-bd3d-a3f86d7d6e12"],
Cell[81051, 2152, 187, 3, 28, "Output",ExpressionUUID->"20698f66-e764-b547-83aa-aeb399fc2e04"]
}, Open  ]],
Cell[81253, 2158, 273, 6, 29, "Text",ExpressionUUID->"fd21f314-4978-3e4c-b732-08b8a0c15890"]
}, Closed]],
Cell[CellGroupData[{
Cell[81563, 2169, 553, 17, 47, "Section",ExpressionUUID->"6d0f905b-1a7e-1442-b007-2aeadc74cfe6"],
Cell[82119, 2188, 658, 20, 31, "Text",ExpressionUUID->"4a4b1445-82ec-a84d-a375-e9fe1c460977"],
Cell[CellGroupData[{
Cell[82802, 2212, 189, 3, 47, "Subsection",ExpressionUUID->"71f9865a-759f-7e46-88e4-916272564c7e"],
Cell[82994, 2217, 4036, 102, 147, "Text",ExpressionUUID->"69e4adc6-a449-3849-be02-25fec89bb1fb"],
Cell[87033, 2321, 9776, 255, 673, "Input",ExpressionUUID->"c1f29499-ae35-b849-a535-0157ca144b73"],
Cell[96812, 2578, 218, 4, 29, "Text",ExpressionUUID->"ba6f3f90-c588-c642-b90f-5e620e2f5763"],
Cell[CellGroupData[{
Cell[97055, 2586, 374, 8, 27, "Input",ExpressionUUID->"e312d441-66b7-9d4d-9ed8-216b0282b114"],
Cell[97432, 2596, 285, 6, 28, "Output",ExpressionUUID->"c96b64e7-110a-0a47-a4cb-2615e12475c2"]
}, Open  ]],
Cell[97732, 2605, 257, 6, 29, "Text",ExpressionUUID->"e9e19e25-3757-ba48-bfb4-c43ac0af6581"],
Cell[97992, 2613, 3504, 85, 329, "Input",ExpressionUUID->"053ff32c-9391-8843-ad0f-02d40e2a8bb0"],
Cell[101499, 2700, 185, 3, 29, "Text",ExpressionUUID->"7e1389ea-68a4-d04f-aece-f9651594553f"],
Cell[CellGroupData[{
Cell[101709, 2707, 366, 7, 27, "Input",ExpressionUUID->"f024415c-2eb0-e141-80f9-b11580070afa"],
Cell[102078, 2716, 378, 7, 28, "Output",ExpressionUUID->"71a32c2e-da4b-6c4c-af71-2eda4cbfaf25"]
}, Open  ]],
Cell[102471, 2726, 434, 11, 108, "Text",ExpressionUUID->"4af98b0e-9dbf-3f46-89cd-b9cfc5c950d7"],
Cell[102908, 2739, 3406, 82, 431, "Input",ExpressionUUID->"bc688d43-4555-1e49-b1b0-bf0db778f2ec"],
Cell[106317, 2823, 175, 3, 29, "Text",ExpressionUUID->"01efc728-db44-5743-99ef-816ca48a79d9"],
Cell[CellGroupData[{
Cell[106517, 2830, 251, 5, 27, "Input",ExpressionUUID->"b08cde4d-44db-8643-bacb-d98f720315a0"],
Cell[106771, 2837, 172, 2, 28, "Output",ExpressionUUID->"361a9128-df19-404d-8b42-e43a86d44d0b"]
}, Open  ]],
Cell[106958, 2842, 184, 3, 29, "Text",ExpressionUUID->"b95b5daa-493f-d94b-8a0a-33e94658bd58"]
}, Closed]],
Cell[CellGroupData[{
Cell[107179, 2850, 178, 3, 33, "Subsection",ExpressionUUID->"19f36801-e264-bf41-89be-84fa9dd2b942"],
Cell[107360, 2855, 538, 15, 29, "Text",ExpressionUUID->"a071c051-7ad5-ca44-9d46-8dfd31ae92b0"],
Cell[CellGroupData[{
Cell[107923, 2874, 851, 18, 123, "Input",ExpressionUUID->"8fc8c1c1-4ebf-1c4b-a03d-6c8388c28b30"],
Cell[108777, 2894, 354, 5, 28, "Output",ExpressionUUID->"29dcc054-9240-ce42-b6ea-925fa498d63a"]
}, Open  ]],
Cell[109146, 2902, 739, 15, 108, "Input",ExpressionUUID->"68437034-3588-4f41-bfb1-bf44946fc77e"],
Cell[CellGroupData[{
Cell[109910, 2921, 3514, 78, 728, "Input",ExpressionUUID->"46e53977-73f4-d14b-8290-5fa9329a8831"],
Cell[113427, 3001, 8711, 184, 235, "Output",ExpressionUUID->"80028722-9d9f-514d-bf18-50a9fed35d08"]
}, Open  ]],
Cell[122153, 3188, 1739, 33, 108, "Text",ExpressionUUID->"e87341cc-5d22-3f44-9103-3ecc22405505"]
}, Closed]],
Cell[CellGroupData[{
Cell[123929, 3226, 189, 3, 33, "Subsection",ExpressionUUID->"e303f804-08cc-224c-bd73-ec5ea66c5744"],
Cell[124121, 3231, 3295, 70, 325, "Text",ExpressionUUID->"58bae07a-3ef2-de4d-aba6-a57e593a7c17"],
Cell[CellGroupData[{
Cell[127441, 3305, 27665, 667, 3002, "Input",ExpressionUUID->"b1b60d2e-07af-1c4b-8247-e4442d0b7453"],
Cell[155109, 3974, 449, 10, 23, "Message",ExpressionUUID->"2d5c7423-b417-cc45-a8be-60e42ae41fbd"],
Cell[155561, 3986, 9199, 191, 239, "Output",ExpressionUUID->"b65e87d9-dc97-8949-aa14-caff3f2d5baa"]
}, Open  ]],
Cell[164775, 4180, 455, 6, 30, "Text",ExpressionUUID->"952e030b-8a04-2e46-be55-d0ea6bc904d1"],
Cell[CellGroupData[{
Cell[165255, 4190, 480, 13, 39, "Input",ExpressionUUID->"c5b64192-7ae4-1340-a20e-18271f8bc927"],
Cell[165738, 4205, 236, 4, 28, "Output",ExpressionUUID->"12ea9c3e-520c-3545-8bbc-1dd307215086"]
}, Open  ]],
Cell[165989, 4212, 936, 26, 30, "Text",ExpressionUUID->"da5fe91d-bb30-4543-bd88-c55d13a05dfe"],
Cell[166928, 4240, 24630, 618, 2445, "Input",ExpressionUUID->"1e0e7e20-decf-ec4d-9bf1-d7c56dc44286"],
Cell[191561, 4860, 256, 4, 29, "Text",ExpressionUUID->"262cde47-3201-8f49-b26a-df662d59c316"],
Cell[CellGroupData[{
Cell[191842, 4868, 6460, 157, 1075, "Input",ExpressionUUID->"5c3b416e-f1d8-cc4d-9e26-94a53c6950fe"],
Cell[198305, 5027, 26769, 480, 239, "Output",ExpressionUUID->"bb537d4d-fe46-a34b-ae60-4f4b9543ef4a"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

